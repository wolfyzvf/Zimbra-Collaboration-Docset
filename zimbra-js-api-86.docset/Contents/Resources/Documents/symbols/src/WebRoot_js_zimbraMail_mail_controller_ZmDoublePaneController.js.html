<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class="line">  1</span> <span class="COMM">/*
<span class="line">  2</span>  * ***** BEGIN LICENSE BLOCK *****
<span class="line">  3</span>  * Zimbra Collaboration Suite Web Client
<span class="line">  4</span>  * Copyright (C) 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014 Zimbra, Inc.
<span class="line">  5</span>  * 
<span class="line">  6</span>  * The contents of this file are subject to the Common Public Attribution License Version 1.0 (the &#34;License&#34;);
<span class="line">  7</span>  * you may not use this file except in compliance with the License. 
<span class="line">  8</span>  * You may obtain a copy of the License at: http://www.zimbra.com/license
<span class="line">  9</span>  * The License is based on the Mozilla Public License Version 1.1 but Sections 14 and 15 
<span class="line"> 10</span>  * have been added to cover use of software over a computer network and provide for limited attribution 
<span class="line"> 11</span>  * for the Original Developer. In addition, Exhibit A has been modified to be consistent with Exhibit B. 
<span class="line"> 12</span>  * 
<span class="line"> 13</span>  * Software distributed under the License is distributed on an &#34;AS IS&#34; basis, 
<span class="line"> 14</span>  * WITHOUT WARRANTY OF ANY KIND, either express or implied. 
<span class="line"> 15</span>  * See the License for the specific language governing rights and limitations under the License. 
<span class="line"> 16</span>  * The Original Code is Zimbra Open Source Web Client. 
<span class="line"> 17</span>  * The Initial Developer of the Original Code is Zimbra, Inc. 
<span class="line"> 18</span>  * All portions of the code are Copyright (C) 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014 Zimbra, Inc. All Rights Reserved. 
<span class="line"> 19</span>  * ***** END LICENSE BLOCK *****
<span class="line"> 20</span>  */</span><span class="WHIT">
<span class="line"> 21</span> 
<span class="line"> 22</span> </span><span class="COMM">/**
<span class="line"> 23</span>  * Creates a new, empty double pane controller.
<span class="line"> 24</span>  * @constructor
<span class="line"> 25</span>  * @class
<span class="line"> 26</span>  * This class manages the two-pane view. The top pane contains a list view of 
<span class="line"> 27</span>  * items, and the bottom pane contains the selected item content.
<span class="line"> 28</span>  *
<span class="line"> 29</span>  * @author Parag Shah
<span class="line"> 30</span>  * 
<span class="line"> 31</span>  * @param {DwtControl}					container					the containing shell
<span class="line"> 32</span>  * @param {ZmApp}						mailApp						the containing application
<span class="line"> 33</span>  * @param {constant}					type						type of controller
<span class="line"> 34</span>  * @param {string}						sessionId					the session id
<span class="line"> 35</span>  * @param {ZmSearchResultsController}	searchResultsController		containing controller
<span class="line"> 36</span>  * 
<span class="line"> 37</span>  * @extends		ZmMailListController
<span class="line"> 38</span>  */</span><span class="WHIT">
<span class="line"> 39</span> </span><span class="NAME">ZmDoublePaneController</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">container</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">mailApp</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sessionId</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">searchResultsController</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 40</span> 
<span class="line"> 41</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 42</span> 
<span class="line"> 43</span> </span><span class="WHIT">	</span><span class="NAME">ZmMailListController.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 44</span> 
<span class="line"> 45</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.supportsDnD</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 46</span> </span><span class="WHIT">		</span><span class="NAME">this._dragSrc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">DwtDragSource</span><span class="PUNC">(</span><span class="NAME">Dwt.DND_DROP_MOVE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 47</span> </span><span class="WHIT">		</span><span class="NAME">this._dragSrc.addDragListener</span><span class="PUNC">(</span><span class="NAME">this._dragListener.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 48</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 49</span> </span><span class="WHIT">	
<span class="line"> 50</span> 	</span><span class="NAME">this._listSelectionShortcutDelayAction</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">AjxTimedAction</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._listSelectionTimedAction</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 51</span> </span><span class="WHIT">	</span><span class="NAME">this._listeners</span><span class="PUNC">[</span><span class="NAME">ZmOperation.KEEP_READING</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._keepReadingListener.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 52</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 53</span> 
<span class="line"> 54</span> </span><span class="NAME">ZmDoublePaneController.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ZmMailListController</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 55</span> </span><span class="NAME">ZmDoublePaneController.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmDoublePaneController</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 56</span> 
<span class="line"> 57</span> </span><span class="NAME">ZmDoublePaneController.prototype.isZmDoublePaneController</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 58</span> </span><span class="NAME">ZmDoublePaneController.prototype.toString</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">&#34;ZmDoublePaneController&#34;</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 59</span> 
<span class="line"> 60</span> </span><span class="NAME">ZmDoublePaneController.LIST_SELECTION_SHORTCUT_DELAY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">300</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 61</span> 
<span class="line"> 62</span> </span><span class="NAME">ZmDoublePaneController.RP_IDS</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">ZmSetting.RP_BOTTOM</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ZmSetting.RP_RIGHT</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ZmSetting.RP_OFF</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 63</span> 
<span class="line"> 64</span> </span><span class="NAME">ZmDoublePaneController.DEFAULT_TAB_TEXT</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmMsg.conversation</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 65</span> 
<span class="line"> 66</span> </span><span class="COMM">/**
<span class="line"> 67</span>  * Displays the given list of mail items in a two-pane view where one pane shows the list
<span class="line"> 68</span>  * and the other shows the currently selected mail item (msg or conv). This method takes
<span class="line"> 69</span>  * care of displaying the list. Displaying an item is typically handled via selection.
<span class="line"> 70</span>  *
<span class="line"> 71</span>  * @param {ZmSearchResults}	results		the current search results
<span class="line"> 72</span>  * @param {ZmMailList}		mailList	list of mail items
<span class="line"> 73</span>  * @param {AjxCallback}		callback	the client callback
<span class="line"> 74</span>  * @param {Boolean}			markRead	if &lt;code&gt;true&lt;/code&gt;, mark msg read
<span class="line"> 75</span>  * 
<span class="line"> 76</span>  */</span><span class="WHIT">
<span class="line"> 77</span> </span><span class="NAME">ZmDoublePaneController.prototype.show</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line"> 78</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">results</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">mailList</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">markRead</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 79</span> 
<span class="line"> 80</span> </span><span class="WHIT">	</span><span class="NAME">ZmMailListController.prototype.show.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">results</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 81</span> </span><span class="WHIT">	
<span class="line"> 82</span> 	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mlv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._listView</span><span class="PUNC">[</span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 83</span> 
<span class="line"> 84</span> </span><span class="WHIT">	</span><span class="COMM">// if search was run as a result of a &lt;refresh&gt; block rather than by the user, preserve</span><span class="WHIT">
<span class="line"> 85</span> </span><span class="WHIT">	</span><span class="COMM">// what&#39;s in the reading pane as long as it&#39;s still in the list of results</span><span class="WHIT">
<span class="line"> 86</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">results</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">results.search</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 87</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isRefresh</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">s</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">s.isRefresh</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">s.isRedo</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 88</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">refreshSelItem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">isRefresh</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">mlv</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">mlv.hasItem</span><span class="PUNC">(</span><span class="NAME">s.selectedItem</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">s.selectedItem</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 89</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._doublePaneView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 90</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">refreshSelItem</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 91</span> </span><span class="WHIT">			</span><span class="NAME">this._doublePaneView._itemView.reset</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 92</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 93</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 94</span> </span><span class="WHIT">	</span><span class="NAME">this.setList</span><span class="PUNC">(</span><span class="NAME">mailList</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 95</span> </span><span class="WHIT">	</span><span class="NAME">this._setup</span><span class="PUNC">(</span><span class="NAME">this._currentViewId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 96</span> </span><span class="WHIT">	</span><span class="NAME">mlv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._listView</span><span class="PUNC">[</span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">//might have been created in the _setup call</span><span class="WHIT">
<span class="line"> 97</span> </span><span class="WHIT">	</span><span class="NAME">mlv.reset</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">//called to reset the groups (in case &#34;group by&#34; is used, to clear possible previous items in it - bug 77154</span><span class="WHIT">
<span class="line"> 98</span> 
<span class="line"> 99</span> </span><span class="WHIT">	</span><span class="NAME">this._displayResults</span><span class="PUNC">(</span><span class="NAME">this._currentViewId</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">refreshSelItem</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">100</span> 
<span class="line">101</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">refreshSelItem</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">102</span> </span><span class="WHIT">		</span><span class="NAME">mlv.setSelection</span><span class="PUNC">(</span><span class="NAME">refreshSelItem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">103</span> </span><span class="WHIT">		</span><span class="NAME">this._resetOperations</span><span class="PUNC">(</span><span class="NAME">this._toolbar</span><span class="PUNC">[</span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">104</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">105</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">106</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dpv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._doublePaneView</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">107</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">readingPaneOn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.isReadingPaneOn</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">108</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">dpv.isReadingPaneVisible</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">readingPaneOn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">109</span> </span><span class="WHIT">			</span><span class="NAME">dpv.setReadingPane</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">110</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">111</span> </span><span class="WHIT">		</span><span class="COMM">// clear the item view, unless it&#39;s showing something selected</span><span class="WHIT">
<span class="line">112</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._itemViewCurrent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">113</span> </span><span class="WHIT">			</span><span class="NAME">dpv.clearItem</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">114</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">115</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">116</span> 
<span class="line">117</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">118</span> </span><span class="WHIT">		</span><span class="NAME">callback.run</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">119</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">120</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">121</span> 
<span class="line">122</span> </span><span class="COMM">// returns true if the item shown in the reading pane is selected in the list view</span><span class="WHIT">
<span class="line">123</span> </span><span class="NAME">ZmDoublePaneController.prototype._itemViewCurrent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">124</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">125</span> 
<span class="line">126</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dpv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._doublePaneView</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">127</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mlv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dpv._mailListView</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">128</span> </span><span class="WHIT">	</span><span class="NAME">mlv._restoreState</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">129</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dpv.getItem</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">130</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">131</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">sel</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">mlv.getSelection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">132</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">sel.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">133</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">listItem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">sel</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">134</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">listItem.id</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">item.id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">135</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">136</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">137</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">138</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">139</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">140</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">141</span> 
<span class="line">142</span> </span><span class="NAME">ZmDoublePaneController.prototype.switchView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">143</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">force</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">144</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">ZmSetting.RP_OFF</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">ZmSetting.RP_BOTTOM</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">ZmSetting.RP_RIGHT</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">145</span> </span><span class="WHIT">		</span><span class="NAME">this._mailListView._colHeaderActionMenu</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">146</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oldView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getReadingPanePref</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">147</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">oldView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">148</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">convView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._convView</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">149</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">convView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">150</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">replyView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">convView._replyView</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">151</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">replyView</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">ZmSetting.RP_OFF</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">152</span> </span><span class="WHIT">					</span><span class="COMM">// reset the replyView with the warning before turning off the pane</span><span class="WHIT">
<span class="line">153</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">force</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">convView._controller.popShield</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.switchView.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">154</span> </span><span class="WHIT">						</span><span class="COMM">// redo setChecked on the oldView menu item if user cancels</span><span class="WHIT">
<span class="line">155</span> </span><span class="WHIT">						</span><span class="NAME">this._viewMenu.getMenuItem</span><span class="PUNC">(</span><span class="NAME">oldView</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">_setChecked</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">156</span> </span><span class="WHIT">						</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">157</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">158</span> </span><span class="WHIT">					</span><span class="NAME">this._viewMenu.getMenuItem</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">_setChecked</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">159</span> </span><span class="WHIT">					</span><span class="NAME">replyView.reset</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">160</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">161</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">162</span> </span><span class="WHIT">			</span><span class="NAME">this._setReadingPanePref</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">163</span> </span><span class="WHIT">			</span><span class="NAME">this._doublePaneView.setReadingPane</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">164</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">replyView</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">ZmSetting.RP_OFF</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">165</span> </span><span class="WHIT">				</span><span class="NAME">replyView._resized</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">166</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">167</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">168</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">169</span> </span><span class="WHIT">		</span><span class="NAME">ZmMailListController.prototype.switchView.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">170</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">171</span> </span><span class="WHIT">	</span><span class="NAME">this._resetNavToolBarButtons</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">172</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">173</span> 
<span class="line">174</span> </span><span class="COMM">/**
<span class="line">175</span>  * Clears the conversation view, which actually just clears the message view.
<span class="line">176</span>  */</span><span class="WHIT">
<span class="line">177</span> </span><span class="NAME">ZmDoublePaneController.prototype.reset</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">178</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">179</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._doublePaneView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">180</span> </span><span class="WHIT">		</span><span class="NAME">this._doublePaneView.reset</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">181</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">182</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._listView</span><span class="PUNC">[</span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">183</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lv</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">184</span> </span><span class="WHIT">		</span><span class="NAME">lv._itemToSelect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lv._selectedItem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">185</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">186</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">187</span> 
<span class="line">188</span> </span><span class="NAME">ZmDoublePaneController.prototype._handleResponseSwitchView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">189</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">190</span> </span><span class="WHIT">	</span><span class="NAME">this._doublePaneView.setItem</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">191</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">192</span> 
<span class="line">193</span> </span><span class="COMM">// called after a delete has occurred. </span><span class="WHIT">
<span class="line">194</span> </span><span class="COMM">// Return value indicates whether view was popped as a result of a delete</span><span class="WHIT">
<span class="line">195</span> </span><span class="NAME">ZmDoublePaneController.prototype.handleDelete</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class="line">196</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">197</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">198</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">199</span> 
<span class="line">200</span> </span><span class="NAME">ZmDoublePaneController.prototype.handleKeyAction</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">201</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">actionCode</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ev</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">202</span> 
<span class="line">203</span> </span><span class="WHIT">	</span><span class="NAME">DBG.println</span><span class="PUNC">(</span><span class="NAME">AjxDebug.DBG3</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#34;ZmDoublePaneController.handleKeyAction&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">204</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._listView</span><span class="PUNC">[</span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">205</span> 
<span class="line">206</span> </span><span class="WHIT">	</span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">actionCode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">207</span> 
<span class="line">208</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">DwtKeyMap.SELECT_NEXT</span><span class="PUNC">:</span><span class="WHIT">
<span class="line">209</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">DwtKeyMap.SELECT_PREV</span><span class="PUNC">:</span><span class="WHIT">
<span class="line">210</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lv</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">211</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">lv.handleKeyAction</span><span class="PUNC">(</span><span class="NAME">actionCode</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ev</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">212</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">213</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">214</span> 
<span class="line">215</span> </span><span class="WHIT">		</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class="line">216</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ZmMailListController.prototype.handleKeyAction.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">217</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">218</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">219</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">220</span> 
<span class="line">221</span> </span><span class="COMM">// Private and protected methods</span><span class="WHIT">
<span class="line">222</span> 
<span class="line">223</span> </span><span class="NAME">ZmDoublePaneController.prototype._createDoublePaneView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class="line">224</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">225</span> </span><span class="WHIT">	</span><span class="COMM">// overload me</span><span class="WHIT">
<span class="line">226</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">227</span> 
<span class="line">228</span> </span><span class="COMM">// Creates the conv view, which is not a standard list view (it&#39;s a two-pane</span><span class="WHIT">
<span class="line">229</span> </span><span class="COMM">// sort of thing).</span><span class="WHIT">
<span class="line">230</span> </span><span class="NAME">ZmDoublePaneController.prototype._initialize</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">231</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">232</span> </span><span class="WHIT">	</span><span class="COMM">// set up double pane view (which creates the MLV and MV)</span><span class="WHIT">
<span class="line">233</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._doublePaneView</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class="line">234</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dpv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._doublePaneView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._createDoublePaneView</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">235</span> </span><span class="WHIT">		</span><span class="NAME">this._mailListView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dpv.getMailListView</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">236</span> </span><span class="WHIT">		</span><span class="NAME">dpv.addInviteReplyListener</span><span class="PUNC">(</span><span class="NAME">this._inviteReplyListener</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">237</span> </span><span class="WHIT">		</span><span class="NAME">dpv.addShareListener</span><span class="PUNC">(</span><span class="NAME">this._shareListener</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">238</span> </span><span class="WHIT">		</span><span class="NAME">dpv.addSubscribeListener</span><span class="PUNC">(</span><span class="NAME">this._subscribeListener</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">239</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">240</span> 
<span class="line">241</span> </span><span class="WHIT">	</span><span class="NAME">ZmMailListController.prototype._initialize.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">242</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">243</span> 
<span class="line">244</span> </span><span class="NAME">ZmDoublePaneController.prototype._initializeNavToolBar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">245</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">246</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">toolbar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._toolbar</span><span class="PUNC">[</span><span class="NAME">view</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">247</span> </span><span class="WHIT">	</span><span class="NAME">this._itemCountText</span><span class="PUNC">[</span><span class="NAME">ZmSetting.RP_BOTTOM</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">toolbar.getButton</span><span class="PUNC">(</span><span class="NAME">ZmOperation.TEXT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">248</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">AjxEnv.isFirefox</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">249</span> </span><span class="WHIT">		</span><span class="NAME">this._itemCountText</span><span class="PUNC">[</span><span class="NAME">ZmSetting.RP_BOTTOM</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">setScrollStyle</span><span class="PUNC">(</span><span class="NAME">Dwt.CLIP</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">250</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">251</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">252</span> 
<span class="line">253</span> </span><span class="NAME">ZmDoublePaneController.prototype._getRightSideToolBarOps</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">254</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">255</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">list</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">256</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">appCtxt.isChildWindow</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">257</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">list</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">258</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">259</span> </span><span class="WHIT">	</span><span class="NAME">list.push</span><span class="PUNC">(</span><span class="NAME">ZmOperation.KEEP_READING</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">260</span> </span><span class="WHIT">	</span><span class="NAME">list.push</span><span class="PUNC">(</span><span class="NAME">ZmOperation.VIEW_MENU</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">261</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">list</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">262</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">263</span> 
<span class="line">264</span> </span><span class="NAME">ZmDoublePaneController.prototype._getActionMenuOps</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">265</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">266</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">list</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">267</span> </span><span class="WHIT">	</span><span class="NAME">list</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">list.concat</span><span class="PUNC">(</span><span class="NAME">this._msgOps</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">268</span> </span><span class="WHIT">    </span><span class="NAME">list.push</span><span class="PUNC">(</span><span class="NAME">ZmOperation.REDIRECT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">269</span> </span><span class="WHIT">    </span><span class="NAME">list.push</span><span class="PUNC">(</span><span class="NAME">ZmOperation.EDIT_AS_NEW</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">		</span><span class="COMM">// bug #28717</span><span class="WHIT">
<span class="line">270</span> </span><span class="WHIT">	</span><span class="NAME">list.push</span><span class="PUNC">(</span><span class="NAME">ZmOperation.SEP</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">271</span> </span><span class="WHIT">	</span><span class="NAME">list</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">list.concat</span><span class="PUNC">(</span><span class="NAME">this._deleteOps</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">272</span> </span><span class="WHIT">	</span><span class="NAME">list.push</span><span class="PUNC">(</span><span class="NAME">ZmOperation.SEP</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">273</span> </span><span class="WHIT">	</span><span class="NAME">list</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">list.concat</span><span class="PUNC">(</span><span class="NAME">this._standardActionMenuOps</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">274</span> </span><span class="WHIT">	</span><span class="NAME">list.push</span><span class="PUNC">(</span><span class="NAME">ZmOperation.SEP</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">275</span> </span><span class="WHIT">	</span><span class="NAME">list</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">list.concat</span><span class="PUNC">(</span><span class="NAME">this._flagOps</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">276</span> </span><span class="WHIT">	</span><span class="NAME">list.push</span><span class="PUNC">(</span><span class="NAME">ZmOperation.SEP</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">277</span> </span><span class="WHIT">	</span><span class="NAME">list</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">list.concat</span><span class="PUNC">(</span><span class="NAME">this._createOps</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">278</span> </span><span class="WHIT">	</span><span class="NAME">list.push</span><span class="PUNC">(</span><span class="NAME">ZmOperation.SEP</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">279</span> </span><span class="WHIT">	</span><span class="NAME">list</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">list.concat</span><span class="PUNC">(</span><span class="NAME">this._otherOps</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">280</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.getCurrentViewType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmId.VIEW_TRAD</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">281</span> </span><span class="WHIT">		</span><span class="NAME">list.push</span><span class="PUNC">(</span><span class="NAME">ZmOperation.SHOW_CONV</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">282</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">283</span> </span><span class="WHIT">    </span><span class="COMM">//list.push(ZmOperation.QUICK_COMMANDS);</span><span class="WHIT">
<span class="line">284</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">list</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">285</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">286</span> 
<span class="line">287</span> </span><span class="COMM">// Returns the already-created message list view.</span><span class="WHIT">
<span class="line">288</span> </span><span class="NAME">ZmDoublePaneController.prototype._createNewView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class="line">289</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">290</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._mailListView</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this._dragSrc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">291</span> </span><span class="WHIT">		</span><span class="NAME">this._mailListView.setDragSource</span><span class="PUNC">(</span><span class="NAME">this._dragSrc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">292</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">293</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._mailListView</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">294</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">295</span> 
<span class="line">296</span> </span><span class="COMM">/**
<span class="line">297</span>  * Returns the double-pane view.
<span class="line">298</span>  * 
<span class="line">299</span>  * @return {ZmDoublePaneView}	double-pane view
<span class="line">300</span>  */</span><span class="WHIT">
<span class="line">301</span> </span><span class="NAME">ZmDoublePaneController.prototype.getCurrentView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class="line">302</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">303</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._doublePaneView</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">304</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">305</span> </span><span class="NAME">ZmDoublePaneController.prototype.getReferenceView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmDoublePaneController.prototype.getCurrentView</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">306</span> 
<span class="line">307</span> </span><span class="COMM">/**
<span class="line">308</span>  * Returns the item view.
<span class="line">309</span>  * 
<span class="line">310</span>  * @return {ZmMailItemView}	item view
<span class="line">311</span>  */</span><span class="WHIT">
<span class="line">312</span> </span><span class="NAME">ZmDoublePaneController.prototype.getItemView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class="line">313</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">314</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._doublePaneView</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this._doublePaneView._itemView</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">315</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">316</span> 
<span class="line">317</span> </span><span class="NAME">ZmDoublePaneController.prototype._getTagMenuMsg</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class="line">318</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">num</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">319</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">AjxMessageFormat.format</span><span class="PUNC">(</span><span class="NAME">ZmMsg.tagMessages</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">num</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">320</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">321</span> 
<span class="line">322</span> </span><span class="NAME">ZmDoublePaneController.prototype._getMoveDialogTitle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class="line">323</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">num</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">324</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">AjxMessageFormat.format</span><span class="PUNC">(</span><span class="NAME">ZmMsg.moveMessages</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">num</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">325</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">326</span> 
<span class="line">327</span> </span><span class="COMM">// Add reading pane to focus ring</span><span class="WHIT">
<span class="line">328</span> </span><span class="NAME">ZmDoublePaneController.prototype._initializeTabGroup</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">329</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">330</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._tabGroups</span><span class="PUNC">[</span><span class="NAME">view</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">331</span> 
<span class="line">332</span> </span><span class="WHIT">	</span><span class="NAME">ZmListController.prototype._initializeTabGroup.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">333</span> 
<span class="line">334</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._view</span><span class="PUNC">[</span><span class="NAME">view</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">this.getItemView</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">335</span> </span><span class="WHIT">		</span><span class="NAME">this._tabGroups</span><span class="PUNC">[</span><span class="NAME">view</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">addMember</span><span class="PUNC">(</span><span class="NAME">this.getItemView</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTabGroupMember</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">336</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">337</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">338</span> 
<span class="line">339</span> </span><span class="NAME">ZmDoublePaneController.prototype._setViewContents</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">340</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">341</span> </span><span class="WHIT">	</span><span class="NAME">this._doublePaneView.setList</span><span class="PUNC">(</span><span class="NAME">this._list</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">342</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">343</span> 
<span class="line">344</span> </span><span class="NAME">ZmDoublePaneController.prototype._displayItem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">345</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">346</span> 
<span class="line">347</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">item._loaded</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">348</span> 
<span class="line">349</span> </span><span class="WHIT">	</span><span class="COMM">// cancel timed mark read action on previous msg</span><span class="WHIT">
<span class="line">350</span> </span><span class="WHIT">	</span><span class="NAME">appCtxt.killMarkReadTimer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">351</span> 
<span class="line">352</span> </span><span class="WHIT">	</span><span class="NAME">this._doublePaneView.setItem</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">353</span> </span><span class="WHIT">	</span><span class="NAME">this._handleMarkRead</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">354</span> </span><span class="WHIT">	</span><span class="NAME">this._curItem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">355</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">356</span> </span><span class="NAME">ZmDoublePaneController.prototype._displayMsg</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmDoublePaneController.prototype._displayItem</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">357</span> 
<span class="line">358</span> 
<span class="line">359</span> </span><span class="NAME">ZmDoublePaneController.prototype._markReadAction</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">360</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">361</span> </span><span class="WHIT">	</span><span class="NAME">this._doMarkRead</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">msg</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">362</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">363</span> 
<span class="line">364</span> </span><span class="NAME">ZmDoublePaneController.prototype._preHideCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">365</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">366</span> </span><span class="WHIT">	</span><span class="COMM">// cancel timed mark read action on view change</span><span class="WHIT">
<span class="line">367</span> </span><span class="WHIT">	</span><span class="NAME">appCtxt.killMarkReadTimer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">368</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ZmController.prototype._preHideCallback.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">369</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">370</span> 
<span class="line">371</span> </span><span class="COMM">// Adds a &#34;Reading Pane&#34; menu to the View menu</span><span class="WHIT">
<span class="line">372</span> </span><span class="NAME">ZmDoublePaneController.prototype._setupReadingPaneMenu</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">373</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">menu</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">374</span> 
<span class="line">375</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">readingPaneMenuItem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">menu.createMenuItem</span><span class="PUNC">(</span><span class="NAME">Dwt.getNextId</span><span class="PUNC">(</span><span class="STRN">&#34;READING_PANE_&#34;</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">376</span> </span><span class="WHIT">			</span><span class="NAME">text</span><span class="PUNC">:</span><span class="WHIT">   </span><span class="NAME">ZmMsg.readingPane</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">377</span> </span><span class="WHIT">			</span><span class="NAME">style</span><span class="PUNC">:</span><span class="WHIT">  </span><span class="NAME">DwtMenuItem.NO_STYLE</span><span class="WHIT">
<span class="line">378</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">379</span> </span><span class="WHIT">		</span><span class="NAME">readingPaneMenu</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ZmPopupMenu</span><span class="PUNC">(</span><span class="NAME">readingPaneMenuItem</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">380</span> 
<span class="line">381</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">miParams</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">382</span> </span><span class="WHIT">		</span><span class="NAME">text</span><span class="PUNC">:</span><span class="WHIT">           </span><span class="NAME">ZmMsg.readingPaneAtBottom</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">383</span> </span><span class="WHIT">		</span><span class="NAME">style</span><span class="PUNC">:</span><span class="WHIT">          </span><span class="NAME">DwtMenuItem.RADIO_STYLE</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">384</span> </span><span class="WHIT">		</span><span class="NAME">radioGroupId</span><span class="PUNC">:</span><span class="WHIT">   </span><span class="STRN">&#34;RP&#34;</span><span class="WHIT">
<span class="line">385</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">386</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ids</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmDoublePaneController.RP_IDS</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">387</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pref</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getReadingPanePref</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">388</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">ids.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">389</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ids</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">390</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">readingPaneMenu._menuItems</span><span class="PUNC">[</span><span class="NAME">id</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">391</span> </span><span class="WHIT">			</span><span class="NAME">miParams.text</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmMailListController.READING_PANE_TEXT</span><span class="PUNC">[</span><span class="NAME">id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">392</span> </span><span class="WHIT">			</span><span class="NAME">miParams.image</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmMailListController.READING_PANE_ICON</span><span class="PUNC">[</span><span class="NAME">id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">393</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mi</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">readingPaneMenu.createMenuItem</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">miParams</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">394</span> </span><span class="WHIT">			</span><span class="NAME">mi.setData</span><span class="PUNC">(</span><span class="NAME">ZmOperation.MENUITEM_ID</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">395</span> </span><span class="WHIT">			</span><span class="NAME">mi.addSelectionListener</span><span class="PUNC">(</span><span class="NAME">this._listeners</span><span class="PUNC">[</span><span class="NAME">ZmOperation.VIEW</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">396</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">pref</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">397</span> </span><span class="WHIT">				</span><span class="NAME">mi.setChecked</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">398</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">399</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">400</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">401</span> 
<span class="line">402</span> </span><span class="WHIT">	</span><span class="NAME">readingPaneMenuItem.setMenu</span><span class="PUNC">(</span><span class="NAME">readingPaneMenu</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">403</span> 
<span class="line">404</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">readingPaneMenu</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">405</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">406</span> 
<span class="line">407</span> </span><span class="NAME">ZmDoublePaneController.prototype._displayResults</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">408</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">newTab</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">refreshSelItem</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">409</span> 
<span class="line">410</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">elements</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getViewElements</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._doublePaneView</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">411</span> </span><span class="WHIT">	
<span class="line">412</span> 	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">refreshSelItem</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">413</span> </span><span class="WHIT">		</span><span class="NAME">this._doublePaneView.setReadingPane</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">414</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">415</span> 
<span class="line">416</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tabId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">newTab</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">Dwt.getNextId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">417</span> </span><span class="WHIT">	</span><span class="NAME">this._setView</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">:</span><span class="WHIT">		</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">418</span> </span><span class="WHIT">					</span><span class="NAME">noPush</span><span class="PUNC">:</span><span class="WHIT">		</span><span class="NAME">this.isSearchResults</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">419</span> </span><span class="WHIT">					</span><span class="NAME">viewType</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="NAME">this._currentViewType</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">420</span> </span><span class="WHIT">					</span><span class="NAME">elements</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="NAME">elements</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">421</span> </span><span class="WHIT">					</span><span class="NAME">hide</span><span class="PUNC">:</span><span class="WHIT">		</span><span class="NAME">this._elementsToHide</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">422</span> </span><span class="WHIT">					</span><span class="NAME">tabParams</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="NAME">newTab</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this._getTabParams</span><span class="PUNC">(</span><span class="NAME">tabId</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._tabCallback.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">423</span> </span><span class="WHIT">					</span><span class="NAME">isAppView</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="NAME">this._isTopLevelView</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">424</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isSearchResults</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">425</span> </span><span class="WHIT">		</span><span class="COMM">// if we are switching views, make sure app view mgr is up to date on search view&#39;s components</span><span class="WHIT">
<span class="line">426</span> </span><span class="WHIT">		</span><span class="NAME">appCtxt.getAppViewMgr</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setViewComponents</span><span class="PUNC">(</span><span class="NAME">this.searchResultsController.getCurrentViewId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">elements</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">427</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">428</span> </span><span class="WHIT">	</span><span class="NAME">this._resetNavToolBarButtons</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">429</span> 
<span class="line">430</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">newTab</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">431</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">buttonText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._conv</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this._conv.subject</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this._conv.subject.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ZmAppViewMgr.TAB_BUTTON_MAX_TEXT</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">ZmDoublePaneController.DEFAULT_TAB_TEXT</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">432</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">avm</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">appCtxt.getAppViewMgr</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">433</span> </span><span class="WHIT">		</span><span class="NAME">avm.setTabTitle</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">buttonText</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">434</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">435</span> </span><span class="WHIT">				
<span class="line">436</span> 	</span><span class="COMM">// always allow derived classes to reset size after loading</span><span class="WHIT">
<span class="line">437</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">sz</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._doublePaneView.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">438</span> </span><span class="WHIT">	</span><span class="NAME">this._doublePaneView._resetSize</span><span class="PUNC">(</span><span class="NAME">sz.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sz.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">439</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">440</span> 
<span class="line">441</span> </span><span class="NAME">ZmDoublePaneController.prototype._getTabParams</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">442</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tabId</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tabCallback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">443</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">444</span> </span><span class="WHIT">		</span><span class="NAME">id</span><span class="PUNC">:</span><span class="WHIT">				</span><span class="NAME">tabId</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">445</span> </span><span class="WHIT">		</span><span class="NAME">image</span><span class="PUNC">:</span><span class="WHIT">			</span><span class="STRN">&#34;ConvView&#34;</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">446</span> </span><span class="WHIT">		</span><span class="NAME">textPrecedence</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="NUMB">85</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">447</span> </span><span class="WHIT">		</span><span class="NAME">tooltip</span><span class="PUNC">:</span><span class="WHIT">		</span><span class="NAME">ZmDoublePaneController.DEFAULT_TAB_TEXT</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">448</span> </span><span class="WHIT">		</span><span class="NAME">tabCallback</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="NAME">tabCallback</span><span class="WHIT">
<span class="line">449</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">450</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">451</span> 
<span class="line">452</span> 
<span class="line">453</span> </span><span class="COMM">/**
<span class="line">454</span>  * Loads and displays the given message. If the message was unread, it gets marked as
<span class="line">455</span>  * read, and the conversation may be marked as read as well. Note that we request no
<span class="line">456</span>  * busy overlay during the SOAP call - that&#39;s so that a subsequent click within the
<span class="line">457</span>  * double-click threshold can be processed. Otherwise, it&#39;s very difficult to generate
<span class="line">458</span>  * a double click because the first click triggers a SOAP request and the ensuing busy
<span class="line">459</span>  * overlay blocks the receipt of the second click.
<span class="line">460</span>  * 
<span class="line">461</span>  * @param msg	[ZmMailMsg]		msg to load
<span class="line">462</span>  * 
<span class="line">463</span>  * @private
<span class="line">464</span>  */</span><span class="WHIT">
<span class="line">465</span> </span><span class="NAME">ZmDoublePaneController.prototype._doGetMsg</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">466</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">467</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">468</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">msg.id</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this._pendingMsg</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">469</span> 
<span class="line">470</span> </span><span class="WHIT">	</span><span class="NAME">msg._loadPending</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">471</span> </span><span class="WHIT">	</span><span class="NAME">this._pendingMsg</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">msg.id</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">472</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">respCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">AjxCallback</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._handleResponseDoGetMsg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">msg</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">473</span> </span><span class="WHIT">	</span><span class="NAME">msg.load</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="NAME">respCallback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noBusyOverlay</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">474</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">475</span> 
<span class="line">476</span> </span><span class="NAME">ZmDoublePaneController.prototype._handleResponseDoGetMsg</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">477</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">478</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._pendingMsg</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">msg.id</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">this._pendingMsg</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">479</span> </span><span class="WHIT">	</span><span class="NAME">msg._loadPending</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">480</span> </span><span class="WHIT">	</span><span class="NAME">this._pendingMsg</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">481</span> </span><span class="WHIT">	</span><span class="NAME">this._doublePaneView.setItem</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">482</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">483</span> 
<span class="line">484</span> </span><span class="NAME">ZmDoublePaneController.prototype._resetOperations</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">485</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">num</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">486</span> </span><span class="WHIT">	</span><span class="NAME">ZmMailListController.prototype._resetOperations.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">num</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">487</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isDraft</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.isDraftsFolder</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">488</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">num</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">489</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._mailListView.getSelection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">490</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">491</span> </span><span class="WHIT">			</span><span class="NAME">isDraft</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">item.isDraft</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">492</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">493</span> </span><span class="WHIT">		</span><span class="NAME">parent.enable</span><span class="PUNC">(</span><span class="NAME">ZmOperation.SHOW_ORIG</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">494</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">appCtxt.get</span><span class="PUNC">(</span><span class="NAME">ZmSetting.FILTERS_ENABLED</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">495</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isSyncFailuresFolder</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.isSyncFailuresFolder</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">496</span> </span><span class="WHIT">			</span><span class="NAME">parent.enable</span><span class="PUNC">(</span><span class="NAME">ZmOperation.ADD_FILTER_RULE</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">isSyncFailuresFolder</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">497</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">498</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">499</span> 
<span class="line">500</span> </span><span class="WHIT">	</span><span class="NAME">parent.enable</span><span class="PUNC">(</span><span class="NAME">ZmOperation.DETACH</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">appCtxt.get</span><span class="PUNC">(</span><span class="NAME">ZmSetting.DETACH_MAILVIEW_ENABLED</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">num</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">isDraft</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">501</span> </span><span class="WHIT">	</span><span class="NAME">parent.enable</span><span class="PUNC">(</span><span class="NAME">ZmOperation.TEXT</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">502</span> </span><span class="WHIT">	</span><span class="NAME">parent.enable</span><span class="PUNC">(</span><span class="NAME">ZmOperation.KEEP_READING</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._keepReading</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">503</span> 
<span class="line">504</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">appCtxt.isWebClientOffline</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">505</span> </span><span class="WHIT">		</span><span class="NAME">parent.enable</span><span class="PUNC">(</span><span class="WHIT">
<span class="line">506</span> </span><span class="WHIT">			</span><span class="PUNC">[</span><span class="WHIT">
<span class="line">507</span> </span><span class="WHIT">				</span><span class="NAME">ZmOperation.ACTIONS_MENU</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">508</span> </span><span class="WHIT">				</span><span class="NAME">ZmOperation.VIEW_MENU</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">509</span> </span><span class="WHIT">				</span><span class="NAME">ZmOperation.DETACH</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">510</span> </span><span class="WHIT">				</span><span class="NAME">ZmOperation.SHOW_ORIG</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">511</span> </span><span class="WHIT">				</span><span class="NAME">ZmOperation.SHOW_CONV</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">512</span> </span><span class="WHIT">				</span><span class="NAME">ZmOperation.PRINT</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">513</span> </span><span class="WHIT">				</span><span class="NAME">ZmOperation.ADD_FILTER_RULE</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">514</span> </span><span class="WHIT">				</span><span class="NAME">ZmOperation.CREATE_APPT</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">515</span> </span><span class="WHIT">				</span><span class="NAME">ZmOperation.CREATE_TASK</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">516</span> </span><span class="WHIT">				</span><span class="NAME">ZmOperation.CONTACT</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">517</span> </span><span class="WHIT">				</span><span class="NAME">ZmOperation.REDIRECT</span><span class="WHIT">
<span class="line">518</span> </span><span class="WHIT">			</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">519</span> </span><span class="WHIT">			</span><span class="KEYW">false</span><span class="WHIT">
<span class="line">520</span> </span><span class="WHIT">		</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">521</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">522</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">523</span> 
<span class="line">524</span> </span><span class="NAME">ZmDoublePaneController.prototype._resetOperation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class="line">525</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">op</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">num</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">526</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">op</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmOperation.KEEP_READING</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">527</span> </span><span class="WHIT">		</span><span class="NAME">parent.enable</span><span class="PUNC">(</span><span class="NAME">ZmOperation.KEEP_READING</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._keepReading</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">528</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">529</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">530</span> 
<span class="line">531</span> </span><span class="COMM">// top level view means this view is allowed to get shown when user clicks on </span><span class="WHIT">
<span class="line">532</span> </span><span class="COMM">// app icon in app toolbar - overload to not allow this.</span><span class="WHIT">
<span class="line">533</span> </span><span class="NAME">ZmDoublePaneController.prototype._isTopLevelView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class="line">534</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">535</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">sessionId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getSessionId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">536</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">sessionId</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">sessionId</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmApp.MAIN_SESSION</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">537</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">538</span> 
<span class="line">539</span> </span><span class="COMM">// All items in the list view are gone - show &#34;No Results&#34; and clear reading pane</span><span class="WHIT">
<span class="line">540</span> </span><span class="NAME">ZmDoublePaneController.prototype._handleEmptyList</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">541</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">listView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">542</span> </span><span class="WHIT">	</span><span class="NAME">this.reset</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">543</span> </span><span class="WHIT">	</span><span class="NAME">ZmMailListController.prototype._handleEmptyList.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">544</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">545</span> 
<span class="line">546</span> </span><span class="COMM">// List listeners</span><span class="WHIT">
<span class="line">547</span> 
<span class="line">548</span> </span><span class="COMM">// Clicking on a message in the message list loads and displays it.</span><span class="WHIT">
<span class="line">549</span> </span><span class="NAME">ZmDoublePaneController.prototype._listSelectionListener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">550</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">551</span> 
<span class="line">552</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">handled</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmMailListController.prototype._listSelectionListener.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ev</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">553</span> </span><span class="WHIT">	
<span class="line">554</span> 	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">currView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._listView</span><span class="PUNC">[</span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">555</span> 
<span class="line">556</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">handled</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">ev.detail</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">DwtListView.ITEM_DBL_CLICKED</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">557</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ev.item</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">558</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">559</span> 
<span class="line">560</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">appCtxt.isOffline</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">appCtxt.getCurrentSearch</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">561</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">cs</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">cs.isMultiAccount</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">562</span> </span><span class="WHIT">			</span><span class="NAME">appCtxt.accountList.setActiveAccount</span><span class="PUNC">(</span><span class="NAME">item.getAccount</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">563</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">564</span> 
<span class="line">565</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">div</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._mailListView.getTargetItemDiv</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">566</span> </span><span class="WHIT">		</span><span class="NAME">this._mailListView._itemSelected</span><span class="PUNC">(</span><span class="NAME">div</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ev</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">567</span> 
<span class="line">568</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">appCtxt.get</span><span class="PUNC">(</span><span class="NAME">ZmSetting.SHOW_SELECTION_CHECKBOX</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">569</span> </span><span class="WHIT">			</span><span class="NAME">this._mailListView.setSelectionHdrCbox</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">570</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">571</span> 
<span class="line">572</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">respCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">AjxCallback</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._handleResponseListSelectionListener</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">573</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">folder</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">appCtxt.getById</span><span class="PUNC">(</span><span class="NAME">item.getFolderId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">574</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item.isDraft</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">folder</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">folder.id</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_DRAFTS</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">folder</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">folder.isReadOnly</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">575</span> </span><span class="WHIT">			</span><span class="NAME">this._doAction</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">ev</span><span class="PUNC">:</span><span class="NAME">ev</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">action</span><span class="PUNC">:</span><span class="NAME">ZmOperation.DRAFT</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">576</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">577</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">appCtxt.get</span><span class="PUNC">(</span><span class="NAME">ZmSetting.OPEN_MAIL_IN_NEW_WIN</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">578</span> </span><span class="WHIT">			</span><span class="NAME">this._detachListener</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">respCallback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">579</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">580</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">581</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">respCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">582</span> </span><span class="WHIT">				</span><span class="NAME">this._handleResponseListSelectionListener.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">583</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ctlr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">584</span> </span><span class="WHIT">				</span><span class="NAME">AjxDispatcher.run</span><span class="PUNC">(</span><span class="NAME">item.type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">ZmItem.CONV</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT">
<span class="line">585</span> </span><span class="WHIT">				                  </span><span class="STRN">&#34;GetConvController&#34;</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">&#34;GetMsgController&#34;</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">586</span> </span><span class="WHIT">				                  </span><span class="NAME">item.nId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">587</span> </span><span class="WHIT">			</span><span class="NAME">ctlr.show</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">respCallback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">588</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">589</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">590</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">handled</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">591</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isReadingPaneOn</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">592</span> </span><span class="WHIT">			</span><span class="COMM">// Give the user a chance to zip around the list view via shortcuts without having to</span><span class="WHIT">
<span class="line">593</span> </span><span class="WHIT">			</span><span class="COMM">// wait for each successively selected msg to load, by waiting briefly for more list</span><span class="WHIT">
<span class="line">594</span> </span><span class="WHIT">			</span><span class="COMM">// selection shortcut actions. An event will have the &#39;kbNavEvent&#39; property set if it&#39;s</span><span class="WHIT">
<span class="line">595</span> </span><span class="WHIT">			</span><span class="COMM">// the result of a shortcut.</span><span class="WHIT">
<span class="line">596</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ev.kbNavEvent</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">ZmDoublePaneController.LIST_SELECTION_SHORTCUT_DELAY</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">597</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._listSelectionShortcutDelayActionId</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">598</span> </span><span class="WHIT">					</span><span class="NAME">AjxTimedAction.cancelAction</span><span class="PUNC">(</span><span class="NAME">this._listSelectionShortcutDelayActionId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">599</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">600</span> </span><span class="WHIT">				</span><span class="NAME">this._listSelectionShortcutDelayActionId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AjxTimedAction.scheduleAction</span><span class="PUNC">(</span><span class="NAME">this._listSelectionShortcutDelayAction</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">601</span> </span><span class="WHIT">																						 </span><span class="NAME">ZmDoublePaneController.LIST_SELECTION_SHORTCUT_DELAY</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">602</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">603</span> </span><span class="WHIT">				</span><span class="NAME">this._setSelectedItem</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">604</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">605</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">606</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">607</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">msg</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">currView.getSelection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">608</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">609</span> </span><span class="WHIT">				</span><span class="NAME">this._doublePaneView.resetMsg</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">610</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">611</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">612</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">613</span> 
<span class="line">614</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">handled</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">615</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">616</span> 
<span class="line">617</span> </span><span class="NAME">ZmDoublePaneController.prototype._handleResponseListSelectionListener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">618</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">619</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item.type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmItem.MSG</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">item._loaded</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">item.isUnread</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT">
<span class="line">620</span> </span><span class="WHIT">		</span><span class="PUNC">(</span><span class="NAME">appCtxt.get</span><span class="PUNC">(</span><span class="NAME">ZmSetting.MARK_MSG_READ</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmSetting.MARK_READ_NOW</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">621</span> 
<span class="line">622</span> </span><span class="WHIT">		</span><span class="NAME">this._list.markRead</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">item</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">623</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">624</span> </span><span class="WHIT">	</span><span class="COMM">// make sure correct msg is displayed in msg pane when user returns</span><span class="WHIT">
<span class="line">625</span> </span><span class="WHIT">	</span><span class="NAME">this._setSelectedItem</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">626</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">627</span> 
<span class="line">628</span> </span><span class="NAME">ZmDoublePaneController.prototype._listSelectionTimedAction</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">629</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">630</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._listSelectionShortcutDelayActionId</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">631</span> </span><span class="WHIT">		</span><span class="NAME">AjxTimedAction.cancelAction</span><span class="PUNC">(</span><span class="NAME">this._listSelectionShortcutDelayActionId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">632</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">633</span> </span><span class="WHIT">	</span><span class="NAME">this._setSelectedItem</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">634</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">635</span> 
<span class="line">636</span> </span><span class="COMM">/**
<span class="line">637</span>  * Handles selection of a row by loading the item.
<span class="line">638</span>  * 
<span class="line">639</span>  * @param {hash}	params		params for loading the item
<span class="line">640</span>  * 
<span class="line">641</span>  * @private
<span class="line">642</span>  */</span><span class="WHIT">
<span class="line">643</span> </span><span class="NAME">ZmDoublePaneController.prototype._setSelectedItem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">644</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">params</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">645</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">selCnt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._listView</span><span class="PUNC">[</span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getSelectionCount</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">646</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">selCnt</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">647</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">respCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._handleResponseSetSelectedItem.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">648</span> </span><span class="WHIT">		</span><span class="NAME">this._getLoadedMsg</span><span class="PUNC">(</span><span class="NAME">params</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">respCallback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">649</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">650</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">651</span> 
<span class="line">652</span> </span><span class="NAME">ZmDoublePaneController.prototype._handleResponseSetSelectedItem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">653</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">654</span> 
<span class="line">655</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">656</span> </span><span class="WHIT">		</span><span class="COMM">// bug 41196</span><span class="WHIT">
<span class="line">657</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">appCtxt.isOffline</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">658</span> </span><span class="WHIT">			</span><span class="COMM">// clear the new-mail badge every time user reads a msg regardless</span><span class="WHIT">
<span class="line">659</span> </span><span class="WHIT">			</span><span class="COMM">// of number of unread messages across all accounts</span><span class="WHIT">
<span class="line">660</span> </span><span class="WHIT">			</span><span class="NAME">this._app.clearNewMailBadge</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">661</span> 
<span class="line">662</span> </span><span class="WHIT">			</span><span class="COMM">// offline mode, reset new mail notifier if user reads a msg from that account</span><span class="WHIT">
<span class="line">663</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">acct</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">msg.getAccount</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">664</span> 
<span class="line">665</span> </span><span class="WHIT">			</span><span class="COMM">// bug: 46873 - set active account when user clicks on item w/in cross-account search</span><span class="WHIT">
<span class="line">666</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">appCtxt.getCurrentSearch</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">667</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">cs</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">cs.isMultiAccount</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">668</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">active</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">acct</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">appCtxt.accountList.defaultAccount</span><span class="WHIT">
<span class="line">669</span> </span><span class="WHIT">				</span><span class="NAME">appCtxt.accountList.setActiveAccount</span><span class="PUNC">(</span><span class="NAME">active</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">670</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">671</span> 
<span class="line">672</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">acct</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">acct.inNewMailMode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">673</span> </span><span class="WHIT">				</span><span class="NAME">acct.inNewMailMode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">674</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">allContainers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">appCtxt.getOverviewController</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">_overviewContainer</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">675</span> </span><span class="WHIT">				</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">allContainers</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">676</span> </span><span class="WHIT">					</span><span class="NAME">allContainers</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">updateAccountInfo</span><span class="PUNC">(</span><span class="NAME">acct</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">677</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">678</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">679</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">680</span> 
<span class="line">681</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isReadingPaneOn</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">682</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">683</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">684</span> </span><span class="WHIT">		</span><span class="COMM">// make sure list view has this msg</span><span class="WHIT">
<span class="line">685</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._listView</span><span class="PUNC">[</span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">686</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lv.type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmItem.CONV</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">msg.type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmItem.MSG</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">msg.cid</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">msg.id</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">687</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lv.hasItem</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">688</span> </span><span class="WHIT">			</span><span class="NAME">this._displayMsg</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">689</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">690</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">691</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">692</span> 
<span class="line">693</span> </span><span class="NAME">ZmDoublePaneController.prototype._listActionListener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">694</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">695</span> </span><span class="WHIT">	</span><span class="NAME">ZmMailListController.prototype._listActionListener.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ev</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">696</span> 
<span class="line">697</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isReadingPaneOn</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">698</span> </span><span class="WHIT">		</span><span class="COMM">// reset current message</span><span class="WHIT">
<span class="line">699</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">msg</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._listView</span><span class="PUNC">[</span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getSelection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">700</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">701</span> </span><span class="WHIT">			</span><span class="NAME">this._doublePaneView.resetMsg</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">702</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">703</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">704</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">705</span> 
<span class="line">706</span> </span><span class="NAME">ZmDoublePaneController.prototype._doDelete</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">707</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">items</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">hardDelete</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attrs</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">confirmDelete</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">708</span> </span><span class="WHIT">	</span><span class="NAME">this._listView</span><span class="PUNC">[</span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_itemToSelect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getNextItemToSelect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">709</span> </span><span class="WHIT">	</span><span class="NAME">ZmMailListController.prototype._doDelete.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">710</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">711</span> 
<span class="line">712</span> </span><span class="NAME">ZmDoublePaneController.prototype._doMove</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">713</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">items</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">destinationFolder</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attrs</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">isShiftKey</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">714</span> 
<span class="line">715</span> </span><span class="WHIT">	</span><span class="COMM">// if user moves a non-selected item via DnD, don&#39;t change selection</span><span class="WHIT">
<span class="line">716</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dndUnselectedItem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">717</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">items</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">items.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">718</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getListView</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">719</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">selection</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lv</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">lv.getSelection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">720</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">selection</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">selection.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">721</span> </span><span class="WHIT">			</span><span class="NAME">dndUnselectedItem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">722</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">items</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">id</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">723</span> </span><span class="WHIT">			</span><span class="COMM">// AjxUtil.intersection doesn&#39;t work with objects, so check IDs</span><span class="WHIT">
<span class="line">724</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">selection.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">725</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">selection</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">726</span> </span><span class="WHIT">					</span><span class="NAME">dndUnselectedItem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">727</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">728</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">729</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">730</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">		
<span class="line">731</span> 	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">dndUnselectedItem</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">732</span> </span><span class="WHIT">		</span><span class="NAME">this._listView</span><span class="PUNC">[</span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_itemToSelect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getNextItemToSelect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">733</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">734</span> </span><span class="WHIT">	</span><span class="NAME">ZmMailListController.prototype._doMove.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">735</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">736</span> 
<span class="line">737</span> </span><span class="NAME">ZmDoublePaneController.prototype._keepReadingListener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">738</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">739</span> </span><span class="WHIT">	</span><span class="NAME">this.handleKeyAction</span><span class="PUNC">(</span><span class="NAME">ZmKeyMap.KEEP_READING</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ev</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">740</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">741</span> 
<span class="line">742</span> </span><span class="NAME">ZmDoublePaneController.prototype._keepReading</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">743</span> 
<span class="line">744</span> </span><span class="COMM">// Set enabled state of the KEEP_READING button</span><span class="WHIT">
<span class="line">745</span> </span><span class="NAME">ZmDoublePaneController.prototype._checkKeepReading</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">746</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">747</span> </span><span class="WHIT">	</span><span class="COMM">// done on timer so item view has had change to lay out and resize</span><span class="WHIT">
<span class="line">748</span> </span><span class="WHIT">	</span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="NAME">this._resetOperation.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._toolbar</span><span class="PUNC">[</span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ZmOperation.KEEP_READING</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">250</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">749</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">750</span> 
<span class="line">751</span> </span><span class="NAME">ZmDoublePaneController.handleScroll</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">752</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">753</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">DwtUiEvent.getTarget</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">754</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">messagesView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">DwtControl.findControl</span><span class="PUNC">(</span><span class="NAME">target</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">755</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">controller</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">messagesView</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">messagesView._controller</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">756</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">controller</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">controller._checkKeepReading</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">757</span> </span><span class="WHIT">		</span><span class="NAME">controller._checkKeepReading</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">758</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">759</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">760</span> 
<span class="line">761</span> </span><span class="NAME">ZmDoublePaneController.prototype._dragListener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">762</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">763</span> </span><span class="WHIT">	</span><span class="NAME">ZmListController.prototype._dragListener.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ev</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">764</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ev.action</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">DwtDragEvent.DRAG_END</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">765</span> </span><span class="WHIT">		</span><span class="NAME">this._resetOperations</span><span class="PUNC">(</span><span class="NAME">this._toolbar</span><span class="PUNC">[</span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._doublePaneView.getSelection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">766</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">767</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">768</span> 
<span class="line">769</span> </span><span class="NAME">ZmDoublePaneController.prototype._draftSaved</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">770</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">resp</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">771</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">resp</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">772</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">773</span> </span><span class="WHIT">			</span><span class="NAME">msg</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ZmMailMsg</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">774</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">775</span> </span><span class="WHIT">		</span><span class="NAME">msg._loadFromDom</span><span class="PUNC">(</span><span class="NAME">resp</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">776</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">777</span> </span><span class="WHIT">	</span><span class="NAME">appCtxt.cacheSet</span><span class="PUNC">(</span><span class="NAME">msg.id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">msg</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">778</span> </span><span class="WHIT">	</span><span class="NAME">this._redrawDraftItemRows</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">779</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">displayedMsg</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._doublePaneView.getMsg</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">780</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">displayedMsg</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">displayedMsg.id</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">msg.id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">781</span> </span><span class="WHIT">		</span><span class="NAME">this._doublePaneView.reset</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">782</span> </span><span class="WHIT">		</span><span class="NAME">this._doublePaneView.setItem</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">783</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">784</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">785</span> 
<span class="line">786</span> </span><span class="NAME">ZmDoublePaneController.prototype._redrawDraftItemRows</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">787</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">788</span> </span><span class="WHIT">	</span><span class="NAME">this._listView</span><span class="PUNC">[</span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">redrawItem</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">789</span> </span><span class="WHIT">	</span><span class="NAME">this._listView</span><span class="PUNC">[</span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">setSelection</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">790</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">791</span> 
<span class="line">792</span> </span><span class="NAME">ZmDoublePaneController.prototype.selectFirstItem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">793</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">794</span> </span><span class="WHIT">	</span><span class="NAME">this._doublePaneView._selectFirstItem</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">795</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">796</span> 
<span class="line">797</span> </span><span class="NAME">ZmDoublePaneController.prototype._getDefaultFocusItem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">798</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">799</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getListView</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">800</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">801</span> 
<span class="line">802</span> </span><span class="COMM">/**
<span class="line">803</span>  * Returns the item that should be selected after a move/delete. Finds
<span class="line">804</span>  * the first non-selected item after the first selected item.
<span class="line">805</span>  *
<span class="line">806</span>  * @param	{hash}		omit		hash of item IDs to exclude from being next selected item
<span class="line">807</span>  */</span><span class="WHIT">
<span class="line">808</span> </span><span class="NAME">ZmDoublePaneController.prototype._getNextItemToSelect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">809</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">omit</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">810</span> 
<span class="line">811</span> </span><span class="WHIT">	</span><span class="NAME">omit</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">omit</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">812</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">listView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._listView</span><span class="PUNC">[</span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">813</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">numSelected</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">listView.getSelectionCount</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">814</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">numSelected</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">815</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">selection</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">listView.getSelection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">816</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">selIds</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">817</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">selection.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">818</span> </span><span class="WHIT">			</span><span class="NAME">selIds</span><span class="PUNC">[</span><span class="NAME">selection</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">id</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">819</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">820</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">setting</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">appCtxt.get</span><span class="PUNC">(</span><span class="NAME">ZmSetting.SELECT_AFTER_DELETE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">821</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">goingUp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">setting</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmSetting.DELETE_SELECT_PREV</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">setting</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmSetting.DELETE_SELECT_ADAPT</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT">
<span class="line">822</span> </span><span class="WHIT">						</span><span class="PUNC">(</span><span class="NAME">this.lastListAction</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">DwtKeyMap.SELECT_PREV</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.lastListAction</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmKeyMap.PREV_UNREAD</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">823</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">goingUp</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">numSelected</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">824</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">listView._getRowIndex</span><span class="PUNC">(</span><span class="NAME">selection</span><span class="PUNC">[</span><span class="NAME">selection.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">825</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">childNodes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">listView._parentEl.childNodes</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">826</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&gt;=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">827</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">listView.getItemFromElement</span><span class="PUNC">(</span><span class="NAME">childNodes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">828</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">selIds</span><span class="PUNC">[</span><span class="NAME">item.id</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">omit</span><span class="PUNC">[</span><span class="NAME">item.id</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">item.cid</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">selIds</span><span class="PUNC">[</span><span class="NAME">item.cid</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">omit</span><span class="PUNC">[</span><span class="NAME">item.cid</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">829</span> </span><span class="WHIT">					</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">830</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">831</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">832</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ZmMailListView.FIRST_ITEM</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">833</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">834</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">listView._getRowIndex</span><span class="PUNC">(</span><span class="NAME">selection</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">835</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">childNodes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">listView._parentEl.childNodes</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">836</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">childNodes.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">837</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">listView.getItemFromElement</span><span class="PUNC">(</span><span class="NAME">childNodes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">838</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">selIds</span><span class="PUNC">[</span><span class="NAME">item.id</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">omit</span><span class="PUNC">[</span><span class="NAME">item.id</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">item.cid</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">selIds</span><span class="PUNC">[</span><span class="NAME">item.cid</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">omit</span><span class="PUNC">[</span><span class="NAME">item.cid</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">839</span> </span><span class="WHIT">					</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">840</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">841</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">842</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ZmMailListView.LAST_ITEM</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">843</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">844</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">845</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ZmMailListView.FIRST_ITEM</span><span class="PUNC">;</span><span class="WHIT">	
<span class="line">846</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">847</span> 
<span class="line">848</span> </span><span class="NAME">ZmDoublePaneController.prototype._setItemCountText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">849</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">850</span> 
<span class="line">851</span> </span><span class="WHIT">	</span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._getItemCountText</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">852</span> 
<span class="line">853</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rpr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._getReadingPanePref</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmSetting.RP_RIGHT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">854</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._itemCountText</span><span class="PUNC">[</span><span class="NAME">ZmSetting.RP_RIGHT</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">855</span> </span><span class="WHIT">		</span><span class="NAME">this._itemCountText</span><span class="PUNC">[</span><span class="NAME">ZmSetting.RP_RIGHT</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">setText</span><span class="PUNC">(</span><span class="NAME">rpr</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">&#34;&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">856</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">857</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._itemCountText</span><span class="PUNC">[</span><span class="NAME">ZmSetting.RP_BOTTOM</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">858</span> </span><span class="WHIT">		</span><span class="NAME">this._itemCountText</span><span class="PUNC">[</span><span class="NAME">ZmSetting.RP_BOTTOM</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">setText</span><span class="PUNC">(</span><span class="NAME">rpr</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">&#34;&#34;</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">text</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">859</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">860</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">861</span> 
<span class="line">862</span> </span><span class="NAME">ZmDoublePaneController.prototype._postShowCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">863</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">864</span> 
<span class="line">865</span> </span><span class="WHIT">	</span><span class="NAME">ZmMailListController.prototype._postShowCallback.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">866</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dpv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._doublePaneView</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">867</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">dpv</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">dpv.isStale</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">dpv._staleHandler</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">868</span> </span><span class="WHIT">		</span><span class="NAME">dpv._staleHandler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">869</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">870</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">871</span> </span></pre></body></html>