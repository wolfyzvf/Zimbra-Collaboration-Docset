<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class="line">  1</span> <span class="COMM">/**
<span class="line">  2</span>  * EditorManager.js
<span class="line">  3</span>  *
<span class="line">  4</span>  * Copyright, Moxiecode Systems AB
<span class="line">  5</span>  * Released under LGPL License.
<span class="line">  6</span>  *
<span class="line">  7</span>  * License: http://www.tinymce.com/license
<span class="line">  8</span>  * Contributing: http://www.tinymce.com/contributing
<span class="line">  9</span>  */</span><span class="WHIT">
<span class="line"> 10</span> 
<span class="line"> 11</span> </span><span class="COMM">/**
<span class="line"> 12</span>  * This class used as a factory for manager for tinymce.Editor instances.
<span class="line"> 13</span>  *
<span class="line"> 14</span>  * @example
<span class="line"> 15</span>  * tinymce.EditorManager.init({});
<span class="line"> 16</span>  *
<span class="line"> 17</span>  * @class tinymce.EditorManager
<span class="line"> 18</span>  * @mixes tinymce.util.Observable
<span class="line"> 19</span>  * @static
<span class="line"> 20</span>  */</span><span class="WHIT">
<span class="line"> 21</span> </span><span class="NAME">define</span><span class="PUNC">(</span><span class="STRN">&#34;tinymce/EditorManager&#34;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="WHIT">
<span class="line"> 22</span> </span><span class="WHIT">	</span><span class="STRN">&#34;tinymce/Editor&#34;</span><span class="PUNC">,</span><span class="WHIT">
<span class="line"> 23</span> </span><span class="WHIT">	</span><span class="STRN">&#34;tinymce/dom/DomQuery&#34;</span><span class="PUNC">,</span><span class="WHIT">
<span class="line"> 24</span> </span><span class="WHIT">	</span><span class="STRN">&#34;tinymce/dom/DOMUtils&#34;</span><span class="PUNC">,</span><span class="WHIT">
<span class="line"> 25</span> </span><span class="WHIT">	</span><span class="STRN">&#34;tinymce/util/URI&#34;</span><span class="PUNC">,</span><span class="WHIT">
<span class="line"> 26</span> </span><span class="WHIT">	</span><span class="STRN">&#34;tinymce/Env&#34;</span><span class="PUNC">,</span><span class="WHIT">
<span class="line"> 27</span> </span><span class="WHIT">	</span><span class="STRN">&#34;tinymce/util/Tools&#34;</span><span class="PUNC">,</span><span class="WHIT">
<span class="line"> 28</span> </span><span class="WHIT">	</span><span class="STRN">&#34;tinymce/util/Observable&#34;</span><span class="PUNC">,</span><span class="WHIT">
<span class="line"> 29</span> </span><span class="WHIT">	</span><span class="STRN">&#34;tinymce/util/I18n&#34;</span><span class="PUNC">,</span><span class="WHIT">
<span class="line"> 30</span> </span><span class="WHIT">	</span><span class="STRN">&#34;tinymce/FocusManager&#34;</span><span class="WHIT">
<span class="line"> 31</span> </span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">Editor</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">DomQuery</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">DOMUtils</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">URI</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Env</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Tools</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Observable</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">I18n</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">FocusManager</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 32</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">DOM</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">DOMUtils.DOM</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 33</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">explode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Tools.explode</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">each</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Tools.each</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">extend</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Tools.extend</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 34</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">instanceCounter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">beforeUnloadDelegate</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">EditorManager</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 35</span> 
<span class="line"> 36</span> </span><span class="WHIT">	</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">removeEditorFromList</span><span class="PUNC">(</span><span class="NAME">editor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 37</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">editors</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">EditorManager.editors</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">removedFromList</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 38</span> 
<span class="line"> 39</span> </span><span class="WHIT">		</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">editors</span><span class="PUNC">[</span><span class="NAME">editor.id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 40</span> 
<span class="line"> 41</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">editors.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 42</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">editors</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 43</span> </span><span class="WHIT">				</span><span class="NAME">editors.splice</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 44</span> </span><span class="WHIT">				</span><span class="NAME">removedFromList</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 45</span> </span><span class="WHIT">				</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 46</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 47</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 48</span> 
<span class="line"> 49</span> </span><span class="WHIT">		</span><span class="COMM">// Select another editor since the active one was removed</span><span class="WHIT">
<span class="line"> 50</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">EditorManager.activeEditor</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 51</span> </span><span class="WHIT">			</span><span class="NAME">EditorManager.activeEditor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">editors</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 52</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 53</span> 
<span class="line"> 54</span> </span><span class="WHIT">		</span><span class="COMM">// Clear focusedEditor if necessary, so that we don&#39;t try to blur the destroyed editor</span><span class="WHIT">
<span class="line"> 55</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">EditorManager.focusedEditor</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 56</span> </span><span class="WHIT">			</span><span class="NAME">EditorManager.focusedEditor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 57</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 58</span> 
<span class="line"> 59</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">removedFromList</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 60</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 61</span> 
<span class="line"> 62</span> </span><span class="WHIT">	</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">purgeDestroyedEditor</span><span class="PUNC">(</span><span class="NAME">editor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 63</span> </span><span class="WHIT">		</span><span class="COMM">// User has manually destroyed the editor lets clean up the mess</span><span class="WHIT">
<span class="line"> 64</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">editor</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">editor.getContainer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">editor.getBody</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">parentNode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 65</span> </span><span class="WHIT">			</span><span class="NAME">removeEditorFromList</span><span class="PUNC">(</span><span class="NAME">editor</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 66</span> </span><span class="WHIT">			</span><span class="NAME">editor.unbindAllNativeEvents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 67</span> </span><span class="WHIT">			</span><span class="NAME">editor.destroy</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 68</span> </span><span class="WHIT">			</span><span class="NAME">editor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 69</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 70</span> 
<span class="line"> 71</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 72</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 73</span> 
<span class="line"> 74</span> </span><span class="WHIT">	</span><span class="NAME">EditorManager</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 75</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line"> 76</span> 		 * Dom query instance.
<span class="line"> 77</span> 		 *
<span class="line"> 78</span> 		 * @property $
<span class="line"> 79</span> 		 * @type tinymce.dom.DomQuery
<span class="line"> 80</span> 		 */</span><span class="WHIT">
<span class="line"> 81</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">DomQuery</span><span class="PUNC">,</span><span class="WHIT">
<span class="line"> 82</span> 
<span class="line"> 83</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line"> 84</span> 		 * Major version of TinyMCE build.
<span class="line"> 85</span> 		 *
<span class="line"> 86</span> 		 * @property majorVersion
<span class="line"> 87</span> 		 * @type String
<span class="line"> 88</span> 		 */</span><span class="WHIT">
<span class="line"> 89</span> </span><span class="WHIT">		</span><span class="NAME">majorVersion</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">&#39;@@majorVersion@@&#39;</span><span class="PUNC">,</span><span class="WHIT">
<span class="line"> 90</span> 
<span class="line"> 91</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line"> 92</span> 		 * Minor version of TinyMCE build.
<span class="line"> 93</span> 		 *
<span class="line"> 94</span> 		 * @property minorVersion
<span class="line"> 95</span> 		 * @type String
<span class="line"> 96</span> 		 */</span><span class="WHIT">
<span class="line"> 97</span> </span><span class="WHIT">		</span><span class="NAME">minorVersion</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">&#39;@@minorVersion@@&#39;</span><span class="PUNC">,</span><span class="WHIT">
<span class="line"> 98</span> 
<span class="line"> 99</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line">100</span> 		 * Release date of TinyMCE build.
<span class="line">101</span> 		 *
<span class="line">102</span> 		 * @property releaseDate
<span class="line">103</span> 		 * @type String
<span class="line">104</span> 		 */</span><span class="WHIT">
<span class="line">105</span> </span><span class="WHIT">		</span><span class="NAME">releaseDate</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">&#39;@@releaseDate@@&#39;</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">106</span> 
<span class="line">107</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line">108</span> 		 * Collection of editor instances.
<span class="line">109</span> 		 *
<span class="line">110</span> 		 * @property editors
<span class="line">111</span> 		 * @type Object
<span class="line">112</span> 		 * @example
<span class="line">113</span> 		 * for (edId in tinymce.editors)
<span class="line">114</span> 		 *     tinymce.editors[edId].save();
<span class="line">115</span> 		 */</span><span class="WHIT">
<span class="line">116</span> </span><span class="WHIT">		</span><span class="NAME">editors</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">117</span> 
<span class="line">118</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line">119</span> 		 * Collection of language pack data.
<span class="line">120</span> 		 *
<span class="line">121</span> 		 * @property i18n
<span class="line">122</span> 		 * @type Object
<span class="line">123</span> 		 */</span><span class="WHIT">
<span class="line">124</span> </span><span class="WHIT">		</span><span class="NAME">i18n</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">I18n</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">125</span> 
<span class="line">126</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line">127</span> 		 * Currently active editor instance.
<span class="line">128</span> 		 *
<span class="line">129</span> 		 * @property activeEditor
<span class="line">130</span> 		 * @type tinymce.Editor
<span class="line">131</span> 		 * @example
<span class="line">132</span> 		 * tinyMCE.activeEditor.selection.getContent();
<span class="line">133</span> 		 * tinymce.EditorManager.activeEditor.selection.getContent();
<span class="line">134</span> 		 */</span><span class="WHIT">
<span class="line">135</span> </span><span class="WHIT">		</span><span class="NAME">activeEditor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">136</span> 
<span class="line">137</span> </span><span class="WHIT">		</span><span class="NAME">setup</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">138</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">baseURL</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">documentBaseURL</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">suffix</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;&#34;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">preInit</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">139</span> 
<span class="line">140</span> </span><span class="WHIT">			</span><span class="COMM">// Get base URL for the current document</span><span class="WHIT">
<span class="line">141</span> </span><span class="WHIT">			</span><span class="NAME">documentBaseURL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.location.href</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">142</span> 
<span class="line">143</span> </span><span class="WHIT">			</span><span class="COMM">// Check if the URL is a document based format like: http://site/dir/file and file:///</span><span class="WHIT">
<span class="line">144</span> </span><span class="WHIT">			</span><span class="COMM">// leave other formats like applewebdata://... intact</span><span class="WHIT">
<span class="line">145</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="REGX">/^[^:]+:\/\/\/?[^\/]+\//</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">documentBaseURL</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">146</span> </span><span class="WHIT">				</span><span class="NAME">documentBaseURL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">documentBaseURL.replace</span><span class="PUNC">(</span><span class="REGX">/[\?#].*$/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#39;&#39;</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/[\/\\][^\/]+$/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#39;&#39;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">147</span> 
<span class="line">148</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="REGX">/[\/\\]$/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">documentBaseURL</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">149</span> </span><span class="WHIT">					</span><span class="NAME">documentBaseURL</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#39;/&#39;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">150</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">151</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">152</span> 
<span class="line">153</span> </span><span class="WHIT">			</span><span class="COMM">// If tinymce is defined and has a base use that or use the old tinyMCEPreInit</span><span class="WHIT">
<span class="line">154</span> </span><span class="WHIT">			</span><span class="NAME">preInit</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.tinymce</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">window.tinyMCEPreInit</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">155</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">preInit</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">156</span> </span><span class="WHIT">				</span><span class="NAME">baseURL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">preInit.base</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">preInit.baseURL</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">157</span> </span><span class="WHIT">				</span><span class="NAME">suffix</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">preInit.suffix</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">158</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">159</span> </span><span class="WHIT">				</span><span class="COMM">// Get base where the tinymce script is located</span><span class="WHIT">
<span class="line">160</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">scripts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">&#39;script&#39;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">161</span> </span><span class="WHIT">				</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">scripts.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">162</span> </span><span class="WHIT">					</span><span class="NAME">src</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">scripts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">src</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">163</span> 
<span class="line">164</span> </span><span class="WHIT">					</span><span class="COMM">// Script types supported:</span><span class="WHIT">
<span class="line">165</span> </span><span class="WHIT">					</span><span class="COMM">// tinymce.js tinymce.min.js tinymce.dev.js</span><span class="WHIT">
<span class="line">166</span> </span><span class="WHIT">					</span><span class="COMM">// tinymce.jquery.js tinymce.jquery.min.js tinymce.jquery.dev.js</span><span class="WHIT">
<span class="line">167</span> </span><span class="WHIT">					</span><span class="COMM">// tinymce.full.js tinymce.full.min.js tinymce.full.dev.js</span><span class="WHIT">
<span class="line">168</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="REGX">/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">src</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">169</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">src.indexOf</span><span class="PUNC">(</span><span class="STRN">&#39;.min&#39;</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">170</span> </span><span class="WHIT">							</span><span class="NAME">suffix</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#39;.min&#39;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">171</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">172</span> 
<span class="line">173</span> </span><span class="WHIT">						</span><span class="NAME">baseURL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">src.substring</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src.lastIndexOf</span><span class="PUNC">(</span><span class="STRN">&#39;/&#39;</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">174</span> </span><span class="WHIT">						</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">175</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">176</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">177</span> 
<span class="line">178</span> </span><span class="WHIT">				</span><span class="COMM">// We didn&#39;t find any baseURL by looking at the script elements</span><span class="WHIT">
<span class="line">179</span> </span><span class="WHIT">				</span><span class="COMM">// Try to use the document.currentScript as a fallback</span><span class="WHIT">
<span class="line">180</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">baseURL</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">document.currentScript</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">181</span> </span><span class="WHIT">					</span><span class="NAME">src</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.currentScript.src</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">182</span> 
<span class="line">183</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">src.indexOf</span><span class="PUNC">(</span><span class="STRN">&#39;.min&#39;</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">184</span> </span><span class="WHIT">						</span><span class="NAME">suffix</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#39;.min&#39;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">185</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">186</span> 
<span class="line">187</span> </span><span class="WHIT">					</span><span class="NAME">baseURL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">src.substring</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src.lastIndexOf</span><span class="PUNC">(</span><span class="STRN">&#39;/&#39;</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">188</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">189</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">190</span> 
<span class="line">191</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class="line">192</span> 			 * Base URL where the root directory if TinyMCE is located.
<span class="line">193</span> 			 *
<span class="line">194</span> 			 * @property baseURL
<span class="line">195</span> 			 * @type String
<span class="line">196</span> 			 */</span><span class="WHIT">
<span class="line">197</span> </span><span class="WHIT">			</span><span class="NAME">self.baseURL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">URI</span><span class="PUNC">(</span><span class="NAME">documentBaseURL</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toAbsolute</span><span class="PUNC">(</span><span class="NAME">baseURL</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">198</span> 
<span class="line">199</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class="line">200</span> 			 * Document base URL where the current document is located.
<span class="line">201</span> 			 *
<span class="line">202</span> 			 * @property documentBaseURL
<span class="line">203</span> 			 * @type String
<span class="line">204</span> 			 */</span><span class="WHIT">
<span class="line">205</span> </span><span class="WHIT">			</span><span class="NAME">self.documentBaseURL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">documentBaseURL</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">206</span> 
<span class="line">207</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class="line">208</span> 			 * Absolute baseURI for the installation path of TinyMCE.
<span class="line">209</span> 			 *
<span class="line">210</span> 			 * @property baseURI
<span class="line">211</span> 			 * @type tinymce.util.URI
<span class="line">212</span> 			 */</span><span class="WHIT">
<span class="line">213</span> </span><span class="WHIT">			</span><span class="NAME">self.baseURI</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">URI</span><span class="PUNC">(</span><span class="NAME">self.baseURL</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">214</span> 
<span class="line">215</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class="line">216</span> 			 * Current suffix to add to each plugin/theme that gets loaded for example &#34;.min&#34;.
<span class="line">217</span> 			 *
<span class="line">218</span> 			 * @property suffix
<span class="line">219</span> 			 * @type String
<span class="line">220</span> 			 */</span><span class="WHIT">
<span class="line">221</span> </span><span class="WHIT">			</span><span class="NAME">self.suffix</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">suffix</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">222</span> 
<span class="line">223</span> </span><span class="WHIT">			</span><span class="NAME">self.focusManager</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">FocusManager</span><span class="PUNC">(</span><span class="NAME">self</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">224</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">225</span> 
<span class="line">226</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line">227</span> 		 * Initializes a set of editors. This method will create editors based on various settings.
<span class="line">228</span> 		 *
<span class="line">229</span> 		 * @method init
<span class="line">230</span> 		 * @param {Object} settings Settings object to be passed to each editor instance.
<span class="line">231</span> 		 * @example
<span class="line">232</span> 		 * // Initializes a editor using the longer method
<span class="line">233</span> 		 * tinymce.EditorManager.init({
<span class="line">234</span> 		 *    some_settings : &#39;some value&#39;
<span class="line">235</span> 		 * });
<span class="line">236</span> 		 *
<span class="line">237</span> 		 * // Initializes a editor instance using the shorter version
<span class="line">238</span> 		 * tinyMCE.init({
<span class="line">239</span> 		 *    some_settings : &#39;some value&#39;
<span class="line">240</span> 		 * });
<span class="line">241</span> 		 */</span><span class="WHIT">
<span class="line">242</span> </span><span class="WHIT">		</span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">settings</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">243</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">editors</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">244</span> 
<span class="line">245</span> </span><span class="WHIT">			</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">createId</span><span class="PUNC">(</span><span class="NAME">elm</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">246</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">elm.id</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">247</span> 
<span class="line">248</span> </span><span class="WHIT">				</span><span class="COMM">// Use element id, or unique name or generate a unique id</span><span class="WHIT">
<span class="line">249</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">250</span> </span><span class="WHIT">					</span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">elm.name</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">251</span> 
<span class="line">252</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">DOM.get</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">253</span> </span><span class="WHIT">						</span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">elm.name</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">254</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">255</span> </span><span class="WHIT">						</span><span class="COMM">// Generate unique name</span><span class="WHIT">
<span class="line">256</span> </span><span class="WHIT">						</span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">DOM.uniqueId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">257</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">258</span> 
<span class="line">259</span> </span><span class="WHIT">					</span><span class="NAME">elm.setAttribute</span><span class="PUNC">(</span><span class="STRN">&#39;id&#39;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">260</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">261</span> 
<span class="line">262</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">263</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">264</span> 
<span class="line">265</span> </span><span class="WHIT">			</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">createEditor</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">settings</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">targetElm</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">266</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">purgeDestroyedEditor</span><span class="PUNC">(</span><span class="NAME">self.get</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">267</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Editor</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">settings</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">self</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">268</span> 
<span class="line">269</span> </span><span class="WHIT">					</span><span class="NAME">editor.targetElm</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">editor.targetElm</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">targetElm</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">270</span> </span><span class="WHIT">					</span><span class="NAME">editors.push</span><span class="PUNC">(</span><span class="NAME">editor</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">271</span> </span><span class="WHIT">					</span><span class="NAME">editor.render</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">272</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">273</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">274</span> 
<span class="line">275</span> </span><span class="WHIT">			</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">execCallback</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">276</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">settings</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">277</span> 
<span class="line">278</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">279</span> </span><span class="WHIT">					</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">280</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">281</span> 
<span class="line">282</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">callback.apply</span><span class="PUNC">(</span><span class="NAME">self</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">283</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">284</span> 
<span class="line">285</span> </span><span class="WHIT">			</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">hasClass</span><span class="PUNC">(</span><span class="NAME">elm</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">className</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">286</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">className.constructor</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">className.test</span><span class="PUNC">(</span><span class="NAME">elm.className</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">DOM.hasClass</span><span class="PUNC">(</span><span class="NAME">elm</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">className</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">287</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">288</span> 
<span class="line">289</span> </span><span class="WHIT">			</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">readyHandler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">290</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">co</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">291</span> 
<span class="line">292</span> </span><span class="WHIT">				</span><span class="NAME">DOM.unbind</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#39;ready&#39;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">readyHandler</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">293</span> 
<span class="line">294</span> </span><span class="WHIT">				</span><span class="NAME">execCallback</span><span class="PUNC">(</span><span class="STRN">&#39;onpageload&#39;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">295</span> 
<span class="line">296</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">settings.types</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">297</span> </span><span class="WHIT">					</span><span class="COMM">// Process type specific selector</span><span class="WHIT">
<span class="line">298</span> </span><span class="WHIT">					</span><span class="NAME">each</span><span class="PUNC">(</span><span class="NAME">settings.types</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">299</span> </span><span class="WHIT">						</span><span class="NAME">each</span><span class="PUNC">(</span><span class="NAME">DOM.select</span><span class="PUNC">(</span><span class="NAME">type.selector</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">elm</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">300</span> </span><span class="WHIT">							</span><span class="NAME">createEditor</span><span class="PUNC">(</span><span class="NAME">createId</span><span class="PUNC">(</span><span class="NAME">elm</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">settings</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">elm</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">301</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">302</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">303</span> 
<span class="line">304</span> </span><span class="WHIT">					</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">305</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">settings.selector</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">306</span> </span><span class="WHIT">					</span><span class="COMM">// Process global selector</span><span class="WHIT">
<span class="line">307</span> </span><span class="WHIT">					</span><span class="NAME">each</span><span class="PUNC">(</span><span class="NAME">DOM.select</span><span class="PUNC">(</span><span class="NAME">settings.selector</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">elm</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">308</span> </span><span class="WHIT">						</span><span class="NAME">createEditor</span><span class="PUNC">(</span><span class="NAME">createId</span><span class="PUNC">(</span><span class="NAME">elm</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">settings</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">elm</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">309</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">310</span> 
<span class="line">311</span> </span><span class="WHIT">					</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">312</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">settings.target</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">313</span> </span><span class="WHIT">					</span><span class="NAME">createEditor</span><span class="PUNC">(</span><span class="NAME">createId</span><span class="PUNC">(</span><span class="NAME">settings.target</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">settings</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">314</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">315</span> 
<span class="line">316</span> </span><span class="WHIT">				</span><span class="COMM">// Fallback to old setting</span><span class="WHIT">
<span class="line">317</span> </span><span class="WHIT">				</span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">settings.mode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">318</span> </span><span class="WHIT">					</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;exact&#34;</span><span class="PUNC">:</span><span class="WHIT">
<span class="line">319</span> </span><span class="WHIT">						</span><span class="NAME">l</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">settings.elements</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">&#39;&#39;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">320</span> 
<span class="line">321</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">l.length</span><span class="WHIT"> </span><span class="PUNC">&gt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">322</span> </span><span class="WHIT">							</span><span class="NAME">each</span><span class="PUNC">(</span><span class="NAME">explode</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">323</span> </span><span class="WHIT">								</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">elm</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">324</span> 
<span class="line">325</span> </span><span class="WHIT">								</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">elm</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">DOM.get</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">326</span> </span><span class="WHIT">									</span><span class="NAME">createEditor</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">settings</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">elm</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">327</span> </span><span class="WHIT">								</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">328</span> </span><span class="WHIT">									</span><span class="NAME">each</span><span class="PUNC">(</span><span class="NAME">document.forms</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">329</span> </span><span class="WHIT">										</span><span class="NAME">each</span><span class="PUNC">(</span><span class="NAME">f.elements</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">330</span> </span><span class="WHIT">											</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e.name</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">331</span> </span><span class="WHIT">												</span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#39;mce_editor_&#39;</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">instanceCounter</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">332</span> </span><span class="WHIT">												</span><span class="NAME">DOM.setAttrib</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#39;id&#39;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">333</span> </span><span class="WHIT">												</span><span class="NAME">createEditor</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">settings</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">334</span> </span><span class="WHIT">											</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">335</span> </span><span class="WHIT">										</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">336</span> </span><span class="WHIT">									</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">337</span> </span><span class="WHIT">								</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">338</span> </span><span class="WHIT">							</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">339</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">340</span> </span><span class="WHIT">						</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">341</span> 
<span class="line">342</span> </span><span class="WHIT">					</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;textareas&#34;</span><span class="PUNC">:</span><span class="WHIT">
<span class="line">343</span> </span><span class="WHIT">					</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;specific_textareas&#34;</span><span class="PUNC">:</span><span class="WHIT">
<span class="line">344</span> </span><span class="WHIT">						</span><span class="NAME">each</span><span class="PUNC">(</span><span class="NAME">DOM.select</span><span class="PUNC">(</span><span class="STRN">&#39;textarea&#39;</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">elm</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">345</span> </span><span class="WHIT">							</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">settings.editor_deselector</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">hasClass</span><span class="PUNC">(</span><span class="NAME">elm</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">settings.editor_deselector</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">346</span> </span><span class="WHIT">								</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">347</span> </span><span class="WHIT">							</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">348</span> 
<span class="line">349</span> </span><span class="WHIT">							</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">settings.editor_selector</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">hasClass</span><span class="PUNC">(</span><span class="NAME">elm</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">settings.editor_selector</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">350</span> </span><span class="WHIT">								</span><span class="NAME">createEditor</span><span class="PUNC">(</span><span class="NAME">createId</span><span class="PUNC">(</span><span class="NAME">elm</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">settings</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">elm</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">351</span> </span><span class="WHIT">							</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">352</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">353</span> </span><span class="WHIT">						</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">354</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">355</span> 
<span class="line">356</span> </span><span class="WHIT">				</span><span class="COMM">// Call onInit when all editors are initialized</span><span class="WHIT">
<span class="line">357</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">settings.oninit</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">358</span> </span><span class="WHIT">					</span><span class="NAME">l</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">co</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">359</span> 
<span class="line">360</span> </span><span class="WHIT">					</span><span class="NAME">each</span><span class="PUNC">(</span><span class="NAME">editors</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ed</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">361</span> </span><span class="WHIT">						</span><span class="NAME">co</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">362</span> 
<span class="line">363</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">ed.initialized</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">364</span> </span><span class="WHIT">							</span><span class="COMM">// Wait for it</span><span class="WHIT">
<span class="line">365</span> </span><span class="WHIT">							</span><span class="NAME">ed.on</span><span class="PUNC">(</span><span class="STRN">&#39;init&#39;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">366</span> </span><span class="WHIT">								</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">367</span> 
<span class="line">368</span> </span><span class="WHIT">								</span><span class="COMM">// All done</span><span class="WHIT">
<span class="line">369</span> </span><span class="WHIT">								</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">l</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">co</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">370</span> </span><span class="WHIT">									</span><span class="NAME">execCallback</span><span class="PUNC">(</span><span class="STRN">&#39;oninit&#39;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">371</span> </span><span class="WHIT">								</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">372</span> </span><span class="WHIT">							</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">373</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">374</span> </span><span class="WHIT">							</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">375</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">376</span> 
<span class="line">377</span> </span><span class="WHIT">						</span><span class="COMM">// All done</span><span class="WHIT">
<span class="line">378</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">l</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">co</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">379</span> </span><span class="WHIT">							</span><span class="NAME">execCallback</span><span class="PUNC">(</span><span class="STRN">&#39;oninit&#39;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">380</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">381</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">382</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">383</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">384</span> 
<span class="line">385</span> </span><span class="WHIT">			</span><span class="NAME">self.settings</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">settings</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">386</span> 
<span class="line">387</span> </span><span class="WHIT">			</span><span class="NAME">DOM.bind</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#39;ready&#39;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">readyHandler</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">388</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">389</span> 
<span class="line">390</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line">391</span> 		 * Returns a editor instance by id.
<span class="line">392</span> 		 *
<span class="line">393</span> 		 * @method get
<span class="line">394</span> 		 * @param {String/Number} id Editor instance id or index to return.
<span class="line">395</span> 		 * @return {tinymce.Editor} Editor instance to return.
<span class="line">396</span> 		 * @example
<span class="line">397</span> 		 * // Adds an onclick event to an editor by id (shorter version)
<span class="line">398</span> 		 * tinymce.get(&#39;mytextbox&#39;).on(&#39;click&#39;, function(e) {
<span class="line">399</span> 		 *    ed.windowManager.alert(&#39;Hello world!&#39;);
<span class="line">400</span> 		 * });
<span class="line">401</span> 		 *
<span class="line">402</span> 		 * // Adds an onclick event to an editor by id (longer version)
<span class="line">403</span> 		 * tinymce.EditorManager.get(&#39;mytextbox&#39;).on(&#39;click&#39;, function(e) {
<span class="line">404</span> 		 *    ed.windowManager.alert(&#39;Hello world!&#39;);
<span class="line">405</span> 		 * });
<span class="line">406</span> 		 */</span><span class="WHIT">
<span class="line">407</span> </span><span class="WHIT">		</span><span class="NAME">get</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">408</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">arguments.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">409</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.editors</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">410</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">411</span> 
<span class="line">412</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">id</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.editors</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.editors</span><span class="PUNC">[</span><span class="NAME">id</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">413</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">414</span> 
<span class="line">415</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line">416</span> 		 * Adds an editor instance to the editor collection. This will also set it as the active editor.
<span class="line">417</span> 		 *
<span class="line">418</span> 		 * @method add
<span class="line">419</span> 		 * @param {tinymce.Editor} editor Editor instance to add to the collection.
<span class="line">420</span> 		 * @return {tinymce.Editor} The same instance that got passed in.
<span class="line">421</span> 		 */</span><span class="WHIT">
<span class="line">422</span> </span><span class="WHIT">		</span><span class="NAME">add</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">editor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">423</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">editors</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">self.editors</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">424</span> 
<span class="line">425</span> </span><span class="WHIT">			</span><span class="COMM">// Add named and index editor instance</span><span class="WHIT">
<span class="line">426</span> </span><span class="WHIT">			</span><span class="NAME">editors</span><span class="PUNC">[</span><span class="NAME">editor.id</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">427</span> </span><span class="WHIT">			</span><span class="NAME">editors.push</span><span class="PUNC">(</span><span class="NAME">editor</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">428</span> 
<span class="line">429</span> </span><span class="WHIT">			</span><span class="COMM">// Doesn&#39;t call setActive method since we don&#39;t want</span><span class="WHIT">
<span class="line">430</span> </span><span class="WHIT">			</span><span class="COMM">// to fire a bunch of activate/deactivate calls while initializing</span><span class="WHIT">
<span class="line">431</span> </span><span class="WHIT">			</span><span class="NAME">self.activeEditor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">432</span> 
<span class="line">433</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class="line">434</span> 			 * Fires when an editor is added to the EditorManager collection.
<span class="line">435</span> 			 *
<span class="line">436</span> 			 * @event AddEditor
<span class="line">437</span> 			 * @param {Object} e Event arguments.
<span class="line">438</span> 			 */</span><span class="WHIT">
<span class="line">439</span> </span><span class="WHIT">			</span><span class="NAME">self.fire</span><span class="PUNC">(</span><span class="STRN">&#39;AddEditor&#39;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">editor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">440</span> 
<span class="line">441</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">beforeUnloadDelegate</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">442</span> </span><span class="WHIT">				</span><span class="NAME">beforeUnloadDelegate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">443</span> </span><span class="WHIT">					</span><span class="NAME">self.fire</span><span class="PUNC">(</span><span class="STRN">&#39;BeforeUnload&#39;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">444</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">445</span> 
<span class="line">446</span> </span><span class="WHIT">				</span><span class="NAME">DOM.bind</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#39;beforeunload&#39;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">beforeUnloadDelegate</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">447</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">448</span> 
<span class="line">449</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">450</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">451</span> 
<span class="line">452</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line">453</span> 		 * Creates an editor instance and adds it to the EditorManager collection.
<span class="line">454</span> 		 *
<span class="line">455</span> 		 * @method createEditor
<span class="line">456</span> 		 * @param {String} id Instance id to use for editor.
<span class="line">457</span> 		 * @param {Object} settings Editor instance settings.
<span class="line">458</span> 		 * @return {tinymce.Editor} Editor instance that got created.
<span class="line">459</span> 		 */</span><span class="WHIT">
<span class="line">460</span> </span><span class="WHIT">		</span><span class="NAME">createEditor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">settings</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">461</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Editor</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">settings</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">462</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">463</span> 
<span class="line">464</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line">465</span> 		 * Removes a editor or editors form page.
<span class="line">466</span> 		 *
<span class="line">467</span> 		 * @example
<span class="line">468</span> 		 * // Remove all editors bound to divs
<span class="line">469</span> 		 * tinymce.remove(&#39;div&#39;);
<span class="line">470</span> 		 *
<span class="line">471</span> 		 * // Remove all editors bound to textareas
<span class="line">472</span> 		 * tinymce.remove(&#39;textarea&#39;);
<span class="line">473</span> 		 *
<span class="line">474</span> 		 * // Remove all editors
<span class="line">475</span> 		 * tinymce.remove();
<span class="line">476</span> 		 *
<span class="line">477</span> 		 * // Remove specific instance by id
<span class="line">478</span> 		 * tinymce.remove(&#39;#id&#39;);
<span class="line">479</span> 		 *
<span class="line">480</span> 		 * @method remove
<span class="line">481</span> 		 * @param {tinymce.Editor/String/Object} [selector] CSS selector or editor instance to remove.
<span class="line">482</span> 		 * @return {tinymce.Editor} The editor that got passed in will be return if it was found otherwise null.
<span class="line">483</span> 		 */</span><span class="WHIT">
<span class="line">484</span> </span><span class="WHIT">		</span><span class="NAME">remove</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">selector</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">485</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">editors</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">self.editors</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">486</span> 
<span class="line">487</span> </span><span class="WHIT">			</span><span class="COMM">// Remove all editors</span><span class="WHIT">
<span class="line">488</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">selector</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">489</span> </span><span class="WHIT">				</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">editors.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&gt;=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">490</span> </span><span class="WHIT">					</span><span class="NAME">self.remove</span><span class="PUNC">(</span><span class="NAME">editors</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">491</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">492</span> 
<span class="line">493</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">494</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">495</span> 
<span class="line">496</span> </span><span class="WHIT">			</span><span class="COMM">// Remove editors by selector</span><span class="WHIT">
<span class="line">497</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">selector</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">&#34;string&#34;</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">498</span> </span><span class="WHIT">				</span><span class="NAME">selector</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">selector.selector</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">selector</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">499</span> 
<span class="line">500</span> </span><span class="WHIT">				</span><span class="NAME">each</span><span class="PUNC">(</span><span class="NAME">DOM.select</span><span class="PUNC">(</span><span class="NAME">selector</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">elm</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">501</span> </span><span class="WHIT">					</span><span class="NAME">editor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">editors</span><span class="PUNC">[</span><span class="NAME">elm.id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">502</span> 
<span class="line">503</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">editor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">504</span> </span><span class="WHIT">						</span><span class="NAME">self.remove</span><span class="PUNC">(</span><span class="NAME">editor</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">505</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">506</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">507</span> 
<span class="line">508</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">509</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">510</span> 
<span class="line">511</span> </span><span class="WHIT">			</span><span class="COMM">// Remove specific editor</span><span class="WHIT">
<span class="line">512</span> </span><span class="WHIT">			</span><span class="NAME">editor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">selector</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">513</span> 
<span class="line">514</span> </span><span class="WHIT">			</span><span class="COMM">// Not in the collection</span><span class="WHIT">
<span class="line">515</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">editors</span><span class="PUNC">[</span><span class="NAME">editor.id</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">516</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">517</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">518</span> 
<span class="line">519</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class="line">520</span> 			 * Fires when an editor is removed from EditorManager collection.
<span class="line">521</span> 			 *
<span class="line">522</span> 			 * @event RemoveEditor
<span class="line">523</span> 			 * @param {Object} e Event arguments.
<span class="line">524</span> 			 */</span><span class="WHIT">
<span class="line">525</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">removeEditorFromList</span><span class="PUNC">(</span><span class="NAME">editor</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">526</span> </span><span class="WHIT">				</span><span class="NAME">self.fire</span><span class="PUNC">(</span><span class="STRN">&#39;RemoveEditor&#39;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">editor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">527</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">528</span> 
<span class="line">529</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">editors.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">530</span> </span><span class="WHIT">				</span><span class="NAME">DOM.unbind</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#39;beforeunload&#39;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">beforeUnloadDelegate</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">531</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">532</span> 
<span class="line">533</span> </span><span class="WHIT">			</span><span class="NAME">editor.remove</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">534</span> 
<span class="line">535</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">536</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">537</span> 
<span class="line">538</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line">539</span> 		 * Executes a specific command on the currently active editor.
<span class="line">540</span> 		 *
<span class="line">541</span> 		 * @method execCommand
<span class="line">542</span> 		 * @param {String} c Command to perform for example Bold.
<span class="line">543</span> 		 * @param {Boolean} u Optional boolean state if a UI should be presented for the command or not.
<span class="line">544</span> 		 * @param {String} v Optional value parameter like for example an URL to a link.
<span class="line">545</span> 		 * @return {Boolean} true/false if the command was executed or not.
<span class="line">546</span> 		 */</span><span class="WHIT">
<span class="line">547</span> </span><span class="WHIT">		</span><span class="NAME">execCommand</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">cmd</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ui</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">548</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">self.get</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">549</span> 
<span class="line">550</span> </span><span class="WHIT">			</span><span class="COMM">// Manager commands</span><span class="WHIT">
<span class="line">551</span> </span><span class="WHIT">			</span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">cmd</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">552</span> </span><span class="WHIT">				</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;mceAddEditor&#34;</span><span class="PUNC">:</span><span class="WHIT">
<span class="line">553</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">self.get</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">554</span> </span><span class="WHIT">						</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Editor</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">self.settings</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">self</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">render</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">555</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">556</span> 
<span class="line">557</span> </span><span class="WHIT">					</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">558</span> 
<span class="line">559</span> </span><span class="WHIT">				</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;mceRemoveEditor&#34;</span><span class="PUNC">:</span><span class="WHIT">
<span class="line">560</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">editor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">561</span> </span><span class="WHIT">						</span><span class="NAME">editor.remove</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">562</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">563</span> 
<span class="line">564</span> </span><span class="WHIT">					</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">565</span> 
<span class="line">566</span> </span><span class="WHIT">				</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#39;mceToggleEditor&#39;</span><span class="PUNC">:</span><span class="WHIT">
<span class="line">567</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">editor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">568</span> </span><span class="WHIT">						</span><span class="NAME">self.execCommand</span><span class="PUNC">(</span><span class="STRN">&#39;mceAddEditor&#39;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">569</span> </span><span class="WHIT">						</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">570</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">571</span> 
<span class="line">572</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">editor.isHidden</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">573</span> </span><span class="WHIT">						</span><span class="NAME">editor.show</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">574</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">575</span> </span><span class="WHIT">						</span><span class="NAME">editor.hide</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">576</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">577</span> 
<span class="line">578</span> </span><span class="WHIT">					</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">579</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">580</span> 
<span class="line">581</span> </span><span class="WHIT">			</span><span class="COMM">// Run command on active editor</span><span class="WHIT">
<span class="line">582</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">self.activeEditor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">583</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">self.activeEditor.execCommand</span><span class="PUNC">(</span><span class="NAME">cmd</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ui</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">584</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">585</span> 
<span class="line">586</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">587</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">588</span> 
<span class="line">589</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line">590</span> 		 * Calls the save method on all editor instances in the collection. This can be useful when a form is to be submitted.
<span class="line">591</span> 		 *
<span class="line">592</span> 		 * @method triggerSave
<span class="line">593</span> 		 * @example
<span class="line">594</span> 		 * // Saves all contents
<span class="line">595</span> 		 * tinyMCE.triggerSave();
<span class="line">596</span> 		 */</span><span class="WHIT">
<span class="line">597</span> </span><span class="WHIT">		</span><span class="NAME">triggerSave</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">598</span> </span><span class="WHIT">			</span><span class="NAME">each</span><span class="PUNC">(</span><span class="NAME">this.editors</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">editor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">599</span> </span><span class="WHIT">				</span><span class="NAME">editor.save</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">600</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">601</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">602</span> 
<span class="line">603</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line">604</span> 		 * Adds a language pack, this gets called by the loaded language files like en.js.
<span class="line">605</span> 		 *
<span class="line">606</span> 		 * @method addI18n
<span class="line">607</span> 		 * @param {String} code Optional language code.
<span class="line">608</span> 		 * @param {Object} items Name/value object with translations.
<span class="line">609</span> 		 */</span><span class="WHIT">
<span class="line">610</span> </span><span class="WHIT">		</span><span class="NAME">addI18n</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">code</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">items</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">611</span> </span><span class="WHIT">			</span><span class="NAME">I18n.add</span><span class="PUNC">(</span><span class="NAME">code</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">items</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">612</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">613</span> 
<span class="line">614</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line">615</span> 		 * Translates the specified string using the language pack items.
<span class="line">616</span> 		 *
<span class="line">617</span> 		 * @method translate
<span class="line">618</span> 		 * @param {String/Array/Object} text String to translate
<span class="line">619</span> 		 * @return {String} Translated string.
<span class="line">620</span> 		 */</span><span class="WHIT">
<span class="line">621</span> </span><span class="WHIT">		</span><span class="NAME">translate</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">622</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">I18n.translate</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">623</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">624</span> 
<span class="line">625</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class="line">626</span> 		 * Sets the active editor instance and fires the deactivate/activate events.
<span class="line">627</span> 		 *
<span class="line">628</span> 		 * @method setActive
<span class="line">629</span> 		 * @param {tinymce.Editor} editor Editor instance to set as the active instance.
<span class="line">630</span> 		 */</span><span class="WHIT">
<span class="line">631</span> </span><span class="WHIT">		</span><span class="NAME">setActive</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">editor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">632</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">activeEditor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.activeEditor</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">633</span> 
<span class="line">634</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.activeEditor</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">635</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">activeEditor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">636</span> </span><span class="WHIT">					</span><span class="NAME">activeEditor.fire</span><span class="PUNC">(</span><span class="STRN">&#39;deactivate&#39;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">relatedTarget</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">637</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">638</span> 
<span class="line">639</span> </span><span class="WHIT">				</span><span class="NAME">editor.fire</span><span class="PUNC">(</span><span class="STRN">&#39;activate&#39;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">relatedTarget</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">activeEditor</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">640</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">641</span> 
<span class="line">642</span> </span><span class="WHIT">			</span><span class="NAME">this.activeEditor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">editor</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">643</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">644</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">645</span> 
<span class="line">646</span> </span><span class="WHIT">	</span><span class="NAME">extend</span><span class="PUNC">(</span><span class="NAME">EditorManager</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Observable</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">647</span> 
<span class="line">648</span> </span><span class="WHIT">	</span><span class="NAME">EditorManager.setup</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">649</span> 
<span class="line">650</span> </span><span class="WHIT">	</span><span class="COMM">// Export EditorManager as tinymce/tinymce in global namespace</span><span class="WHIT">
<span class="line">651</span> </span><span class="WHIT">	</span><span class="NAME">window.tinymce</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.tinyMCE</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">EditorManager</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">652</span> 
<span class="line">653</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">EditorManager</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">654</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">655</span> </span></pre></body></html>