<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class="line">  1</span> <span class="COMM">/*
<span class="line">  2</span>  * ***** BEGIN LICENSE BLOCK *****
<span class="line">  3</span>  * Zimbra Collaboration Suite Web Client
<span class="line">  4</span>  * Copyright (C) 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014 Zimbra, Inc.
<span class="line">  5</span>  * 
<span class="line">  6</span>  * The contents of this file are subject to the Common Public Attribution License Version 1.0 (the &#34;License&#34;);
<span class="line">  7</span>  * you may not use this file except in compliance with the License. 
<span class="line">  8</span>  * You may obtain a copy of the License at: http://www.zimbra.com/license
<span class="line">  9</span>  * The License is based on the Mozilla Public License Version 1.1 but Sections 14 and 15 
<span class="line"> 10</span>  * have been added to cover use of software over a computer network and provide for limited attribution 
<span class="line"> 11</span>  * for the Original Developer. In addition, Exhibit A has been modified to be consistent with Exhibit B. 
<span class="line"> 12</span>  * 
<span class="line"> 13</span>  * Software distributed under the License is distributed on an &#34;AS IS&#34; basis, 
<span class="line"> 14</span>  * WITHOUT WARRANTY OF ANY KIND, either express or implied. 
<span class="line"> 15</span>  * See the License for the specific language governing rights and limitations under the License. 
<span class="line"> 16</span>  * The Original Code is Zimbra Open Source Web Client. 
<span class="line"> 17</span>  * The Initial Developer of the Original Code is Zimbra, Inc. 
<span class="line"> 18</span>  * All portions of the code are Copyright (C) 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014 Zimbra, Inc. All Rights Reserved. 
<span class="line"> 19</span>  * ***** END LICENSE BLOCK *****
<span class="line"> 20</span>  */</span><span class="WHIT">
<span class="line"> 21</span> 
<span class="line"> 22</span> </span><span class="COMM">/**
<span class="line"> 23</span>  * Creates a new, empty preferences controller.
<span class="line"> 24</span>  * @constructor
<span class="line"> 25</span>  * @class
<span class="line"> 26</span>  * This class represents the preferences controller. This controller manages
<span class="line"> 27</span>  * the options pages.
<span class="line"> 28</span>  *
<span class="line"> 29</span>  * @author Conrad Damon
<span class="line"> 30</span>  *
<span class="line"> 31</span>  * @param {DwtShell}			container		the shell
<span class="line"> 32</span>  * @param {ZmPreferencesApp}	prefsApp		the preferences application
<span class="line"> 33</span>  * 
<span class="line"> 34</span>  * @extends		ZmController
<span class="line"> 35</span>  */</span><span class="WHIT">
<span class="line"> 36</span> </span><span class="NAME">ZmPrefController</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">container</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">prefsApp</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 37</span> 
<span class="line"> 38</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 39</span> </span><span class="WHIT">	
<span class="line"> 40</span> 	</span><span class="NAME">ZmController.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">container</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">prefsApp</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 41</span> 
<span class="line"> 42</span> </span><span class="WHIT">	</span><span class="NAME">this._listeners</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 43</span> </span><span class="WHIT">	</span><span class="NAME">this._listeners</span><span class="PUNC">[</span><span class="NAME">ZmOperation.SAVE</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._saveListener.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 44</span> </span><span class="WHIT">	</span><span class="NAME">this._listeners</span><span class="PUNC">[</span><span class="NAME">ZmOperation.CANCEL</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._backListener.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 45</span> </span><span class="WHIT">	</span><span class="NAME">this._listeners</span><span class="PUNC">[</span><span class="NAME">ZmOperation.REVERT_PAGE</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line"> 46</span> </span><span class="WHIT">		</span><span class="NAME">this._resetPageListener.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 47</span> 
<span class="line"> 48</span> </span><span class="WHIT">	</span><span class="NAME">this._filtersEnabled</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">appCtxt.get</span><span class="PUNC">(</span><span class="NAME">ZmSetting.FILTERS_ENABLED</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 49</span> </span><span class="WHIT">	</span><span class="NAME">this._dirty</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 50</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 51</span> 
<span class="line"> 52</span> </span><span class="NAME">ZmPrefController.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ZmController</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 53</span> </span><span class="NAME">ZmPrefController.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmPrefController</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 54</span> 
<span class="line"> 55</span> </span><span class="NAME">ZmPrefController.prototype.isZmPrefController</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 56</span> </span><span class="NAME">ZmPrefController.prototype.toString</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">&#34;ZmPrefController&#34;</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 57</span> 
<span class="line"> 58</span> 
<span class="line"> 59</span> </span><span class="NAME">ZmPrefController.getDefaultViewType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line"> 60</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 61</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ZmId.VIEW_PREF</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 62</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 63</span> </span><span class="NAME">ZmPrefController.prototype.getDefaultViewType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmPrefController.getDefaultViewType</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 64</span> 
<span class="line"> 65</span> </span><span class="COMM">/**
<span class="line"> 66</span>  * Shows the tab options pages.
<span class="line"> 67</span>  */</span><span class="WHIT">
<span class="line"> 68</span> </span><span class="NAME">ZmPrefController.prototype.show</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class="line"> 69</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 70</span> </span><span class="WHIT">	</span><span class="NAME">this._setView</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 71</span> </span><span class="WHIT">	</span><span class="NAME">this._prefsView.show</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 72</span> </span><span class="WHIT">	</span><span class="NAME">this._app.pushView</span><span class="PUNC">(</span><span class="NAME">this._currentViewId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 73</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 74</span> 
<span class="line"> 75</span> </span><span class="COMM">/**
<span class="line"> 76</span>  * Gets the preferences view (a view with tabs).
<span class="line"> 77</span>  * 
<span class="line"> 78</span>  * @return	{ZmPrefView}		the preferences view
<span class="line"> 79</span>  */</span><span class="WHIT">
<span class="line"> 80</span> </span><span class="NAME">ZmPrefController.prototype.getPrefsView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line"> 81</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 82</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._prefsView</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 83</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 84</span> 
<span class="line"> 85</span> </span><span class="COMM">/**
<span class="line"> 86</span>  * Gets the current preferences page
<span class="line"> 87</span>  *
<span class="line"> 88</span>  * @return	{ZmPreferencesPage}		the current page
<span class="line"> 89</span>  */</span><span class="WHIT">
<span class="line"> 90</span> </span><span class="NAME">ZmPrefController.prototype.getCurrentPage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line"> 91</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 92</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tabKey</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._prefsView.getCurrentTab</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 93</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._prefsView.getTabView</span><span class="PUNC">(</span><span class="NAME">tabKey</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 94</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 95</span> 
<span class="line"> 96</span> </span><span class="COMM">/**
<span class="line"> 97</span>  * Gets the account test dialog.
<span class="line"> 98</span>  * 
<span class="line"> 99</span>  * @return	{ZmAccountTestDialog}	the account test dialog
<span class="line">100</span>  */</span><span class="WHIT">
<span class="line">101</span> </span><span class="NAME">ZmPrefController.prototype.getTestDialog</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">102</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">103</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._testDialog</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">104</span> </span><span class="WHIT">		</span><span class="NAME">this._testDialog</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ZmAccountTestDialog</span><span class="PUNC">(</span><span class="NAME">this._container</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">105</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">106</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._testDialog</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">107</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">108</span> 
<span class="line">109</span> </span><span class="COMM">/**
<span class="line">110</span>  * Gets the filter controller.
<span class="line">111</span>  * 
<span class="line">112</span>  * @return	{ZmFilterController}	the filter controller
<span class="line">113</span>  */</span><span class="WHIT">
<span class="line">114</span> </span><span class="NAME">ZmPrefController.prototype.getFilterController</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">115</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">section</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">116</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._filterController</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">117</span> </span><span class="WHIT">		</span><span class="NAME">this._filterController</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ZmFilterController</span><span class="PUNC">(</span><span class="NAME">this._container</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._app</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._prefsView</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">section</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">ZmPref.getPrefSectionWithPref</span><span class="PUNC">(</span><span class="NAME">ZmSetting.FILTERS</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">118</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">119</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._filterController</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">120</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">121</span> 
<span class="line">122</span> </span><span class="COMM">/**
<span class="line">123</span>  * Gets the mobile devices controller.
<span class="line">124</span>  * 
<span class="line">125</span>  * @return	{ZmMobileDevicesController}	the mobile devices controller
<span class="line">126</span>  */</span><span class="WHIT">
<span class="line">127</span> </span><span class="NAME">ZmPrefController.prototype.getMobileDevicesController</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">128</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">129</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._mobileDevicesController</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">130</span> </span><span class="WHIT">		</span><span class="NAME">this._mobileDevicesController</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ZmMobileDevicesController</span><span class="PUNC">(</span><span class="NAME">this._container</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._app</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._prefsView</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">131</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">132</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._mobileDevicesController</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">133</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">134</span> 
<span class="line">135</span> </span><span class="COMM">/**
<span class="line">136</span>  * Checks for a precondition on the given object. If one is found, it is
<span class="line">137</span>  * evaluated based on its type. Note that the precondition must be contained
<span class="line">138</span>  * within the object in a property named &#34;precondition&#34;.
<span class="line">139</span>  *
<span class="line">140</span>  * @param obj			[object]	an object, possibly with a &#34;precondition&#34; property.
<span class="line">141</span>  * @param precondition	[object]*	explicit precondition to check
<span class="line">142</span>  * 
<span class="line">143</span>  * @private
<span class="line">144</span>  */</span><span class="WHIT">
<span class="line">145</span> </span><span class="NAME">ZmPrefController.prototype.checkPreCondition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">146</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">precondition</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">147</span> </span><span class="WHIT">	</span><span class="COMM">// No object, nothing to check</span><span class="WHIT">
<span class="line">148</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">ZmSetting</span><span class="PUNC">[</span><span class="NAME">precondition</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">149</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">150</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">151</span> </span><span class="WHIT">	</span><span class="COMM">// Object lacks &#34;precondition&#34; property, nothing to check</span><span class="WHIT">
<span class="line">152</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="STRN">&#34;precondition&#34;</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">153</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">154</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">155</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">obj.precondition</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">precondition</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">156</span> </span><span class="WHIT">	</span><span class="COMM">// Object has a precondition that didn&#39;t get defined, probably because its</span><span class="WHIT">
<span class="line">157</span> </span><span class="WHIT">	</span><span class="COMM">// app is not enabled. That equates to failure for the precondition.</span><span class="WHIT">
<span class="line">158</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">159</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">160</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">161</span> </span><span class="WHIT">	</span><span class="COMM">// Precondition is set to true or false</span><span class="WHIT">
<span class="line">162</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">AjxUtil.isBoolean</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">163</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">164</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">165</span> </span><span class="WHIT">	</span><span class="COMM">// Precondition is a function, look at its result</span><span class="WHIT">
<span class="line">166</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">AjxUtil.isFunction</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">167</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">168</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">169</span> </span><span class="WHIT">	</span><span class="COMM">// A list of preconditions is ORed together via a recursive call</span><span class="WHIT">
<span class="line">170</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">AjxUtil.isArray</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">171</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">count</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">p.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">count</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">172</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.checkPreCondition</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">173</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">174</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">175</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">176</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">177</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">178</span> </span><span class="WHIT">	</span><span class="COMM">// Assume that the precondition is a setting, and return its value</span><span class="WHIT">
<span class="line">179</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Boolean</span><span class="PUNC">(</span><span class="NAME">appCtxt.get</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">180</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">181</span> 
<span class="line">182</span> </span><span class="NAME">ZmPrefController.prototype.getKeyMapName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">183</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">184</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ZmKeyMap.MAP_OPTIONS</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">185</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">186</span> 
<span class="line">187</span> </span><span class="NAME">ZmPrefController.prototype.handleKeyAction</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">188</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">actionCode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">189</span> </span><span class="WHIT">	</span><span class="NAME">DBG.println</span><span class="PUNC">(</span><span class="STRN">&#34;ZmPrefController.handleKeyAction&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">190</span> </span><span class="WHIT">	</span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">actionCode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">191</span> 
<span class="line">192</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">ZmKeyMap.CANCEL</span><span class="PUNC">:</span><span class="WHIT">
<span class="line">193</span> </span><span class="WHIT">			</span><span class="NAME">this._backListener</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">194</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">195</span> 
<span class="line">196</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">ZmKeyMap.SAVE</span><span class="PUNC">:</span><span class="WHIT">
<span class="line">197</span> </span><span class="WHIT">			</span><span class="NAME">this._saveListener</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">198</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">199</span> 
<span class="line">200</span> </span><span class="WHIT">		</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class="line">201</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ZmController.prototype.handleKeyAction.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">actionCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">202</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">203</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">204</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">205</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">206</span> 
<span class="line">207</span> </span><span class="NAME">ZmPrefController.prototype.mapSupported</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">208</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">map</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">209</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">map</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">&#34;tabView&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">210</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">211</span> 
<span class="line">212</span> </span><span class="COMM">/**
<span class="line">213</span>  * Gets the tab view.
<span class="line">214</span>  * 
<span class="line">215</span>  * @return	{ZmPrefView}		the preferences view
<span class="line">216</span>  * 
<span class="line">217</span>  * @see		#getPrefsView
<span class="line">218</span>  */</span><span class="WHIT">
<span class="line">219</span> </span><span class="NAME">ZmPrefController.prototype.getTabView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">220</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">221</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getPrefsView</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">222</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">223</span> 
<span class="line">224</span> </span><span class="NAME">ZmPrefController.prototype.resetDirty</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">225</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dirty</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">226</span> </span><span class="WHIT">	</span><span class="NAME">this._dirty</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">227</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">228</span> 
<span class="line">229</span> </span><span class="NAME">ZmPrefController.prototype.setDirty</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">230</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dirty</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">231</span> </span><span class="WHIT">	</span><span class="NAME">this._dirty</span><span class="PUNC">[</span><span class="NAME">view</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dirty</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">232</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">233</span> 
<span class="line">234</span> </span><span class="NAME">ZmPrefController.prototype.isDirty</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">235</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">236</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._dirty</span><span class="PUNC">[</span><span class="NAME">view</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">237</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">238</span> 
<span class="line">239</span> </span><span class="COMM">/**
<span class="line">240</span>  * Public method called to save prefs - does not check for dirty flag.
<span class="line">241</span>  *
<span class="line">242</span>  * @param {AjxCallback}	callback	the async callback
<span class="line">243</span>  * @param {Boolean}	noPop		if &lt;code&gt;true&lt;/code&gt;, do not pop view after save
<span class="line">244</span>  *
<span class="line">245</span>  * TODO: shouldn&#39;t have to call getChangedPrefs() twice
<span class="line">246</span>  * 
<span class="line">247</span>  * @private
<span class="line">248</span>  */</span><span class="WHIT">
<span class="line">249</span> </span><span class="NAME">ZmPrefController.prototype.save</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">250</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noPop</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">251</span> </span><span class="WHIT">	</span><span class="COMM">// perform pre-save ops, if needed</span><span class="WHIT">
<span class="line">252</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">preSaveCallbacks</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._prefsView.getPreSaveCallbacks</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">253</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">preSaveCallbacks</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">preSaveCallbacks.length</span><span class="WHIT"> </span><span class="PUNC">&gt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">254</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">continueCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">AjxCallback</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._doPreSave</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">255</span> </span><span class="WHIT">		</span><span class="NAME">continueCallback.args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">continueCallback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">preSaveCallbacks</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noPop</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">256</span> </span><span class="WHIT">		</span><span class="NAME">this._doPreSave.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">continueCallback.args</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">257</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">258</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// do basic save</span><span class="WHIT">
<span class="line">259</span> </span><span class="WHIT">		</span><span class="NAME">this._doSave</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noPop</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">260</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">261</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">262</span> 
<span class="line">263</span> </span><span class="COMM">/**
<span class="line">264</span>  * Enables/disables toolbar buttons.
<span class="line">265</span>  *
<span class="line">266</span>  * @param {ZmButtonToolBar}	parent		the toolbar
<span class="line">267</span>  * @param {constant}	view		the current view (tab)
<span class="line">268</span>  * 
<span class="line">269</span>  * @private
<span class="line">270</span>  */</span><span class="WHIT">
<span class="line">271</span> </span><span class="NAME">ZmPrefController.prototype._resetOperations</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">272</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">273</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">section</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmPref.getPrefSectionMap</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NAME">view</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">274</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">manageChanges</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">section</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">section.manageChanges</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">275</span> </span><span class="WHIT">	</span><span class="NAME">parent.enable</span><span class="PUNC">(</span><span class="NAME">ZmOperation.SAVE</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">manageChanges</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">276</span> </span><span class="WHIT">	</span><span class="NAME">parent.enable</span><span class="PUNC">(</span><span class="NAME">ZmOperation.CANCEL</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">277</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">278</span> 
<span class="line">279</span> </span><span class="COMM">/**
<span class="line">280</span>  * Creates the prefs view, with a tab for each preferences page.
<span class="line">281</span>  * 
<span class="line">282</span>  * @private
<span class="line">283</span>  */</span><span class="WHIT">
<span class="line">284</span> </span><span class="NAME">ZmPrefController.prototype._setView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class="line">285</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">286</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._prefsView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">287</span> </span><span class="WHIT">		</span><span class="NAME">this._initializeToolBar</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">288</span> </span><span class="WHIT">		</span><span class="NAME">this._initializeLeftToolBar</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">289</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">callbacks</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Object</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">290</span> </span><span class="WHIT">		</span><span class="NAME">callbacks</span><span class="PUNC">[</span><span class="NAME">ZmAppViewMgr.CB_PRE_HIDE</span><span class="PUNC">]</span><span class="WHIT">		</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._preHideCallback.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">291</span> </span><span class="WHIT">		</span><span class="NAME">callbacks</span><span class="PUNC">[</span><span class="NAME">ZmAppViewMgr.CB_PRE_UNLOAD</span><span class="PUNC">]</span><span class="WHIT">	</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._preUnloadCallback.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">292</span> </span><span class="WHIT">		</span><span class="NAME">callbacks</span><span class="PUNC">[</span><span class="NAME">ZmAppViewMgr.CB_PRE_SHOW</span><span class="PUNC">]</span><span class="WHIT">		</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._preShowCallback.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">293</span> </span><span class="WHIT">		</span><span class="NAME">callbacks</span><span class="PUNC">[</span><span class="NAME">ZmAppViewMgr.CB_POST_SHOW</span><span class="PUNC">]</span><span class="WHIT">	</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._postShowCallback.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">294</span> 
<span class="line">295</span> </span><span class="WHIT">		</span><span class="NAME">this._prefsView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ZmPrefView</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">parent</span><span class="PUNC">:</span><span class="NAME">this._container</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">posStyle</span><span class="PUNC">:</span><span class="NAME">Dwt.ABSOLUTE_STYLE</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">controller</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">296</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">elements</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">297</span> </span><span class="WHIT">		</span><span class="NAME">elements</span><span class="PUNC">[</span><span class="NAME">ZmAppViewMgr.C_NEW_BUTTON</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._lefttoolbar</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">298</span> </span><span class="WHIT">		</span><span class="NAME">elements</span><span class="PUNC">[</span><span class="NAME">ZmAppViewMgr.C_TOOLBAR_TOP</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._toolbar</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">299</span> </span><span class="WHIT">		</span><span class="NAME">elements</span><span class="PUNC">[</span><span class="NAME">ZmAppViewMgr.C_APP_CONTENT</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._prefsView</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">300</span> 
<span class="line">301</span> </span><span class="WHIT">		</span><span class="NAME">this._app.createView</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">	</span><span class="NAME">viewId</span><span class="PUNC">:</span><span class="WHIT">		</span><span class="NAME">this._currentViewId</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">302</span> </span><span class="WHIT">								</span><span class="NAME">elements</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="NAME">elements</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">303</span> </span><span class="WHIT">								</span><span class="NAME">controller</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">304</span> </span><span class="WHIT">								</span><span class="NAME">callbacks</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="NAME">callbacks</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">305</span> </span><span class="WHIT">								</span><span class="NAME">isAppView</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">306</span> </span><span class="WHIT">		</span><span class="NAME">this._initializeTabGroup</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">307</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">308</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">309</span> 
<span class="line">310</span> </span><span class="COMM">/**
<span class="line">311</span>  * Initializes the left toolbar and sets up the listeners.
<span class="line">312</span>  *
<span class="line">313</span>  * @private
<span class="line">314</span>  */</span><span class="WHIT">
<span class="line">315</span> </span><span class="NAME">ZmPrefController.prototype._initializeLeftToolBar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">316</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">317</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._lefttoolbar</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">318</span> 
<span class="line">319</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">buttons</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">ZmOperation.SAVE</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ZmOperation.CANCEL</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">320</span> </span><span class="WHIT">	</span><span class="NAME">this._lefttoolbar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ZmButtonToolBar</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">parent</span><span class="PUNC">:</span><span class="NAME">this._container</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">buttons</span><span class="PUNC">:</span><span class="NAME">buttons</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">:</span><span class="NAME">this._currentViewId</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">321</span> </span><span class="WHIT">	</span><span class="NAME">buttons</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._lefttoolbar.opList</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">322</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">buttons.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">323</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">button</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">buttons</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">324</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._listeners</span><span class="PUNC">[</span><span class="NAME">button</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">325</span> </span><span class="WHIT">			</span><span class="NAME">this._lefttoolbar.addSelectionListener</span><span class="PUNC">(</span><span class="NAME">button</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._listeners</span><span class="PUNC">[</span><span class="NAME">button</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">326</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">327</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">328</span> </span><span class="WHIT">	</span><span class="NAME">this._lefttoolbar.getButton</span><span class="PUNC">(</span><span class="NAME">ZmOperation.SAVE</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setToolTipContent</span><span class="PUNC">(</span><span class="NAME">ZmMsg.savePrefs</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">329</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">330</span> 
<span class="line">331</span> </span><span class="COMM">/**
<span class="line">332</span>  * Initializes the toolbar and sets up the listeners.
<span class="line">333</span>  * 
<span class="line">334</span>  * @private
<span class="line">335</span>  */</span><span class="WHIT">
<span class="line">336</span> </span><span class="NAME">ZmPrefController.prototype._initializeToolBar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class="line">337</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">338</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._toolbar</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">339</span> </span><span class="WHIT">	
<span class="line">340</span> 	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">buttons</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getToolBarOps</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">341</span> </span><span class="WHIT">	</span><span class="NAME">this._toolbar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ZmButtonToolBar</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">parent</span><span class="PUNC">:</span><span class="NAME">this._container</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">buttons</span><span class="PUNC">:</span><span class="NAME">buttons</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">:</span><span class="NAME">this._currentViewId</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">342</span> </span><span class="WHIT">	</span><span class="NAME">buttons</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._toolbar.opList</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">343</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">buttons.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">344</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">button</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">buttons</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">345</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._listeners</span><span class="PUNC">[</span><span class="NAME">button</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">346</span> </span><span class="WHIT">			</span><span class="NAME">this._toolbar.addSelectionListener</span><span class="PUNC">(</span><span class="NAME">button</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._listeners</span><span class="PUNC">[</span><span class="NAME">button</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">347</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">348</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">349</span> 
<span class="line">350</span> </span><span class="WHIT">	</span><span class="NAME">appCtxt.notifyZimlets</span><span class="PUNC">(</span><span class="STRN">&#34;initializeToolbar&#34;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">this._app</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._toolbar</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._currentViewId</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">waitUntilLoaded</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">351</span> 
<span class="line">352</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">353</span> 
<span class="line">354</span> </span><span class="NAME">ZmPrefController.prototype._getToolBarOps</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">355</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">356</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">ZmOperation.REVERT_PAGE</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">357</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">358</span> 
<span class="line">359</span> </span><span class="NAME">ZmPrefController.prototype._initializeTabGroup</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class="line">360</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">361</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tg</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._createTabGroup</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">362</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rootTg</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">appCtxt.getRootTabGroup</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">363</span> </span><span class="WHIT">	</span><span class="NAME">tg.newParent</span><span class="PUNC">(</span><span class="NAME">rootTg</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">364</span> </span><span class="WHIT">	</span><span class="NAME">tg.addMember</span><span class="PUNC">(</span><span class="NAME">this._lefttoolbar.getTabGroupMember</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">365</span> </span><span class="WHIT">	</span><span class="NAME">tg.addMember</span><span class="PUNC">(</span><span class="NAME">this._toolbar.getTabGroupMember</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">366</span> </span><span class="WHIT">	</span><span class="NAME">tg.addMember</span><span class="PUNC">(</span><span class="NAME">this._prefsView.getTabGroupMember</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">367</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">368</span> 
<span class="line">369</span> </span><span class="COMM">/**
<span class="line">370</span>  * Saves any options that have been changed. This method first sees if any of the
<span class="line">371</span>  * preference pages need to perform any logic prior to the actual save. See the
<span class="line">372</span>  * &lt;code&gt;ZmPrefView#getPreSaveCallbacks&lt;/code&gt; documentation for further details.
<span class="line">373</span>  *
<span class="line">374</span>  * @param ev		[DwtEvent]		click event
<span class="line">375</span>  * @param callback	[AjxCallback]	async callback
<span class="line">376</span>  * @param noPop		[boolean]		if true, don&#39;t pop view after save
<span class="line">377</span>  * 
<span class="line">378</span>  * TODO: shouldn&#39;t have to call getChangedPrefs() twice
<span class="line">379</span>  * 
<span class="line">380</span>  * @private
<span class="line">381</span>  */</span><span class="WHIT">
<span class="line">382</span> </span><span class="NAME">ZmPrefController.prototype._saveListener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class="line">383</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noPop</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">384</span> </span><span class="WHIT">	</span><span class="COMM">// is there anything to do?</span><span class="WHIT">
<span class="line">385</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dirty</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._prefsView.getChangedPrefs</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">386</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">dirty</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">387</span> </span><span class="WHIT">		</span><span class="NAME">appCtxt.getAppViewMgr</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">popView</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">388</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">389</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">390</span> 
<span class="line">391</span> </span><span class="WHIT">	</span><span class="NAME">this.save</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noPop</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">392</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">393</span> 
<span class="line">394</span> </span><span class="NAME">ZmPrefController.prototype._doPreSave</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">395</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">continueCallback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">preSaveCallbacks</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noPop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">success</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">396</span> </span><span class="WHIT">	</span><span class="COMM">// cancel save</span><span class="WHIT">
<span class="line">397</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">success</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">success</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">398</span> 
<span class="line">399</span> </span><span class="WHIT">	</span><span class="COMM">// perform save</span><span class="WHIT">
<span class="line">400</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">preSaveCallbacks.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">401</span> </span><span class="WHIT">		</span><span class="NAME">this._doSave</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noPop</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">402</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">403</span> 
<span class="line">404</span> </span><span class="WHIT">	</span><span class="COMM">// continue pre-save operations</span><span class="WHIT">
<span class="line">405</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">406</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">preSaveCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">preSaveCallbacks.shift</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">407</span> </span><span class="WHIT">		</span><span class="NAME">preSaveCallback.run</span><span class="PUNC">(</span><span class="NAME">continueCallback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">408</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">409</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">410</span> 
<span class="line">411</span> </span><span class="NAME">ZmPrefController.prototype._doSave</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">412</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noPop</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">413</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">batchCommand</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ZmBatchCommand</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">414</span> 
<span class="line">415</span> </span><span class="WHIT">	</span><span class="COMM">//  get changed prefs</span><span class="WHIT">
<span class="line">416</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">list</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">417</span> </span><span class="WHIT">	</span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">418</span> </span><span class="WHIT">		</span><span class="NAME">list</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._prefsView.getChangedPrefs</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">batchCommand</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">419</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">420</span> </span><span class="WHIT">	</span><span class="KEYW">catch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">421</span> </span><span class="WHIT">		</span><span class="COMM">// getChangedPrefs throws an AjxException if any of the values have not passed validation.</span><span class="WHIT">
<span class="line">422</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">AjxException</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">423</span> </span><span class="WHIT">			</span><span class="NAME">appCtxt.setStatusMsg</span><span class="PUNC">(</span><span class="NAME">e.msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ZmStatusView.LEVEL_CRITICAL</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">424</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">425</span> </span><span class="WHIT">			</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">426</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">427</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">428</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">429</span> 
<span class="line">430</span> </span><span class="WHIT">	</span><span class="COMM">// save generic settings</span><span class="WHIT">
<span class="line">431</span> </span><span class="WHIT">	</span><span class="NAME">appCtxt.getSettings</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">save</span><span class="PUNC">(</span><span class="NAME">list</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">batchCommand</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">432</span> </span><span class="WHIT">    </span><span class="NAME">this.resetDirty</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">433</span> 
<span class="line">434</span> </span><span class="WHIT">	</span><span class="COMM">// save any extra commands that may have been added</span><span class="WHIT">
<span class="line">435</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">batchCommand.size</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">436</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">respCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._handleResponseSaveListener.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noPop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">list</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">437</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">errorCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._handleResponseSaveError.bind</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">438</span> </span><span class="WHIT">		</span><span class="NAME">batchCommand.run</span><span class="PUNC">(</span><span class="NAME">respCallback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">errorCallback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">439</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">440</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">441</span> </span><span class="WHIT">		</span><span class="NAME">this._handleResponseSaveListener</span><span class="PUNC">(</span><span class="NAME">list.length</span><span class="WHIT"> </span><span class="PUNC">&gt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noPop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">list</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">442</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">443</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">444</span> 
<span class="line">445</span> </span><span class="NAME">ZmPrefController.prototype._handleResponseSaveError</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">446</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">exception1</span><span class="COMM">/*, ..., exceptionN*/</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">447</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">448</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">exception</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">449</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">message</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">exception</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">AjxException</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT">
<span class="line">450</span> </span><span class="WHIT">					  </span><span class="PUNC">(</span><span class="NAME">exception.msg</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">exception.code</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">String</span><span class="PUNC">(</span><span class="NAME">exception</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">451</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">exception.code</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmCsfeException.ACCT_INVALID_ATTR_VALUE</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class="line">452</span> </span><span class="WHIT">			</span><span class="NAME">exception.code</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmCsfeException.INVALID_REQUEST</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">453</span> </span><span class="WHIT">			</span><span class="COMM">// above faults come with technical/cryptic LDAP error msg; input validation</span><span class="WHIT">
<span class="line">454</span> </span><span class="WHIT">			</span><span class="COMM">// should keep us from getting here</span><span class="WHIT">
<span class="line">455</span> </span><span class="WHIT">			</span><span class="NAME">message</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmMsg.invalidPrefValue</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">456</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">457</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">exception.code</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmCsfeException.TOO_MANY_IDENTITIES</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">458</span> </span><span class="WHIT">            </span><span class="COMM">//Bug fix # 80409 - Show a custom/localized message and not the server error</span><span class="WHIT">
<span class="line">459</span> </span><span class="WHIT">            </span><span class="NAME">message</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmMsg.errorTooManyIdentities</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">460</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">461</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">exception.code</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmCsfeException.IDENTITY_EXISTS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">462</span> </span><span class="WHIT">           </span><span class="COMM">//Displaying custom message in case of identity already exists</span><span class="WHIT">
<span class="line">463</span> </span><span class="WHIT">           </span><span class="NAME">message</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AjxMessageFormat.format</span><span class="PUNC">(</span><span class="NAME">ZmMsg.errorIdentityAlreadyExists</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">message.substring</span><span class="PUNC">(</span><span class="NAME">message.length</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">message.lastIndexOf</span><span class="PUNC">(</span><span class="STRN">&#39;:&#39;</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">464</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">465</span> </span><span class="WHIT">		</span><span class="NAME">appCtxt.setStatusMsg</span><span class="PUNC">(</span><span class="NAME">message</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ZmStatusView.LEVEL_CRITICAL</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">466</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">467</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">468</span> 
<span class="line">469</span> </span><span class="NAME">ZmPrefController.prototype._handleResponseSaveListener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">470</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">optionsSaved</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noPop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">list</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">471</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">optionsSaved</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">472</span> </span><span class="WHIT">		</span><span class="NAME">appCtxt.setStatusMsg</span><span class="PUNC">(</span><span class="NAME">ZmMsg.optionsSaved</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">473</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">474</span> 
<span class="line">475</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">hasFault</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">result._data</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">result._data.BatchResponse</span><span class="WHIT">
<span class="line">476</span> </span><span class="WHIT">		</span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">result._data.BatchResponse.Fault</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">477</span> 
<span class="line">478</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">noPop</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">hasFault</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">479</span> </span><span class="WHIT">		</span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">480</span> </span><span class="WHIT">			</span><span class="COMM">// pass force flag - we just saved, so we know view isn&#39;t dirty</span><span class="WHIT">
<span class="line">481</span> </span><span class="WHIT">			</span><span class="NAME">appCtxt.getAppViewMgr</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">popView</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">482</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">483</span> </span><span class="WHIT">			</span><span class="COMM">// do nothing - sometimes popView throws an exception ala history mgr</span><span class="WHIT">
<span class="line">484</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">485</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">486</span> </span><span class="WHIT">	
<span class="line">487</span> 	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">488</span> </span><span class="WHIT">		</span><span class="NAME">callback.run</span><span class="PUNC">(</span><span class="NAME">result</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">489</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">490</span> 
<span class="line">491</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">changed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">492</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">list.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">493</span> </span><span class="WHIT">		</span><span class="NAME">changed</span><span class="PUNC">[</span><span class="NAME">list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">id</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">494</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">495</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">postSaveCallbacks</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._prefsView.getPostSaveCallbacks</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">496</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">postSaveCallbacks</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">postSaveCallbacks.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">497</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">postSaveCallbacks.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">498</span> </span><span class="WHIT">			</span><span class="NAME">postSaveCallbacks</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">run</span><span class="PUNC">(</span><span class="NAME">changed</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">499</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">500</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">501</span> </span><span class="WHIT">	</span><span class="COMM">//Once preference is saved, reload the application cache to get the latest changes</span><span class="WHIT">
<span class="line">502</span> </span><span class="WHIT">	</span><span class="NAME">appCtxt.reloadAppCache</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">503</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">504</span> 
<span class="line">505</span> </span><span class="NAME">ZmPrefController.prototype._backListener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class="line">506</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">507</span> </span><span class="WHIT">	</span><span class="NAME">appCtxt.getAppViewMgr</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">popView</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">508</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">509</span> 
<span class="line">510</span> </span><span class="NAME">ZmPrefController.prototype._resetPageListener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">511</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">512</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">viewPage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getCurrentPage</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">513</span> 
<span class="line">514</span> </span><span class="WHIT">	</span><span class="NAME">viewPage.reset</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">515</span> </span><span class="WHIT">	</span><span class="NAME">appCtxt.setStatusMsg</span><span class="PUNC">(</span><span class="NAME">ZmMsg.defaultsPageRestore</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">516</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">517</span> 
<span class="line">518</span> </span><span class="NAME">ZmPrefController.prototype._stateChangeListener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">519</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">520</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">resetbutton</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._toolbar.getButton</span><span class="PUNC">(</span><span class="NAME">ZmOperation.REVERT_PAGE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">521</span> </span><span class="WHIT">	</span><span class="NAME">resetbutton.setEnabled</span><span class="PUNC">(</span><span class="NAME">this.getCurrentPage</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">hasResetButton</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">522</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">523</span> 
<span class="line">524</span> </span><span class="NAME">ZmPrefController.prototype._preHideCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">525</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">force</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">526</span> </span><span class="WHIT">	</span><span class="NAME">ZmController.prototype._preHideCallback.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">527</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">force</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.popShield</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">528</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">529</span> 
<span class="line">530</span> </span><span class="NAME">ZmPrefController.prototype._preUnloadCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">531</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">532</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this._prefsView.isDirty</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">533</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">534</span> 
<span class="line">535</span> </span><span class="NAME">ZmPrefController.prototype._preShowCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">536</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">537</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">appCtxt.multiAccounts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">538</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">viewPage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getCurrentPage</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">539</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">viewPage</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">540</span> </span><span class="WHIT">			</span><span class="COMM">// bug: 42399 - the active account may not be &#34;owned&#34; by what is</span><span class="WHIT">
<span class="line">541</span> </span><span class="WHIT">			</span><span class="COMM">// initially shown in prefs</span><span class="WHIT">
<span class="line">542</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">active</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">appCtxt.accountList.activeAccount</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">543</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._activeAccount</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">544</span> </span><span class="WHIT">				</span><span class="NAME">this._activeAccount</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">active</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">545</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">546</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._activeAccount</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">active</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">547</span> </span><span class="WHIT">				</span><span class="NAME">appCtxt.accountList.setActiveAccount</span><span class="PUNC">(</span><span class="NAME">this._activeAccount</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">548</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">549</span> 
<span class="line">550</span> </span><span class="WHIT">			</span><span class="NAME">viewPage.showMe</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">551</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">552</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">553</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// *always* return true!</span><span class="WHIT">
<span class="line">554</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">555</span> 
<span class="line">556</span> </span><span class="NAME">ZmPrefController.prototype._postShowCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">557</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">558</span> </span><span class="WHIT">	</span><span class="NAME">ZmController.prototype._postShowCallback.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">559</span> </span><span class="WHIT">	</span><span class="COMM">// NOTE: Some pages need to know when they are being shown again in order to</span><span class="WHIT">
<span class="line">560</span> </span><span class="WHIT">	</span><span class="COMM">//       display the state correctly.</span><span class="WHIT">
<span class="line">561</span> </span><span class="WHIT">	</span><span class="NAME">this._prefsView.reset</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">562</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">563</span> 
<span class="line">564</span> </span><span class="NAME">ZmPrefController.prototype.popShield</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">565</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">566</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._prefsView.isDirty</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">567</span> 
<span class="line">568</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ps</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._popShield</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">appCtxt.getYesNoCancelMsgDialog</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">569</span> </span><span class="WHIT">	</span><span class="NAME">ps.reset</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">570</span> </span><span class="WHIT">	</span><span class="NAME">ps.setMessage</span><span class="PUNC">(</span><span class="NAME">ZmMsg.confirmExitPreferences</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">DwtMessageDialog.WARNING_STYLE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">571</span> </span><span class="WHIT">	</span><span class="NAME">ps.registerCallback</span><span class="PUNC">(</span><span class="NAME">DwtDialog.YES_BUTTON</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._popShieldYesCallback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">572</span> </span><span class="WHIT">	</span><span class="NAME">ps.registerCallback</span><span class="PUNC">(</span><span class="NAME">DwtDialog.NO_BUTTON</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._popShieldNoCallback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">573</span> </span><span class="WHIT">	</span><span class="NAME">ps.registerCallback</span><span class="PUNC">(</span><span class="NAME">DwtDialog.CANCEL_BUTTON</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._popShieldCancelCallback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">574</span> </span><span class="WHIT">	</span><span class="NAME">ps.popup</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">575</span> 
<span class="line">576</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">577</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">578</span> 
<span class="line">579</span> </span><span class="NAME">ZmPrefController.prototype._popShieldYesCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">580</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">581</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">respCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">AjxCallback</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._handleResponsePopShieldYesCallback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">582</span> </span><span class="WHIT">	</span><span class="NAME">this._saveListener</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">respCallback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">583</span> </span><span class="WHIT">	</span><span class="NAME">this._popShield.popdown</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">584</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">585</span> 
<span class="line">586</span> </span><span class="NAME">ZmPrefController.prototype._handleResponsePopShieldYesCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">587</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">588</span> </span><span class="WHIT">	</span><span class="NAME">appCtxt.getAppViewMgr</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">showPendingView</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">589</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">590</span> 
<span class="line">591</span> </span><span class="NAME">ZmPrefController.prototype._popShieldNoCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">592</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">593</span> </span><span class="WHIT">	</span><span class="NAME">this._prefsView.reset</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">594</span> </span><span class="WHIT">	</span><span class="NAME">this._popShield.popdown</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">595</span> </span><span class="WHIT">    </span><span class="NAME">this.resetDirty</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">596</span> </span><span class="WHIT">	</span><span class="NAME">appCtxt.getAppViewMgr</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">showPendingView</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">597</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">598</span> 
<span class="line">599</span> </span><span class="NAME">ZmPrefController.prototype._popShieldCancelCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">600</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">601</span> </span><span class="WHIT">	</span><span class="NAME">this._popShield.popdown</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">602</span> </span><span class="WHIT">	</span><span class="NAME">appCtxt.getAppViewMgr</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">showPendingView</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">603</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">604</span> 
<span class="line">605</span> </span><span class="NAME">ZmPrefController.prototype._getDefaultFocusItem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span class="line">606</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">607</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._prefsView.getTabGroupMember</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._lefttoolbar</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._toolbar</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">608</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">609</span> </span></pre></body></html>