<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class="line">  1</span> <span class="COMM">/*
<span class="line">  2</span>  * ***** BEGIN LICENSE BLOCK *****
<span class="line">  3</span>  * Zimbra Collaboration Suite Web Client
<span class="line">  4</span>  * Copyright (C) 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014 Zimbra, Inc.
<span class="line">  5</span>  * 
<span class="line">  6</span>  * The contents of this file are subject to the Common Public Attribution License Version 1.0 (the &#34;License&#34;);
<span class="line">  7</span>  * you may not use this file except in compliance with the License. 
<span class="line">  8</span>  * You may obtain a copy of the License at: http://www.zimbra.com/license
<span class="line">  9</span>  * The License is based on the Mozilla Public License Version 1.1 but Sections 14 and 15 
<span class="line"> 10</span>  * have been added to cover use of software over a computer network and provide for limited attribution 
<span class="line"> 11</span>  * for the Original Developer. In addition, Exhibit A has been modified to be consistent with Exhibit B. 
<span class="line"> 12</span>  * 
<span class="line"> 13</span>  * Software distributed under the License is distributed on an &#34;AS IS&#34; basis, 
<span class="line"> 14</span>  * WITHOUT WARRANTY OF ANY KIND, either express or implied. 
<span class="line"> 15</span>  * See the License for the specific language governing rights and limitations under the License. 
<span class="line"> 16</span>  * The Original Code is Zimbra Open Source Web Client. 
<span class="line"> 17</span>  * The Initial Developer of the Original Code is Zimbra, Inc. 
<span class="line"> 18</span>  * All portions of the code are Copyright (C) 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014 Zimbra, Inc. All Rights Reserved. 
<span class="line"> 19</span>  * ***** END LICENSE BLOCK *****
<span class="line"> 20</span>  */</span><span class="WHIT">
<span class="line"> 21</span> 
<span class="line"> 22</span> </span><span class="COMM">/**
<span class="line"> 23</span>  * @overview
<span class="line"> 24</span>  * 
<span class="line"> 25</span>  * This file defines a folder.
<span class="line"> 26</span>  *
<span class="line"> 27</span>  */</span><span class="WHIT">
<span class="line"> 28</span> 
<span class="line"> 29</span> </span><span class="COMM">/**
<span class="line"> 30</span>  * Creates a folder.
<span class="line"> 31</span>  * @class
<span class="line"> 32</span>  * This class represents a folder, which may contain mail. At some point, folders may be
<span class="line"> 33</span>  * able to contain contacts and/or appointments.
<span class="line"> 34</span>  *
<span class="line"> 35</span>  * @author Conrad Damon
<span class="line"> 36</span>  *
<span class="line"> 37</span>  * @param	{Hash}	params		a hash of parameters
<span class="line"> 38</span>  * @param {int}	params.id		the numeric ID
<span class="line"> 39</span>  * @param {String}	params.name		the name
<span class="line"> 40</span>  * @param {ZmOrganizer}	params.parent	the parent folder
<span class="line"> 41</span>  * @param {ZmTree}	params.tree		the tree model that contains this folder
<span class="line"> 42</span>  * @param {int}	params.numUnread	the number of unread items for this folder
<span class="line"> 43</span>  * @param {int}	params.numTotal		the number of items for this folder
<span class="line"> 44</span>  * @param {int}	params.sizeTotal	the total size of folder&#39;s items
<span class="line"> 45</span>  * @param {String}	params.url		the URL for this folder&#39;s feed
<span class="line"> 46</span>  * @param {String}	params.owner	the Owner for this organizer
<span class="line"> 47</span>  * @param {String}	params.oname	the Owner&#39;s name for this organizer, if remote folder
<span class="line"> 48</span>  * @param {String}	params.zid		the Zimbra ID of owner, if remote folder
<span class="line"> 49</span>  * @param {String}	params.rid		the Remote ID of organizer, if remote folder
<span class="line"> 50</span>  * @param {String}	params.restUrl	the REST URL of this organizer
<span class="line"> 51</span>  * 
<span class="line"> 52</span>  * @extends		ZmOrganizer
<span class="line"> 53</span>  */</span><span class="WHIT">
<span class="line"> 54</span> </span><span class="NAME">ZmFolder</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">params</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 55</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 56</span> </span><span class="WHIT">	</span><span class="NAME">params.type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">params.type</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.FOLDER</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 57</span> </span><span class="WHIT">	</span><span class="NAME">ZmOrganizer.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">params</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 58</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 59</span> 
<span class="line"> 60</span> </span><span class="NAME">ZmFolder.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 61</span> </span><span class="NAME">ZmFolder.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmFolder</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 62</span> 
<span class="line"> 63</span> </span><span class="NAME">ZmFolder.prototype.isZmFolder</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 64</span> </span><span class="NAME">ZmFolder.prototype.toString</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">&#34;ZmFolder&#34;</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 65</span> 
<span class="line"> 66</span> 
<span class="line"> 67</span> </span><span class="COMM">// needed to construct USER_ROOT if mail disabled</span><span class="WHIT">
<span class="line"> 68</span> </span><span class="NAME">ZmOrganizer.ORG_CLASS</span><span class="PUNC">[</span><span class="NAME">ZmId.ORG_FOLDER</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;ZmFolder&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 69</span> 
<span class="line"> 70</span> </span><span class="NAME">ZmFolder.SEP</span><span class="WHIT"> 									</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;/&#34;</span><span class="PUNC">;</span><span class="WHIT">							</span><span class="COMM">// path separator</span><span class="WHIT">
<span class="line"> 71</span> 
<span class="line"> 72</span> </span><span class="COMM">// system folders (see Mailbox.java in ZimbraServer for positive int consts)</span><span class="WHIT">
<span class="line"> 73</span> </span><span class="COMM">// Note: since these are defined as Numbers, and IDs come into our system as Strings,</span><span class="WHIT">
<span class="line"> 74</span> </span><span class="COMM">// we need to use == for comparisons (instead of ===, which will fail)</span><span class="WHIT">
<span class="line"> 75</span> </span><span class="NAME">ZmFolder.ID_LOAD_FOLDERS</span><span class="WHIT">						</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="WHIT">							</span><span class="COMM">// special &#34;Load remaining folders&#34; placeholder</span><span class="WHIT">
<span class="line"> 76</span> </span><span class="NAME">ZmFolder.ID_OTHER</span><span class="WHIT">								</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">							</span><span class="COMM">// used for tcon value (see below)</span><span class="WHIT">
<span class="line"> 77</span> </span><span class="NAME">ZmFolder.ID_SEP</span><span class="WHIT">									</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">							</span><span class="COMM">// separator</span><span class="WHIT">
<span class="line"> 78</span> </span><span class="NAME">ZmFolder.ID_ROOT</span><span class="WHIT">								</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_ROOT</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 79</span> </span><span class="NAME">ZmFolder.ID_INBOX</span><span class="WHIT">								</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_INBOX</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 80</span> </span><span class="NAME">ZmFolder.ID_TRASH</span><span class="WHIT">								</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_TRASH</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 81</span> </span><span class="NAME">ZmFolder.ID_SPAM</span><span class="WHIT">								</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_SPAM</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 82</span> </span><span class="NAME">ZmFolder.ID_SENT</span><span class="WHIT">								</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">5</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 83</span> </span><span class="NAME">ZmFolder.ID_DRAFTS</span><span class="WHIT">								</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">6</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 84</span> </span><span class="NAME">ZmFolder.ID_CONTACTS</span><span class="WHIT">							</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_ADDRBOOK</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 85</span> </span><span class="NAME">ZmFolder.ID_AUTO_ADDED</span><span class="WHIT">							</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_AUTO_ADDED</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 86</span> </span><span class="NAME">ZmFolder.ID_TAGS</span><span class="WHIT">	 							</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">8</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 87</span> </span><span class="NAME">ZmFolder.ID_TASKS</span><span class="WHIT">								</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_TASKS</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 88</span> </span><span class="NAME">ZmFolder.ID_SYNC_FAILURES</span><span class="WHIT">						</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_SYNC_FAILURES</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 89</span> </span><span class="NAME">ZmFolder.ID_OUTBOX</span><span class="WHIT">	 							</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_OUTBOX</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 90</span> </span><span class="NAME">ZmFolder.ID_CHATS</span><span class="WHIT">	 							</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_CHATS</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 91</span> </span><span class="NAME">ZmFolder.ID_ATTACHMENTS</span><span class="WHIT">                         </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_ATTACHMENTS</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 92</span> </span><span class="NAME">ZmFolder.ID_DLS</span><span class="WHIT">									</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_DLS</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 93</span> 
<span class="line"> 94</span> </span><span class="COMM">// system folder names</span><span class="WHIT">
<span class="line"> 95</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 96</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_INBOX</span><span class="PUNC">]</span><span class="WHIT">				</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;inbox&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 97</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_TRASH</span><span class="PUNC">]</span><span class="WHIT">				</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;trash&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 98</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SPAM</span><span class="PUNC">]</span><span class="WHIT">				</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;junk&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 99</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SENT</span><span class="PUNC">]</span><span class="WHIT">				</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;sent&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">100</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_DRAFTS</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;drafts&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">101</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_CONTACTS</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;contacts&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">102</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_AUTO_ADDED</span><span class="PUNC">]</span><span class="WHIT">		</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;emailedContacts&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">103</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_TASKS</span><span class="PUNC">]</span><span class="WHIT">				</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;tasks&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">104</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_TAGS</span><span class="PUNC">]</span><span class="WHIT">				</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;tags&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">105</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">ZmOrganizer.ID_CALENDAR</span><span class="PUNC">]</span><span class="WHIT">		</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;calendar&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">106</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">ZmOrganizer.ID_BRIEFCASE</span><span class="PUNC">]</span><span class="WHIT">		</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;briefcase&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">107</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">ZmOrganizer.ID_CHATS</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;chats&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">108</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">ZmOrganizer.ID_ALL_MAILBOXES</span><span class="PUNC">]</span><span class="WHIT">	</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;allMailboxes&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">109</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_OUTBOX</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;outbox&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">110</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SYNC_FAILURES</span><span class="PUNC">]</span><span class="WHIT">		</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;errorReports&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">111</span> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_ATTACHMENTS</span><span class="PUNC">]</span><span class="WHIT">       </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;attachments&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">112</span> 
<span class="line">113</span> </span><span class="COMM">// system folder icons</span><span class="WHIT">
<span class="line">114</span> </span><span class="NAME">ZmFolder.ICON</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">115</span> </span><span class="NAME">ZmFolder.ICON</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_INBOX</span><span class="PUNC">]</span><span class="WHIT">				</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;Inbox&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">116</span> </span><span class="NAME">ZmFolder.ICON</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_TRASH</span><span class="PUNC">]</span><span class="WHIT">				</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;Trash&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">117</span> </span><span class="NAME">ZmFolder.ICON</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SPAM</span><span class="PUNC">]</span><span class="WHIT">					</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;SpamFolder&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">118</span> </span><span class="NAME">ZmFolder.ICON</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SENT</span><span class="PUNC">]</span><span class="WHIT">					</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;SentFolder&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">119</span> </span><span class="NAME">ZmFolder.ICON</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SYNC_FAILURES</span><span class="PUNC">]</span><span class="WHIT">		</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;SendReceive&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">120</span> </span><span class="NAME">ZmFolder.ICON</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_OUTBOX</span><span class="PUNC">]</span><span class="WHIT">				</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;Outbox&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">121</span> </span><span class="NAME">ZmFolder.ICON</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_DRAFTS</span><span class="PUNC">]</span><span class="WHIT">				</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;DraftFolder&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">122</span> </span><span class="NAME">ZmFolder.ICON</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_CHATS</span><span class="PUNC">]</span><span class="WHIT">				</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;ChatFolder&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">123</span> </span><span class="NAME">ZmFolder.ICON</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_LOAD_FOLDERS</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;Plus&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">124</span> </span><span class="NAME">ZmFolder.ICON</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_ATTACHMENTS</span><span class="PUNC">]</span><span class="WHIT">          </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;Attachment&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">125</span> 
<span class="line">126</span> </span><span class="COMM">// name to use within the query language</span><span class="WHIT">
<span class="line">127</span> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">128</span> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_INBOX</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;inbox&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">129</span> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_TRASH</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;trash&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">130</span> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SPAM</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;junk&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">131</span> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SENT</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;sent&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">132</span> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_OUTBOX</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;outbox&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">133</span> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_DRAFTS</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;drafts&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">134</span> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">ZmOrganizer.ID_CALENDAR</span><span class="PUNC">]</span><span class="WHIT">	</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;calendar&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">135</span> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_CONTACTS</span><span class="PUNC">]</span><span class="WHIT">		</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;contacts&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">136</span> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_TASKS</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;tasks&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">137</span> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_AUTO_ADDED</span><span class="PUNC">]</span><span class="WHIT">		</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;Emailed Contacts&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">138</span> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">ZmOrganizer.ID_BRIEFCASE</span><span class="PUNC">]</span><span class="WHIT">	</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;briefcase&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">139</span> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_CHATS</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;chats&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">140</span> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SYNC_FAILURES</span><span class="PUNC">]</span><span class="WHIT">	</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;Error Reports&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">141</span> 
<span class="line">142</span> </span><span class="NAME">ZmFolder.QUERY_ID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AjxUtil.valueHash</span><span class="PUNC">(</span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">143</span> 
<span class="line">144</span> </span><span class="COMM">// order within the overview panel</span><span class="WHIT">
<span class="line">145</span> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">146</span> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_INBOX</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">147</span> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_CHATS</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">148</span> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SENT</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">149</span> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_DRAFTS</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">150</span> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SPAM</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">5</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">151</span> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_OUTBOX</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">6</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">152</span> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_TRASH</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">7</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">153</span> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SYNC_FAILURES</span><span class="PUNC">]</span><span class="WHIT">	</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">8</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">154</span> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SEP</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">9</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">155</span> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_ATTACHMENTS</span><span class="PUNC">]</span><span class="WHIT">    </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">99</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Last</span><span class="WHIT">
<span class="line">156</span> 
<span class="line">157</span> </span><span class="COMM">// character codes for &#34;tcon&#34; attribute in conv action request, which controls</span><span class="WHIT">
<span class="line">158</span> </span><span class="COMM">// which folders are affected</span><span class="WHIT">
<span class="line">159</span> </span><span class="NAME">ZmFolder.TCON_CODE</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">160</span> </span><span class="NAME">ZmFolder.TCON_CODE</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_TRASH</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;t&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">161</span> </span><span class="NAME">ZmFolder.TCON_CODE</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SYNC_FAILURES</span><span class="PUNC">]</span><span class="WHIT">	</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;o&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">162</span> </span><span class="NAME">ZmFolder.TCON_CODE</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SPAM</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;j&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">163</span> </span><span class="NAME">ZmFolder.TCON_CODE</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SENT</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;s&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">164</span> </span><span class="NAME">ZmFolder.TCON_CODE</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_DRAFTS</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;d&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">165</span> </span><span class="NAME">ZmFolder.TCON_CODE</span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_OTHER</span><span class="PUNC">]</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;o&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">166</span> 
<span class="line">167</span> </span><span class="COMM">// folders that look like mail folders that we don&#39;t want to show</span><span class="WHIT">
<span class="line">168</span> </span><span class="NAME">ZmFolder.HIDE_ID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">169</span> </span><span class="NAME">ZmFolder.HIDE_ID</span><span class="PUNC">[</span><span class="NAME">ZmOrganizer.ID_CHATS</span><span class="PUNC">]</span><span class="WHIT">				</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">170</span> </span><span class="NAME">ZmFolder.HIDE_ID</span><span class="PUNC">[</span><span class="NAME">ZmOrganizer.ID_NOTIFICATION_MP</span><span class="PUNC">]</span><span class="WHIT">	</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">171</span> 
<span class="line">172</span> </span><span class="COMM">// Hide folders migrated from Outlook mailbox</span><span class="WHIT">
<span class="line">173</span> </span><span class="NAME">ZmFolder.HIDE_NAME</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">174</span> </span><span class="COMM">//ZmFolder.HIDE_NAME[&#34;Journal&#34;]		= true;</span><span class="WHIT">
<span class="line">175</span> </span><span class="COMM">//ZmFolder.HIDE_NAME[&#34;Notes&#34;]		= true;</span><span class="WHIT">
<span class="line">176</span> </span><span class="COMM">//ZmFolder.HIDE_NAME[&#34;Outbox&#34;]		= true;</span><span class="WHIT">
<span class="line">177</span> </span><span class="COMM">//ZmFolder.HIDE_NAME[&#34;Tasks&#34;]		= true;</span><span class="WHIT">
<span class="line">178</span> 
<span class="line">179</span> </span><span class="COMM">// folders that contain mail from me instead of to me</span><span class="WHIT">
<span class="line">180</span> </span><span class="NAME">ZmFolder.OUTBOUND</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">ZmFolder.ID_SENT</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_OUTBOX</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_DRAFTS</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">181</span> 
<span class="line">182</span> </span><span class="COMM">// The extra-special, visible but untouchable outlook folder</span><span class="WHIT">
<span class="line">183</span> </span><span class="NAME">ZmFolder.SYNC_ISSUES</span><span class="WHIT"> 							</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;Sync Issues&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">184</span> 
<span class="line">185</span> </span><span class="COMM">// map name to ID</span><span class="WHIT">
<span class="line">186</span> </span><span class="NAME">ZmFolder.QUERY_ID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">187</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">188</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">189</span> </span><span class="WHIT">		</span><span class="NAME">ZmFolder.QUERY_ID</span><span class="PUNC">[</span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">190</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">191</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">192</span> 
<span class="line">193</span> </span><span class="COMM">/**
<span class="line">194</span>  * Comparison function for folders. Intended for use on a list of user folders
<span class="line">195</span>  * through a call to &lt;code&gt;Array.sort()&lt;/code&gt;.
<span class="line">196</span>  *
<span class="line">197</span>  * @param {ZmFolder}	folderA		a folder
<span class="line">198</span>  * @param {ZmFolder}	folderB		a folder
<span class="line">199</span>  * @param {Boolean}		nonMail		this is sorting non mail tree.
<span class="line">200</span>  * @return	{int} 0 if the folders match
<span class="line">201</span>  */</span><span class="WHIT">
<span class="line">202</span> </span><span class="NAME">ZmFolder.sortCompare</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">203</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">folderA</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">folderB</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">nonMail</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">204</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">check</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.checkSortArgs</span><span class="PUNC">(</span><span class="NAME">folderA</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">folderB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">205</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">check</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">check</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">206</span> 
<span class="line">207</span> </span><span class="WHIT">	</span><span class="COMM">// offline client wants POP folders above all else *unless* we are POP&#39;ing into Inbox</span><span class="WHIT">
<span class="line">208</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">appCtxt.isOffline</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">209</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">folderA.isDataSource</span><span class="PUNC">(</span><span class="NAME">ZmAccount.TYPE_POP</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">210</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">folderA.id</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_INBOX</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">211</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">folderB.isDataSource</span><span class="PUNC">(</span><span class="NAME">ZmAccount.TYPE_POP</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">212</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">folderA.name.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&gt;</span><span class="WHIT"> </span><span class="NAME">folderB.name.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">213</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">folderA.name.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">folderB.name.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">214</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">215</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">216</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">217</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">folderB.isDataSource</span><span class="PUNC">(</span><span class="NAME">ZmAccount.TYPE_POP</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">218</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">219</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">220</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">221</span> 
<span class="line">222</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">folderA.nId</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">folderB.nId</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">223</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">folderA.nId</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">folderB.nId</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">224</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">225</span> 
<span class="line">226</span> </span><span class="WHIT">	</span><span class="COMM">// links (shared folders or mailboxes) appear after personal folders</span><span class="WHIT">
<span class="line">227</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">folderA.link</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">folderB.link</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">228</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">folderA.link</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">229</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">230</span> 
<span class="line">231</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">nonMail</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">232</span> </span><span class="WHIT">		</span><span class="COMM">// trash folder should always go last w/in personal folders, for NON MAIL folders. (In mail it&#39;s at the end of the system folders as ordered by ZmFolder.SORT_ORDER)</span><span class="WHIT">
<span class="line">233</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">folderA.nId</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_TRASH</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">234</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">folderB.nId</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_TRASH</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">235</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">236</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">237</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">folderA.nId</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">folderB.nId</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">238</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">folderA.nId</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">folderB.nId</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">239</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">240</span> 
<span class="line">241</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">folderA.name.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&gt;</span><span class="WHIT"> </span><span class="NAME">folderB.name.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">242</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">folderA.name.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">folderB.name.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">243</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">244</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">245</span> 
<span class="line">246</span> 
<span class="line">247</span> </span><span class="NAME">ZmFolder.sortCompareNonMail</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">248</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">folderA</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">folderB</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">249</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ZmFolder.sortCompare</span><span class="PUNC">(</span><span class="NAME">folderA</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">folderB</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">250</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">251</span> 
<span class="line">252</span> </span><span class="COMM">/**
<span class="line">253</span>  * Compares the folders by path.
<span class="line">254</span>  * 
<span class="line">255</span>  * @param {ZmFolder}	folderA		a folder
<span class="line">256</span>  * @param {ZmFolder}	folderB		a folder
<span class="line">257</span>  * @return	{int} 0 if the folders match
<span class="line">258</span>  */</span><span class="WHIT">
<span class="line">259</span> </span><span class="NAME">ZmFolder.sortComparePath</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">260</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">folderA</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">folderB</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">261</span> 
<span class="line">262</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pathA</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">folderA</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">folderA.getPath</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">263</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pathB</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">folderB</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">folderB.getPath</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">264</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">check</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.checkSortArgs</span><span class="PUNC">(</span><span class="NAME">pathA</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">pathB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">265</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">check</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">check</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">266</span> 
<span class="line">267</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">folderA.nId</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">folderB.nId</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">268</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">folderA.nId</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">folderB.nId</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">269</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">270</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">folderA.nId</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">folderB.nId</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">271</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">folderA.nId</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">ZmFolder.SORT_ORDER</span><span class="PUNC">[</span><span class="NAME">folderB.nId</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">272</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pathA.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&gt;</span><span class="WHIT"> </span><span class="NAME">pathB.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">273</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pathA.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">pathB.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">274</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">275</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">276</span> 
<span class="line">277</span> </span><span class="COMM">/**
<span class="line">278</span>  * Checks a folder name for validity. Note: that a name, rather than a path, is checked.
<span class="line">279</span>  *
<span class="line">280</span>  * @param {String}	name		the folder name
<span class="line">281</span>  * @param {ZmFolder}	parent		the parent folder
<span class="line">282</span>  * @return	{String} an error message if the name is invalid; &lt;code&gt;null&lt;/code&gt;if the name is valid. 
<span class="line">283</span>  */</span><span class="WHIT">
<span class="line">284</span> </span><span class="NAME">ZmFolder.checkName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">285</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">286</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">error</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.checkName</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">287</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">error</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">error</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">288</span> 
<span class="line">289</span> </span><span class="WHIT">	</span><span class="COMM">// make sure path isn&#39;t same as a system folder</span><span class="WHIT">
<span class="line">290</span> </span><span class="WHIT">	</span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">appCtxt.getFolderTree</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">root</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">291</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parent.id</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_ROOT</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">292</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lname</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">name.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">293</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">id</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">294</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">sysname</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmMsg</span><span class="PUNC">[</span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">id</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">295</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">sysname</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lname</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">sysname.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">296</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ZmMsg.folderNameReserved</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">297</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">298</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">299</span> </span><span class="WHIT">		</span><span class="COMM">/*if (lname == ZmFolder.SYNC_ISSUES.toLowerCase()) {
<span class="line">300</span> 			return ZmMsg.folderNameReserved;
<span class="line">301</span> 		}*/</span><span class="WHIT">
<span class="line">302</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">303</span> 
<span class="line">304</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">305</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">306</span> 
<span class="line">307</span> </span><span class="COMM">/**
<span class="line">308</span>  * Gets the &#34;well-known&#34; ID for a given folder name.
<span class="line">309</span>  * 
<span class="line">310</span>  * @param	{String}	folderName	the folder name
<span class="line">311</span>  * @return	{String}	the id or &lt;code&gt;null&lt;/code&gt; if not found
<span class="line">312</span>  */</span><span class="WHIT">
<span class="line">313</span> </span><span class="NAME">ZmFolder.getIdForName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">314</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">folderName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">315</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">folderName.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">316</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">317</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ZmFolder.MSG_KEY</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">318</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">319</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">320</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">321</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">322</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">323</span> 
<span class="line">324</span> </span><span class="COMM">/**
<span class="line">325</span>  * Moves a folder. A user can move a folder to &#34;Trash&#34; even if there is already a folder in &#34;Trash&#34; with the
<span class="line">326</span>  * same name. A new name will be generated for this folder and a rename is performed before the move.
<span class="line">327</span>  * 
<span class="line">328</span>  * @param	{ZmFolder}	newParent		the new parent
<span class="line">329</span>  * @param	{boolean}	noUndo			true if the action should not be undoable
<span class="line">330</span>  * @param	{String}	actionText		optional custom action text to display as summary
<span class="line">331</span>  */</span><span class="WHIT">
<span class="line">332</span> </span><span class="NAME">ZmFolder.prototype.move</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">333</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">newParent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noUndo</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">actionText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">batchCmd</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">334</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">origName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.name</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">335</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.name</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">336</span> </span><span class="WHIT">	</span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">newParent.hasChild</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">337</span> </span><span class="WHIT">		</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">&#34;_&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">338</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">339</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">origName</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">340</span> </span><span class="WHIT">		</span><span class="NAME">this.rename</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">341</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">342</span> </span><span class="WHIT">	</span><span class="NAME">ZmOrganizer.prototype.move.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">newParent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noUndo</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">batchCmd</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">343</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">344</span> 
<span class="line">345</span> </span><span class="COMM">/**
<span class="line">346</span>  * Sends &lt;code&gt;&lt;FolderActionRequest&gt;&lt;/code&gt; to turn sync&#39;ing on/off for IMAP folders. Currently,
<span class="line">347</span>  * this is only used by Offline/ZDesktop client
<span class="line">348</span>  *
<span class="line">349</span>  * @param {Boolean}	syncIt		the flag indicating whether to sync this folder
<span class="line">350</span>  * @param {AjxCallback}	callback		the callback to call once server request is successful
<span class="line">351</span>  * @param {AjxCallback}	errorCallback	the callback to call if server returns error
<span class="line">352</span>  */</span><span class="WHIT">
<span class="line">353</span> </span><span class="NAME">ZmFolder.prototype.toggleSyncOffline</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">354</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">errorCallback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">355</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isOfflineSyncable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">356</span> 
<span class="line">357</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">op</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.isOfflineSyncing</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">&#34;!syncon&#34;</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">&#34;syncon&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">358</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">soapDoc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AjxSoapDoc.create</span><span class="PUNC">(</span><span class="STRN">&#34;FolderActionRequest&#34;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#34;urn:zimbraMail&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">359</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">actionNode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">soapDoc.set</span><span class="PUNC">(</span><span class="STRN">&#34;action&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">360</span> </span><span class="WHIT">	</span><span class="NAME">actionNode.setAttribute</span><span class="PUNC">(</span><span class="STRN">&#34;op&#34;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">op</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">361</span> </span><span class="WHIT">	</span><span class="NAME">actionNode.setAttribute</span><span class="PUNC">(</span><span class="STRN">&#34;id&#34;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">362</span> 
<span class="line">363</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">params</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">364</span> </span><span class="WHIT">		</span><span class="NAME">soapDoc</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">soapDoc</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">365</span> </span><span class="WHIT">		</span><span class="NAME">asyncMode</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">366</span> </span><span class="WHIT">		</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">367</span> </span><span class="WHIT">		</span><span class="NAME">errorCallback</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">errorCallback</span><span class="WHIT">
<span class="line">368</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">369</span> </span><span class="WHIT">	</span><span class="NAME">appCtxt.getAppController</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">sendRequest</span><span class="PUNC">(</span><span class="NAME">params</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">370</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">371</span> 
<span class="line">372</span> </span><span class="COMM">/**
<span class="line">373</span>  * Checks folders recursively for feeds.
<span class="line">374</span>  * 
<span class="line">375</span>  * @return	{Boolean}	&lt;code&gt;true&lt;/code&gt; for feeds
<span class="line">376</span>  */</span><span class="WHIT">
<span class="line">377</span> </span><span class="NAME">ZmFolder.prototype.hasFeeds</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">378</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">379</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.type</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.FOLDER</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">380</span> 
<span class="line">381</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.children.getArray</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">382</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">sz</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.children.size</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">383</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">sz</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">384</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">isFeed</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">385</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">386</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">387</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">children</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">children.size</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&gt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">388</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">hasFeeds</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">hasFeeds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">389</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">390</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">391</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">392</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">393</span> 
<span class="line">394</span> </span><span class="COMM">/**
<span class="line">395</span>  * Checks if the folder has search.
<span class="line">396</span>  * 
<span class="line">397</span>  * @param	{String}	id	not used
<span class="line">398</span>  * @return	{Boolean}	&lt;code&gt;true&lt;/code&gt; if has search
<span class="line">399</span>  */</span><span class="WHIT">
<span class="line">400</span> </span><span class="NAME">ZmFolder.prototype.hasSearch</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">401</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">402</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.SEARCH</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">403</span> 
<span class="line">404</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.children.getArray</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">405</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">sz</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.children.size</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">406</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">sz</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">407</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">hasSearch</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">408</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">409</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">410</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">411</span> 
<span class="line">412</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">413</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">414</span> 
<span class="line">415</span> </span><span class="COMM">/**
<span class="line">416</span>  * Checks if the folder supports public access. Override this method if you dont want a folder to be accessed publicly
<span class="line">417</span>  * 
<span class="line">418</span>  * @return	{Boolean}	always returns &lt;code&gt;true&lt;/code&gt;
<span class="line">419</span>  */</span><span class="WHIT">
<span class="line">420</span> </span><span class="NAME">ZmFolder.prototype.supportsPublicAccess</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">421</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">422</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">423</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">424</span> 
<span class="line">425</span> </span><span class="COMM">/**
<span class="line">426</span>  * Handles the creation of a folder or search folder. This folder is the parent
<span class="line">427</span>  * of the newly created folder. A folder may hold a folder or search folder,
<span class="line">428</span>  * and a search folder may hold another search folder.
<span class="line">429</span>  *
<span class="line">430</span>  * @param {Object}	obj				a JS folder object from the notification
<span class="line">431</span>  * @param {String}	elementType		the type of containing JSON element
<span class="line">432</span>  * @param {Boolean}	skipNotify		&lt;code&gt;true&lt;/code&gt; if notifying client should be ignored
<span class="line">433</span>  */</span><span class="WHIT">
<span class="line">434</span> </span><span class="NAME">ZmFolder.prototype.notifyCreate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">435</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">elementType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">skipNotify</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">436</span> </span><span class="WHIT">	</span><span class="COMM">// ignore creates of system folders</span><span class="WHIT">
<span class="line">437</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">nId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.normalizeId</span><span class="PUNC">(</span><span class="NAME">obj.id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">438</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isSystem</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">nId</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.FIRST_USER_ID</span><span class="PUNC">[</span><span class="NAME">this.type</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">439</span> 
<span class="line">440</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">account</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.parseId</span><span class="PUNC">(</span><span class="NAME">obj.id</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">account</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">441</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">folder</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmFolderTree.createFromJs</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.tree</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">elementType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">account</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">442</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">folder</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">443</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">index</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.getSortIndex</span><span class="PUNC">(</span><span class="NAME">folder</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eval</span><span class="PUNC">(</span><span class="NAME">ZmTreeView.COMPARE_FUNC</span><span class="PUNC">[</span><span class="NAME">this.type</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">444</span> </span><span class="WHIT">		</span><span class="NAME">this.children.add</span><span class="PUNC">(</span><span class="NAME">folder</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">445</span> 
<span class="line">446</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">skipNotify</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">447</span> </span><span class="WHIT">			</span><span class="NAME">folder._notify</span><span class="PUNC">(</span><span class="NAME">ZmEvent.E_CREATE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">448</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">449</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">450</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">451</span> 
<span class="line">452</span> </span><span class="COMM">/**
<span class="line">453</span>  * Provide some extra info in the change event about the former state
<span class="line">454</span>  * of the folder. Note that we null out the field after setting up the
<span class="line">455</span>  * change event, so the notification isn&#39;t also sent when the parent
<span class="line">456</span>  * class&#39;s method is called.
<span class="line">457</span>  *
<span class="line">458</span>  * @param {Object}	obj	a &#34;modified&#34; notification
<span class="line">459</span>  */</span><span class="WHIT">
<span class="line">460</span> </span><span class="NAME">ZmFolder.prototype.notifyModify</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">461</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">462</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">details</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">463</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">464</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">doNotify</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">465</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj.name</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this.name</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">obj.name</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">obj.id</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this.id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">466</span> </span><span class="WHIT">		</span><span class="NAME">details.oldPath</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">467</span> </span><span class="WHIT">		</span><span class="NAME">this.name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj.name</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">468</span> </span><span class="WHIT">		</span><span class="NAME">fields</span><span class="PUNC">[</span><span class="NAME">ZmOrganizer.F_NAME</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">469</span> </span><span class="WHIT">		</span><span class="NAME">this.parent.children.sort</span><span class="PUNC">(</span><span class="NAME">eval</span><span class="PUNC">(</span><span class="NAME">ZmTreeView.COMPARE_FUNC</span><span class="PUNC">[</span><span class="NAME">this.type</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">470</span> </span><span class="WHIT">		</span><span class="NAME">doNotify</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">471</span> </span><span class="WHIT">		</span><span class="NAME">obj.name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">472</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">473</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">doNotify</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">474</span> </span><span class="WHIT">		</span><span class="NAME">details.fields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fields</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">475</span> </span><span class="WHIT">		</span><span class="NAME">this._notify</span><span class="PUNC">(</span><span class="NAME">ZmEvent.E_MODIFY</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">details</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">476</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">477</span> 
<span class="line">478</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj.l</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.parent</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj.l</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">this.parent.id</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">479</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">newParent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getNewParent</span><span class="PUNC">(</span><span class="NAME">obj.l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">480</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">newParent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">481</span> </span><span class="WHIT">			</span><span class="NAME">details.oldPath</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">482</span> </span><span class="WHIT">			</span><span class="NAME">this.reparent</span><span class="PUNC">(</span><span class="NAME">newParent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">483</span> </span><span class="WHIT">			</span><span class="NAME">this._notify</span><span class="PUNC">(</span><span class="NAME">ZmEvent.E_MOVE</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">details</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">484</span> </span><span class="WHIT">			</span><span class="NAME">obj.l</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">485</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">486</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">487</span> 
<span class="line">488</span> </span><span class="WHIT">	</span><span class="NAME">ZmOrganizer.prototype.notifyModify.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">obj</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">489</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">490</span> 
<span class="line">491</span> </span><span class="COMM">/**
<span class="line">492</span>  * Creates a query.
<span class="line">493</span>  * 
<span class="line">494</span>  * @param	{Boolean}	pathOnly	&lt;code&gt;true&lt;/code&gt; if to use the path only
<span class="line">495</span>  * @return	{String}	the query
<span class="line">496</span>  */</span><span class="WHIT">
<span class="line">497</span> </span><span class="NAME">ZmFolder.prototype.createQuery</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">498</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">pathOnly</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">499</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isRemote</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this.isSystem</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">500</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">qName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">this.nId</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.getName</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.name</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">501</span> </span><span class="WHIT">		</span><span class="COMM">// put quotes around folder names that consist of multiple words or have special characters.</span><span class="WHIT">
<span class="line">502</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">quote</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/^\w+$/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">qName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">&#34;&#34;</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">&#34;\&#34;&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">503</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">pathOnly</span><span class="WHIT">
<span class="line">504</span> </span><span class="WHIT">			</span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">qName</span><span class="WHIT">
<span class="line">505</span> </span><span class="WHIT">			</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="STRN">&#34;in:&#34;</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">quote</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">qName</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">quote</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">506</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">507</span> 
<span class="line">508</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.isSystem</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">this.nId</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.name</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">509</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.parent</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">510</span> </span><span class="WHIT">	</span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f.nId</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_ROOT</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">f.name.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">511</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f.isSystem</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">ZmFolder.QUERY_NAME</span><span class="PUNC">[</span><span class="NAME">f.nId</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">f.name</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">512</span> </span><span class="WHIT">		</span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">&#34;/&#34;</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">path</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">513</span> </span><span class="WHIT">		</span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">f.parent</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">514</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">515</span> </span><span class="WHIT">	</span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#39;&#34;&#39;</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">&#39;&#34;&#39;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">516</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">pathOnly</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="STRN">&#34;in:&#34;</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">path</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">517</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">518</span> 
<span class="line">519</span> </span><span class="COMM">/**
<span class="line">520</span>  * Gets the name.
<span class="line">521</span>  * 
<span class="line">522</span>  * @param	{Boolean}	 showUnread		&lt;code&gt;true&lt;/code&gt; to show unread
<span class="line">523</span>  * @param	{int}		maxLength		the max length
<span class="line">524</span>  * @param	{Boolean}	noMarkup		&lt;code&gt;true&lt;/code&gt; to not include markup
<span class="line">525</span>  * @param	{Boolean}	useSystemName	&lt;code&gt;true&lt;/code&gt; to use the system name
<span class="line">526</span>  * 
<span class="line">527</span>  * @return	{String}	the name
<span class="line">528</span>  */</span><span class="WHIT">
<span class="line">529</span> </span><span class="NAME">ZmFolder.prototype.getName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">530</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">showUnread</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">maxLength</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">noMarkup</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">useSystemName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">531</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.nId</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_DRAFTS</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class="line">532</span> </span><span class="WHIT">		</span><span class="NAME">this.nId</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_OUTBOX</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class="line">533</span> </span><span class="WHIT">		</span><span class="NAME">this.rid</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_DRAFTS</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">534</span> </span><span class="WHIT">	</span><span class="PUNC">{</span><span class="WHIT">
<span class="line">535</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">useSystemName</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this._systemName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this._systemName</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.name</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">536</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">showUnread</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this.numTotal</span><span class="WHIT"> </span><span class="PUNC">&gt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">537</span> </span><span class="WHIT">			</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AjxMessageFormat.format</span><span class="PUNC">(</span><span class="NAME">ZmMsg.folderUnread</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.numTotal</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">538</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">noMarkup</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">539</span> </span><span class="WHIT">				</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">&#34;&lt;span style=&#39;font-weight:bold&#39;&gt;&#34;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#34;&lt;/span&gt;&#34;</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">&#34;&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">540</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">541</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">542</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">543</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">544</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">545</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.prototype.getName.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">546</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">547</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">548</span> 
<span class="line">549</span> </span><span class="COMM">/**
<span class="line">550</span>  * Gets the icon.
<span class="line">551</span>  * 
<span class="line">552</span>  * @return	{String}	the icon
<span class="line">553</span>  */</span><span class="WHIT">
<span class="line">554</span> </span><span class="NAME">ZmFolder.prototype.getIcon</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">555</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">556</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.nId</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_ROOT</span><span class="PUNC">)</span><span class="WHIT">			</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">557</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ZmFolder.ICON</span><span class="PUNC">[</span><span class="NAME">this.nId</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT">					</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ICON</span><span class="PUNC">[</span><span class="NAME">this.nId</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">558</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isFeed</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">								</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">&#34;RSS&#34;</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">559</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isRemote</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">							</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">&#34;SharedMailFolder&#34;</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">560</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isDataSource</span><span class="PUNC">(</span><span class="NAME">ZmAccount.TYPE_POP</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">		</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">&#34;POPAccount&#34;</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">561</span> 
<span class="line">562</span> </span><span class="WHIT">	</span><span class="COMM">// make a &#34;best-effort&#34; to map imap folders to a well-known icon</span><span class="WHIT">
<span class="line">563</span> </span><span class="WHIT">	</span><span class="COMM">// (parent will be the root imap folder)</span><span class="WHIT">
<span class="line">564</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mappedId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getSystemEquivalentFolderId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">565</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mappedId</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">566</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ICON</span><span class="PUNC">[</span><span class="NAME">mappedId</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">&#34;Folder&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">567</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">568</span> 
<span class="line">569</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">&#34;Folder&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">570</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">571</span> 
<span class="line">572</span> </span><span class="NAME">ZmFolder.prototype.getSystemEquivalentFolderId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">573</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">574</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.parent</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this.parent.isDataSource</span><span class="PUNC">(</span><span class="NAME">ZmAccount.TYPE_IMAP</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">575</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ZmFolder.getIdForName</span><span class="PUNC">(</span><span class="NAME">this.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">576</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">577</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">578</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">579</span> 
<span class="line">580</span> </span><span class="NAME">ZmFolder.prototype.isSystemEquivalent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">581</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">582</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getSystemEquivalentFolderId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">583</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">584</span> 
<span class="line">585</span> </span><span class="NAME">ZmFolder.prototype.mayContainFolderFromAccount</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">586</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">otherAccount</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">587</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">thisAccount</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getAccount</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">588</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">thisAccount</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">otherAccount</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">589</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">590</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">591</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">thisAccount.isLocal</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// can only move to local</span><span class="WHIT">
<span class="line">592</span> 
<span class="line">593</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">594</span> 
<span class="line">595</span> </span><span class="COMM">/**
<span class="line">596</span>  * Returns true if the given object(s) may be placed in this folder.
<span class="line">597</span>  *
<span class="line">598</span>  * If the object is a folder, check that:
<span class="line">599</span>  * &lt;ul&gt;
<span class="line">600</span>  * &lt;li&gt;We are not the immediate parent of the folder&lt;/li&gt;
<span class="line">601</span>  * &lt;li&gt;We are not a child of the folder&lt;/li&gt;
<span class="line">602</span>  * &lt;li&gt;We are not Spam or Drafts&lt;/li&gt;
<span class="line">603</span>  * &lt;li&gt;We don&#39;t already have a child with the folder&#39;s name (unless we are in Trash)&lt;/li&gt;
<span class="line">604</span>  * &lt;li&gt;We are not moving it into a folder of a different type&lt;/li&gt;
<span class="line">605</span>  * &lt;li&gt;We are not moving a folder into itself&lt;/li&gt;
<span class="line">606</span>  * &lt;/ul&gt;
<span class="line">607</span>  *
<span class="line">608</span>  * If the object is an item or a list or items, check that:
<span class="line">609</span>  * &lt;ul&gt;
<span class="line">610</span>  * &lt;li&gt;We are not the Folders container&lt;/li&gt;
<span class="line">611</span>  * &lt;li&gt;We are not a search folder&lt;/li&gt;
<span class="line">612</span>  * &lt;li&gt;The items aren&#39;t already in this folder&lt;/li&gt;
<span class="line">613</span>  * &lt;li&gt;A contact can only be moved to Trash&lt;/li&gt;
<span class="line">614</span>  * &lt;li&gt; A draft can be moved to Trash or Drafts&lt;/li&gt;
<span class="line">615</span>  * &lt;li&gt;Non-drafts cannot be moved to Drafts&lt;/li&gt;
<span class="line">616</span>  * &lt;/ul&gt;
<span class="line">617</span>  *
<span class="line">618</span>  * @param {Object}	what		the object(s) to possibly move into this folder (item or organizer)
<span class="line">619</span>  * @param {constant}	folderType	the contextual folder type (for tree view root items)
<span class="line">620</span>  * @param {boolean}	ignoreExisting  Set to true if checks for item presence in the folder should be skipped (e.g. when recovering deleted items)
<span class="line">621</span>  */</span><span class="WHIT">
<span class="line">622</span> </span><span class="NAME">ZmFolder.prototype.mayContain</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">623</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">what</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">folderType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ignoreExisting</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">624</span> 
<span class="line">625</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">what</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">626</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">627</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">628</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isFeed</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="COMM">/*|| this.isSyncIssuesFolder()*/</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">629</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">630</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">631</span> </span><span class="WHIT">	</span><span class="COMM">// placeholder for showing a large number of folders</span><span class="WHIT">
<span class="line">632</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.id</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_LOAD_FOLDERS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">633</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">634</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">635</span> 
<span class="line">636</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">thisType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">folderType</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.type</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">637</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">638</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">what</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">ZmFolder</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">639</span> </span><span class="WHIT">        </span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">what.parent</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">ignoreExisting</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.isChildOf</span><span class="PUNC">(</span><span class="NAME">what</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.nId</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_DRAFTS</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.nId</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_SPAM</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class="line">640</span> </span><span class="WHIT">				   </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isInTrash</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this.hasChild</span><span class="PUNC">(</span><span class="NAME">what.name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">ignoreExisting</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class="line">641</span> </span><span class="WHIT">	               </span><span class="PUNC">(</span><span class="NAME">what.type</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">thisType</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this.nId</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_TRASH</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class="line">642</span> </span><span class="WHIT">				   </span><span class="PUNC">(</span><span class="NAME">what.id</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">this.id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class="line">643</span> </span><span class="WHIT">				   </span><span class="PUNC">(</span><span class="NAME">this.disallowSubFolder</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class="line">644</span> </span><span class="WHIT">				   </span><span class="PUNC">(</span><span class="NAME">appCtxt.multiAccounts</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.mayContainFolderFromAccount</span><span class="PUNC">(</span><span class="NAME">what.getAccount</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="COMM">// cannot move folders across accounts, unless the target is local</span><span class="WHIT">
<span class="line">645</span> </span><span class="WHIT">                   </span><span class="PUNC">(</span><span class="NAME">this.isRemote</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this._remoteMoveOk</span><span class="PUNC">(</span><span class="NAME">what</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class="line">646</span> </span><span class="WHIT">				   </span><span class="PUNC">(</span><span class="NAME">what.isRemote</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this._remoteMoveOk</span><span class="PUNC">(</span><span class="NAME">what</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">				</span><span class="COMM">// a remote folder can be DnD but not its children</span><span class="WHIT">
<span class="line">647</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">648</span> </span><span class="WHIT">		</span><span class="COMM">// An item or an array of items is being moved</span><span class="WHIT">
<span class="line">649</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">items</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AjxUtil.toArray</span><span class="PUNC">(</span><span class="NAME">what</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">650</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">items</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">651</span> 
<span class="line">652</span> </span><span class="WHIT">        </span><span class="COMM">// container can only have folders/searches or calendars</span><span class="WHIT">
<span class="line">653</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this.nId</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_ROOT</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">what.type</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.CALENDAR</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class="line">654</span> </span><span class="WHIT">             </span><span class="COMM">// nothing can be moved to outbox/sync failures folders</span><span class="WHIT">
<span class="line">655</span> </span><span class="WHIT">			 </span><span class="NAME">this.nId</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_OUTBOX</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class="line">656</span> </span><span class="WHIT">			 </span><span class="NAME">this.nId</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_SYNC_FAILURES</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">657</span> </span><span class="WHIT">		</span><span class="PUNC">{</span><span class="WHIT">
<span class="line">658</span> </span><span class="WHIT">			</span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">659</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">thisType</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.SEARCH</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">660</span> </span><span class="WHIT">			</span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">														</span><span class="COMM">// can&#39;t drop items into saved searches</span><span class="WHIT">
<span class="line">661</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item.type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">ZmItem.CONTACT</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">item.isGal</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">662</span> </span><span class="WHIT">			</span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">663</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item.type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">ZmItem.CONV</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">item.list</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">item.list.search</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item.list.search.folderId</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">this.id</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">664</span> </span><span class="WHIT">			</span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">														</span><span class="COMM">// convs which are a result of a search for this folder</span><span class="WHIT">
<span class="line">665</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">																</span><span class="COMM">// checks that need to be done for each item</span><span class="WHIT">
<span class="line">666</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">items.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">667</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">childItem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">items</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">668</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">childItem</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">669</span> </span><span class="WHIT">					</span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">670</span> </span><span class="WHIT">					</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">671</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">672</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Dwt.instanceOf</span><span class="PUNC">(</span><span class="NAME">childItem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#34;ZmBriefcaseFolderItem&#34;</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">673</span> </span><span class="WHIT">                     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">childItem.folder</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">childItem.folder.isRemote</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">childItem.folder.rid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">674</span> </span><span class="WHIT">                        </span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">675</span> </span><span class="WHIT">                        </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">676</span> </span><span class="WHIT">                     </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">677</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item.type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">ZmItem.MSG</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">childItem.isDraft</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.nId</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_TRASH</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this.nId</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_DRAFTS</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this.rid</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_DRAFTS</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">678</span> </span><span class="WHIT">					</span><span class="COMM">// can move drafts only into Trash or Drafts</span><span class="WHIT">
<span class="line">679</span> </span><span class="WHIT">					</span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">680</span> </span><span class="WHIT">					</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">681</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this.nId</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_DRAFTS</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.rid</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmFolder.ID_DRAFTS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">childItem.isDraft</span><span class="PUNC">)</span><span class="WHIT">	</span><span class="PUNC">{</span><span class="WHIT">
<span class="line">682</span> </span><span class="WHIT">					</span><span class="COMM">// only drafts can be moved into Drafts</span><span class="WHIT">
<span class="line">683</span> </span><span class="WHIT">					</span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">684</span> </span><span class="WHIT">					</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">685</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">686</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">687</span> </span><span class="WHIT">			</span><span class="COMM">// items in the &#34;Sync Failures&#34; folder cannot be dragged out</span><span class="WHIT">
<span class="line">688</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">appCtxt.isOffline</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">invalid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">689</span> </span><span class="WHIT">				</span><span class="COMM">// bug: 41531 - don&#39;t allow items to be moved into exchange</span><span class="WHIT">
<span class="line">690</span> </span><span class="WHIT">				</span><span class="COMM">// account when moving across accounts</span><span class="WHIT">
<span class="line">691</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">acct</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getAccount</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">692</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">acct</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">item.getAccount</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">acct</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT">
<span class="line">693</span> </span><span class="WHIT">					</span><span class="PUNC">(</span><span class="NAME">acct.type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">ZmAccount.TYPE_MSE</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class="line">694</span> </span><span class="WHIT">					 </span><span class="NAME">acct.type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">ZmAccount.TYPE_EXCHANGE</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">695</span> </span><span class="WHIT">				</span><span class="PUNC">{</span><span class="WHIT">
<span class="line">696</span> </span><span class="WHIT">					</span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">697</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">698</span> </span><span class="WHIT">				</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">699</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">appCtxt.getCurrentSearch</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">700</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">folder</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">cs</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">appCtxt.getById</span><span class="PUNC">(</span><span class="NAME">cs.folderId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">701</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">folder</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">folder.nId</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">ZmOrganizer.ID_SYNC_FAILURES</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">702</span> </span><span class="WHIT">						</span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">703</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">704</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">705</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">706</span> 
<span class="line">707</span> </span><span class="WHIT">			</span><span class="COMM">// bug #42890 - disable moving to shared folders across accounts</span><span class="WHIT">
<span class="line">708</span> </span><span class="WHIT">			</span><span class="COMM">// until server bug is fixed</span><span class="WHIT">
<span class="line">709</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">appCtxt.multiAccounts</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this.isRemote</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT">
<span class="line">710</span> </span><span class="WHIT">				</span><span class="NAME">what.getAccount</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this.getAccount</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">what.getAccount</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">id</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">711</span> </span><span class="WHIT">			</span><span class="PUNC">{</span><span class="WHIT">
<span class="line">712</span> </span><span class="WHIT">				</span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">713</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">714</span> 
<span class="line">715</span> </span><span class="WHIT">			</span><span class="COMM">// can&#39;t move items to folder they&#39;re already in; we&#39;re okay if we</span><span class="WHIT">
<span class="line">716</span> </span><span class="WHIT">			</span><span class="COMM">// have one item from another folder</span><span class="WHIT">
<span class="line">717</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">ignoreExisting</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">718</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">item.folderId</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">719</span> </span><span class="WHIT">					</span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">720</span> </span><span class="WHIT">					</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">items.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">721</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">items</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">folderId</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">this.id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">722</span> </span><span class="WHIT">							</span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">723</span> </span><span class="WHIT">							</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">724</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">725</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">726</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">727</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">728</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">729</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this.link</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">730</span> </span><span class="WHIT">			</span><span class="NAME">invalid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.isReadOnly</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">										</span><span class="COMM">// cannot drop anything onto a read-only item</span><span class="WHIT">
<span class="line">731</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">732</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">733</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">invalid</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">734</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">735</span> 
<span class="line">736</span> </span><span class="COMM">/**
<span class="line">737</span>  * Checks if this is the sync issues folder.
<span class="line">738</span>  * 
<span class="line">739</span>  * @return	{Boolean}	&lt;code&gt;true&lt;/code&gt; if the folder is the one dealing with Outlook sync issues
<span class="line">740</span>  */</span><span class="WHIT">
<span class="line">741</span> 
<span class="line">742</span> </span><span class="COMM">//Bug#68799 Removing special handling of the folder named &#34;Sync Issues&#34;</span><span class="WHIT">
<span class="line">743</span> 
<span class="line">744</span> </span><span class="COMM">/*ZmFolder.prototype.isSyncIssuesFolder =
<span class="line">745</span> function() {
<span class="line">746</span> 	return (this.name == ZmFolder.SYNC_ISSUES);
<span class="line">747</span> };*/</span><span class="WHIT">
<span class="line">748</span> 
<span class="line">749</span> </span><span class="COMM">/**
<span class="line">750</span>  * Checks if this folder required hard delete.
<span class="line">751</span>  * 
<span class="line">752</span>  * @return	{Boolean}	&lt;code&gt;true&lt;/code&gt; if deleting items w/in this folder should be hard deleted.
<span class="line">753</span>  */</span><span class="WHIT">
<span class="line">754</span> </span><span class="NAME">ZmFolder.prototype.isHardDelete</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">755</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">756</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isInTrash</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.isInSpam</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">appCtxt.isOffline</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this.isUnder</span><span class="PUNC">(</span><span class="NAME">ZmOrganizer.ID_SYNC_FAILURES</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">757</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">758</span> 
<span class="line">759</span> </span><span class="COMM">/**
<span class="line">760</span>  * Checks if this folder is in spam folder.
<span class="line">761</span>  * 
<span class="line">762</span>  * @return	{Boolean}	&lt;code&gt;true&lt;/code&gt; if in spam
<span class="line">763</span>  */</span><span class="WHIT">
<span class="line">764</span> </span><span class="NAME">ZmFolder.prototype.isInSpam</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">765</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class="line">766</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.isUnder</span><span class="PUNC">(</span><span class="NAME">ZmFolder.ID_SPAM</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">767</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">768</span> 
<span class="line">769</span> </span><span class="COMM">/**
<span class="line">770</span>  *
<span class="line">771</span>  * @param {ZmFolder}	folder  the source folder
<span class="line">772</span>  * 
<span class="line">773</span>  * @return {Boolean}	&lt;code&gt;true/code&gt; if the given remote folder can be moved into this remote folder.
<span class="line">774</span>  * The source and the target folder must belong to the same account. The source
<span class="line">775</span>  * must have delete permission and the target must have insert permission.
<span class="line">776</span>  * 
<span class="line">777</span>  * @private
<span class="line">778</span>  */</span><span class="WHIT">
<span class="line">779</span> </span><span class="NAME">ZmFolder.prototype._remoteMoveOk</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">780</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">folder</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">781</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isRemote</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">folder.isMountpoint</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">folder.rid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">782</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.link</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">folder.link</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.getOwner</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">folder.getOwner</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">783</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._folderActionOk</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#34;isInsert&#34;</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">784</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">785</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">786</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._folderActionOk</span><span class="PUNC">(</span><span class="NAME">folder</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#34;isDelete&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">787</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">788</span> 
<span class="line">789</span> </span><span class="NAME">ZmFolder.prototype._folderActionOk</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">790</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">folder</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">func</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">791</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">share</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">folder.shares</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">folder.shares</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">792</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">share</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">793</span> </span><span class="WHIT">		</span><span class="COMM">//if shares is not set, default to readOnly.</span><span class="WHIT">
<span class="line">794</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">folder.isReadOnly</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">795</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">796</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">share</span><span class="PUNC">[</span><span class="NAME">func</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">797</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">798</span> </span><span class="COMM">/**
<span class="line">799</span>  * Returns true if this folder is for outbound mail.
<span class="line">800</span>  */</span><span class="WHIT">
<span class="line">801</span> </span><span class="NAME">ZmFolder.prototype.isOutbound</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class="line">802</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">803</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">ZmFolder.OUTBOUND.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">804</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isUnder</span><span class="PUNC">(</span><span class="NAME">ZmFolder.OUTBOUND</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">805</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">806</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">807</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">808</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">809</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">810</span> 
<span class="line">811</span> 
<span class="line">812</span> </span><span class="COMM">/**
<span class="line">813</span>  * Sets the Global Mark Read flag.  When the user sets this flag, read flags are global for all
<span class="line">814</span>  * shared instances of the folder. When not set, each user accessing the shared folder will maintain
<span class="line">815</span>  * their own read/unread flag.
<span class="line">816</span>  *
<span class="line">817</span>  * @param	{Object}	        globalMarkRead		the globalMarkRead boolean flag
<span class="line">818</span>  * @param	{AjxCallback}	    callback		    the callback
<span class="line">819</span>  * @param	{AjxCallback}	    errorCallback		the error callback
<span class="line">820</span>  * @param   {ZmBatchCommand}    batchCmd            optional batch command
<span class="line">821</span>  */</span><span class="WHIT">
<span class="line">822</span> </span><span class="NAME">ZmOrganizer.prototype.setGlobalMarkRead</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">globalMarkRead</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">errorCallback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">batchCmd</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">823</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.globalMarkRead</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">globalMarkRead</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line">824</span> </span><span class="WHIT">    </span><span class="COMM">// TODO: Bug 59559, awaiting server side implementation (Bug 24567)</span><span class="WHIT">
<span class="line">825</span> </span><span class="WHIT">    </span><span class="COMM">// TODO: - For ZmFolderPropsDialog and ZmSharePropsDialog:</span><span class="WHIT">
<span class="line">826</span> </span><span class="WHIT">    </span><span class="COMM">// TODO:     Make sure that the attrName is indeed globalMarkRead - used in the dialogs</span><span class="WHIT">
<span class="line">827</span> </span><span class="WHIT">    </span><span class="COMM">// TODO:     Make the globalMarkRead labels and controls visible.</span><span class="WHIT">
<span class="line">828</span> </span><span class="WHIT">    </span><span class="COMM">// TODO: - Uncomment this once the server call is ready, make sure action/attrs are correct</span><span class="WHIT">
<span class="line">829</span> </span><span class="WHIT">	</span><span class="COMM">//this._organizerAction({action: &#34;globalMarkRead&#34;, attrs: {globalMarkRead: globalMarkRead}, callback: callback,</span><span class="WHIT">
<span class="line">830</span> </span><span class="WHIT">    </span><span class="COMM">//                       errorCallback: errorCallback, batchCmd: batchCmd});</span><span class="WHIT">
<span class="line">831</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">832</span> </span></pre></body></html>