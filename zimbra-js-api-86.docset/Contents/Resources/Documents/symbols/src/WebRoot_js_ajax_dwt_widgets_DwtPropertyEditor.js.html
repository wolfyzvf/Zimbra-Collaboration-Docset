<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class="line">  1</span> <span class="COMM">/*
<span class="line">  2</span>  * ***** BEGIN LICENSE BLOCK *****
<span class="line">  3</span>  * Zimbra Collaboration Suite Web Client
<span class="line">  4</span>  * Copyright (C) 2005, 2006, 2007, 2008, 2009, 2010, 2013, 2014 Zimbra, Inc.
<span class="line">  5</span>  * 
<span class="line">  6</span>  * The contents of this file are subject to the Common Public Attribution License Version 1.0 (the &#34;License&#34;);
<span class="line">  7</span>  * you may not use this file except in compliance with the License. 
<span class="line">  8</span>  * You may obtain a copy of the License at: http://www.zimbra.com/license
<span class="line">  9</span>  * The License is based on the Mozilla Public License Version 1.1 but Sections 14 and 15 
<span class="line"> 10</span>  * have been added to cover use of software over a computer network and provide for limited attribution 
<span class="line"> 11</span>  * for the Original Developer. In addition, Exhibit A has been modified to be consistent with Exhibit B. 
<span class="line"> 12</span>  * 
<span class="line"> 13</span>  * Software distributed under the License is distributed on an &#34;AS IS&#34; basis, 
<span class="line"> 14</span>  * WITHOUT WARRANTY OF ANY KIND, either express or implied. 
<span class="line"> 15</span>  * See the License for the specific language governing rights and limitations under the License. 
<span class="line"> 16</span>  * The Original Code is Zimbra Open Source Web Client. 
<span class="line"> 17</span>  * The Initial Developer of the Original Code is Zimbra, Inc. 
<span class="line"> 18</span>  * All portions of the code are Copyright (C) 2005, 2006, 2007, 2008, 2009, 2010, 2013, 2014 Zimbra, Inc. All Rights Reserved. 
<span class="line"> 19</span>  * ***** END LICENSE BLOCK *****
<span class="line"> 20</span>  */</span><span class="WHIT">
<span class="line"> 21</span> 
<span class="line"> 22</span> 
<span class="line"> 23</span> </span><span class="COMM">/**
<span class="line"> 24</span>  * Generic Property Editor Widget.
<span class="line"> 25</span>  *
<span class="line"> 26</span>  * @author Mihai Bazon
<span class="line"> 27</span>  *
<span class="line"> 28</span>  * See initProperties() below
<span class="line"> 29</span>  * 
<span class="line"> 30</span>  * @extends		DwtComposite
<span class="line"> 31</span>  * @private
<span class="line"> 32</span>  */</span><span class="WHIT">
<span class="line"> 33</span> </span><span class="NAME">DwtPropertyEditor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">useDwtInputField</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">className</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">posStyle</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 34</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments.length</span><span class="WHIT"> </span><span class="PUNC">&gt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 35</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">className</span><span class="PUNC">)</span><span class="WHIT">
<span class="line"> 36</span> </span><span class="WHIT">			</span><span class="NAME">className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;DwtPropertyEditor&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 37</span> </span><span class="WHIT">		</span><span class="NAME">DwtComposite.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">parent</span><span class="PUNC">:</span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">className</span><span class="PUNC">:</span><span class="NAME">className</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">posStyle</span><span class="PUNC">:</span><span class="NAME">posStyle</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="PUNC">:</span><span class="NAME">deferred</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 38</span> </span><span class="WHIT">		</span><span class="NAME">this._useDwtInputField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">useDwtInputField</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">useDwtInputField</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 39</span> </span><span class="WHIT">		</span><span class="NAME">this._schema</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 40</span> </span><span class="WHIT">		</span><span class="NAME">this._init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 41</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 42</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 43</span> 
<span class="line"> 44</span> </span><span class="NAME">DwtPropertyEditor.MSG_TIMEOUT</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">4000</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// 4 seconds should be plenty</span><span class="WHIT">
<span class="line"> 45</span> 
<span class="line"> 46</span> </span><span class="NAME">DwtPropertyEditor.MSG</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 47</span> </span><span class="WHIT">	</span><span class="COMM">// Now these 2 are kind of pointless...</span><span class="WHIT">
<span class="line"> 48</span> </span><span class="WHIT">	</span><span class="COMM">// We should allow a message in the prop. object.</span><span class="WHIT">
<span class="line"> 49</span> </span><span class="WHIT">	</span><span class="NAME">mustMatch</span><span class="WHIT">     </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">&#34;This field does not match validators: REGEXP&#34;</span><span class="PUNC">,</span><span class="WHIT">
<span class="line"> 50</span> </span><span class="WHIT">	</span><span class="NAME">mustNotMatch</span><span class="WHIT">  </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">&#34;This field matches anti-validators: REGEXP&#34;</span><span class="WHIT"> </span><span class="COMM">// LOL</span><span class="WHIT">
<span class="line"> 51</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 52</span> 
<span class="line"> 53</span> </span><span class="NAME">DwtPropertyEditor.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">DwtComposite</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 54</span> </span><span class="NAME">DwtPropertyEditor.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">DwtPropertyEditor</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 55</span> 
<span class="line"> 56</span> </span><span class="NAME">DwtPropertyEditor.prototype.toString</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">&#34;DwtPropertyEditor&#34;</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 57</span> 
<span class="line"> 58</span> </span><span class="NAME">DwtPropertyEditor.prototype._init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 59</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">div</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;div&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 60</span> </span><span class="WHIT">	</span><span class="NAME">div.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._relDivId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Dwt.getNextId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 61</span> </span><span class="WHIT">	</span><span class="NAME">div.style.position</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;relative&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 62</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">table</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;table&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 63</span> </span><span class="WHIT">	</span><span class="NAME">table.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._tableId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Dwt.getNextId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 64</span> </span><span class="WHIT">	</span><span class="NAME">table.cellSpacing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">table.cellPadding</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 65</span> </span><span class="WHIT">	</span><span class="NAME">table.appendChild</span><span class="PUNC">(</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;tbody&#34;</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 66</span> </span><span class="WHIT">	</span><span class="NAME">div.appendChild</span><span class="PUNC">(</span><span class="NAME">table</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 67</span> </span><span class="WHIT">	</span><span class="NAME">this.getHtmlElement</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendChild</span><span class="PUNC">(</span><span class="NAME">div</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 68</span> </span><span class="WHIT">	</span><span class="NAME">this.maxLabelWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 69</span> </span><span class="WHIT">	</span><span class="NAME">this.maxFieldWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 70</span> </span><span class="WHIT">	</span><span class="NAME">this._setMouseEventHdlrs</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 71</span> </span><span class="WHIT">	</span><span class="NAME">this._onMouseDown</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">AjxListener</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._onMouseDown</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 72</span> </span><span class="WHIT">	</span><span class="NAME">this.addListener</span><span class="PUNC">(</span><span class="NAME">DwtEvent.ONMOUSEDOWN</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._onMouseDown</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 73</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 74</span> 
<span class="line"> 75</span> </span><span class="NAME">DwtPropertyEditor.prototype.getRelDiv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 76</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">this._relDivId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 77</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 78</span> 
<span class="line"> 79</span> </span><span class="NAME">DwtPropertyEditor.prototype.getTable</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 80</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">this._tableId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 81</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 82</span> 
<span class="line"> 83</span> </span><span class="NAME">DwtPropertyEditor.prototype._onMouseDown</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 84</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">event.target</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 85</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">target.tagName.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 86</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">&#34;input&#34;</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 87</span> </span><span class="WHIT">		</span><span class="NAME">event._stopPropagation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 88</span> </span><span class="WHIT">		</span><span class="NAME">event._returnValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 89</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 90</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 91</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._currentInputField</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this._currentInputField.onblur</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 92</span> </span><span class="WHIT">		</span><span class="NAME">event._stopPropagation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 93</span> </span><span class="WHIT">		</span><span class="NAME">event._returnValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 94</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 95</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line"> 96</span> </span><span class="WHIT">	</span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 97</span> </span><span class="WHIT">		</span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">&#34;tr&#34;</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line"> 98</span> </span><span class="WHIT">			</span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">target.parentNode</span><span class="PUNC">;</span><span class="WHIT">
<span class="line"> 99</span> </span><span class="WHIT">			</span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">target.tagName.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">100</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">101</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">target.__msh_doMouseDown</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">102</span> </span><span class="WHIT">			</span><span class="NAME">target.__msh_doMouseDown</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">103</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">104</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">105</span> 
<span class="line">106</span> </span><span class="COMM">/**
<span class="line">107</span>  * Call this function to retrieve an object that contains all properties,
<span class="line">108</span>  * indexed by name.  Any &#34;struct&#34; property will map to an object that contains
<span class="line">109</span>  * its child properties.
<span class="line">110</span>  *
<span class="line">111</span>  * For the sample schema below (see comments on initProperties()), we would
<span class="line">112</span>  * retrieve an object like this (dots represent the edited value, or the
<span class="line">113</span>  * initial value if the property wasn&#39;t modified):
<span class="line">114</span>  *
<span class="line">115</span>  *  {
<span class="line">116</span>  *    userName : ... ,
<span class="line">117</span>  *    address  : {
<span class="line">118</span>  *                  street   : ... ,
<span class="line">119</span>  *                  country  : ... ,
<span class="line">120</span>  *               },
<span class="line">121</span>  *    age      : ... ,
<span class="line">122</span>  *    birthday : ...
<span class="line">123</span>  *  }
<span class="line">124</span>  */</span><span class="WHIT">
<span class="line">125</span> </span><span class="NAME">DwtPropertyEditor.prototype.getProperties</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">126</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._currentInputField</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">127</span> </span><span class="WHIT">		</span><span class="COMM">// make sure we get the value</span><span class="WHIT">
<span class="line">128</span> </span><span class="WHIT">		</span><span class="NAME">this._currentInputField.onblur</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">129</span> </span><span class="WHIT">	</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">rec</span><span class="PUNC">(</span><span class="NAME">schema</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">130</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">prop</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tmp</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">n</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">schema.length</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">131</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">++</span><span class="NAME">i</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">132</span> </span><span class="WHIT">			</span><span class="NAME">tmp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">schema</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">133</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tmp.type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">&#34;struct&#34;</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">134</span> </span><span class="WHIT">				</span><span class="NAME">prop</span><span class="PUNC">[</span><span class="NAME">tmp.name</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rec</span><span class="PUNC">(</span><span class="NAME">tmp.children</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">135</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT">
<span class="line">136</span> </span><span class="WHIT">				</span><span class="NAME">prop</span><span class="PUNC">[</span><span class="NAME">tmp.name</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tmp.value</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">137</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">138</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">prop</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">139</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">140</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">rec</span><span class="PUNC">(</span><span class="NAME">this._schema</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">141</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">142</span> 
<span class="line">143</span> </span><span class="NAME">DwtPropertyEditor.prototype.validateData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">144</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">valid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">145</span> </span><span class="WHIT">	</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">rec</span><span class="PUNC">(</span><span class="NAME">schema</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">146</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tmp</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">n</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">schema.length</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">147</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">++</span><span class="NAME">i</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">148</span> </span><span class="WHIT">			</span><span class="NAME">tmp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">schema</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">149</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tmp.type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">&#34;struct&#34;</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">150</span> </span><span class="WHIT">				</span><span class="NAME">rec</span><span class="PUNC">(</span><span class="NAME">tmp.children</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">151</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tmp._validate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">152</span> </span><span class="WHIT">				</span><span class="NAME">valid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">153</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">154</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">155</span> </span><span class="WHIT">	</span><span class="NAME">rec</span><span class="PUNC">(</span><span class="NAME">this._schema</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">156</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">valid</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">157</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">158</span> 
<span class="line">159</span> </span><span class="COMM">/** This function will initialize the Property Editor with a given schema and
<span class="line">160</span>  * property set.
<span class="line">161</span>  *
<span class="line">162</span>  *  @param schema - declares which properties/types are allowed; see below
<span class="line">163</span>  *  @param parent - parent schema, for subproperties
<span class="line">164</span>  *
<span class="line">165</span>  * &#34;schema&#34; is an object that maps property names to property declaration.
<span class="line">166</span>  * Here&#39;s an example of what I have in mind:
<span class="line">167</span>  *
<span class="line">168</span>  *  [
<span class="line">169</span>  *    {
<span class="line">170</span>  *      label        : &#34;User Name&#34;,
<span class="line">171</span>  *      id           : &#34;userName&#34;,
<span class="line">172</span>  *      type         : &#34;string&#34;,
<span class="line">173</span>  *      value        : &#34;&#34;,
<span class="line">174</span>  *      minLength    : 4,
<span class="line">175</span>  *      maxLength    : 8,
<span class="line">176</span>  *      mustMatch    : /^[a-z][a-z0-9_]+$/i,
<span class="line">177</span>  *      mustNotMatch : /^(admin|root|guest)$/i
<span class="line">178</span>  *    },
<span class="line">179</span>  *    {
<span class="line">180</span>  *      label     : &#34;Address&#34;,
<span class="line">181</span>  *      id        : &#34;address&#34;,
<span class="line">182</span>  *      type      : &#34;struct&#34;,
<span class="line">183</span>  *      children  : [ // this is a nested schema definition
<span class="line">184</span>  *              { label : &#34;Street&#34;, id: &#34;street&#34;, type: &#34;string&#34; },
<span class="line">185</span>  *              { label  : &#34;Country&#34;,
<span class="line">186</span>  *                id     : &#34;country&#34;,
<span class="line">187</span>  *                type   : &#34;enum&#34;,
<span class="line">188</span>  *                item : [
<span class="line">189</span>  							{ label : &#34;US&#34;, value : &#34;US&#34; },
<span class="line">190</span>  							{ label : &#34;UK&#34;, value : &#34;UK&#34; },
<span class="line">191</span>  							{ label : &#34;KR&#34;, value : &#34;KR&#34; }
<span class="line">192</span>  						 ] 
<span class="line">193</span>  				}
<span class="line">194</span>  *      ]
<span class="line">195</span>  *    },
<span class="line">196</span>  *    {
<span class="line">197</span>  *      label     : &#34;Age&#34;,
<span class="line">198</span>  *      id        : &#34;age&#34;,
<span class="line">199</span>  *      type      : &#34;integer&#34;,
<span class="line">200</span>  *      minValue  : 18,
<span class="line">201</span>  *      maxValue  : 80
<span class="line">202</span>  *    },
<span class="line">203</span>  *    {
<span class="line">204</span>  *      label     : &#34;Birthday&#34;,
<span class="line">205</span>  *      id        : &#34;birthday&#34;,
<span class="line">206</span>  *      type      : &#34;date&#34;,
<span class="line">207</span>  *      minValue  : &#34;YYYY/MM/DD&#34;  // can we restrict the DwtCalendar?
<span class="line">208</span>  *    }
<span class="line">209</span>  *  ]
<span class="line">210</span>  *
<span class="line">211</span>  * The types we will support for now are:
<span class="line">212</span>  *
<span class="line">213</span>  *   - &#34;number&#34; / &#34;integer&#34; : Allows floating point numbers or integers only.
<span class="line">214</span>  *     Properties: &#34;minValue&#34;, &#34;maxValue&#34;.
<span class="line">215</span>  *
<span class="line">216</span>  *   - &#34;string&#34; : Allows any string to be inserted.  &#34;minLength&#34;, &#34;maxLength&#34;,
<span class="line">217</span>  *     &#34;mustMatch&#34;, &#34;mustNotMatch&#34;.
<span class="line">218</span>  *
<span class="line">219</span>  *   - &#34;password&#34; : Same as &#34;string&#34;, only it&#39;s not displayed.
<span class="line">220</span>  *
<span class="line">221</span>  *   - &#34;enum&#34; : One of the strings listed in the value.
<span class="line">222</span>  *
<span class="line">223</span>  *   - &#34;boolean&#34; : Checkbox that yields string value of &#34;true&#34; and &#34;false&#34;.
<span class="line">224</span>  *
<span class="line">225</span>  *   - &#34;struct&#34; : Composite property; doesn&#39;t have a value by itself, but has
<span class="line">226</span>  *     child properties (the &#34;children&#34; array) that are defined in the same way
<span class="line">227</span>  *     as a toplevel property.
<span class="line">228</span>  *
<span class="line">229</span>  * All types except &#34;struct&#34; will allow a &#34;value&#34; property which is expected
<span class="line">230</span>  * to be of a valid type that matches all validating properties (such as
<span class="line">231</span>  * minLength, etc.).  The value of this property will be displayed initially
<span class="line">232</span>  * when the widget is constructed.
<span class="line">233</span>  *
<span class="line">234</span>  * Also, all types will support a &#34;readonly&#34; property.
<span class="line">235</span>  */</span><span class="WHIT">
<span class="line">236</span> </span><span class="NAME">DwtPropertyEditor.prototype.initProperties</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">schema</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">237</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">238</span> </span><span class="WHIT">		</span><span class="NAME">this._schema</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">schema</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">239</span> </span><span class="WHIT">		</span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">240</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">241</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">schema.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">++</span><span class="NAME">i</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">242</span> </span><span class="WHIT">		</span><span class="NAME">this._createProperty</span><span class="PUNC">(</span><span class="NAME">schema</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">243</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">244</span> 
<span class="line">245</span> </span><span class="NAME">DwtPropertyEditor.prototype._createProperty</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">246</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">level</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">parent._level</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">247</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getTable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">firstChild.appendChild</span><span class="PUNC">(</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;tr&#34;</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">248</span> 
<span class="line">249</span> </span><span class="WHIT">	</span><span class="COMM">// Initialize the &#34;prop&#34; object with some interesting attributes...</span><span class="WHIT">
<span class="line">250</span> </span><span class="WHIT">	</span><span class="NAME">prop._parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">251</span> </span><span class="WHIT">	</span><span class="NAME">prop._level</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">level</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">252</span> </span><span class="WHIT">	</span><span class="NAME">prop._rowElId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tr.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Dwt.getNextId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">253</span> </span><span class="WHIT">	</span><span class="NAME">prop._propertyEditor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">254</span> 
<span class="line">255</span> </span><span class="WHIT">	</span><span class="COMM">// ... and methods.</span><span class="WHIT">
<span class="line">256</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">DwtPropertyEditor._prop_functions</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">257</span> </span><span class="WHIT">		</span><span class="NAME">prop</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">DwtPropertyEditor._prop_functions</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">258</span> 
<span class="line">259</span> </span><span class="WHIT">	</span><span class="NAME">prop._init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">260</span> 
<span class="line">261</span> </span><span class="WHIT">	</span><span class="COMM">// indent if needed</span><span class="WHIT">
<span class="line">262</span> </span><span class="WHIT">	</span><span class="NAME">tr.className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;level-&#34;</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">level</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">263</span> 
<span class="line">264</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">prop.visible</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">&#34;false&#34;</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">265</span> </span><span class="WHIT">		</span><span class="NAME">tr.className</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34; invisible&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">266</span> 
<span class="line">267</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">prop.readonly</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">268</span> </span><span class="WHIT">		</span><span class="NAME">tr.className</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34; readonly&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">269</span> 
<span class="line">270</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">prop.type</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">&#34;struct&#34;</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">271</span> </span><span class="WHIT">		</span><span class="NAME">tr.className</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34; &#34;</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">prop.type</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">272</span> 
<span class="line">273</span> </span><span class="WHIT">		</span><span class="COMM">// this is a simple property, create a label and value cell.</span><span class="WHIT">
<span class="line">274</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tdLabel</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;td&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">275</span> </span><span class="WHIT">		</span><span class="NAME">tdLabel.className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;label&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">276</span> </span><span class="WHIT">		
<span class="line">277</span> 		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">prop.type</span><span class="PUNC">==</span><span class="STRN">&#34;checkboxgroup&#34;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class="line">278</span> </span><span class="WHIT">			</span><span class="NAME">tdLabel.className</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">&#34; grouplabel&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">279</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">280</span> </span><span class="WHIT">		
<span class="line">281</span> 		</span><span class="NAME">tr.appendChild</span><span class="PUNC">(</span><span class="NAME">tdLabel</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">282</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AjxStringUtil.htmlEncode</span><span class="PUNC">(</span><span class="NAME">prop.label</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">prop.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">283</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">prop.required</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">284</span> </span><span class="WHIT">			</span><span class="NAME">html</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;&lt;span class=&#39;DwtPropertyEditor-required&#39;&gt;*&lt;/span&gt;&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">285</span> </span><span class="WHIT">		</span><span class="NAME">tdLabel.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">html</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">286</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tdField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;td&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">287</span> </span><span class="WHIT">		</span><span class="NAME">tdField.className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;field&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">288</span> </span><span class="WHIT">		</span><span class="NAME">tr.appendChild</span><span class="PUNC">(</span><span class="NAME">tdField</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">289</span> 
<span class="line">290</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">prop.type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">291</span> </span><span class="WHIT">			</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;boolean&#34;</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this._createCheckbox</span><span class="PUNC">(</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tdField</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">292</span> </span><span class="WHIT">		    </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;enum&#34;</span><span class="WHIT">    </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this._createDropDown</span><span class="PUNC">(</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tdField</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">293</span> </span><span class="WHIT">		    </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;date&#34;</span><span class="WHIT">    </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this._createCalendar</span><span class="PUNC">(</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tdField</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">294</span> </span><span class="WHIT">   		    </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;checkboxgroup&#34;</span><span class="WHIT">	</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="NAME">this._createCheckBoxGroup</span><span class="PUNC">(</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="NAME">tdField</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">		    
<span class="line">295</span> 		    </span><span class="KEYW">default</span><span class="WHIT">        </span><span class="PUNC">:</span><span class="WHIT">
<span class="line">296</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._useDwtInputField</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">297</span> </span><span class="WHIT">				</span><span class="NAME">this._createInputField</span><span class="PUNC">(</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tdField</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">298</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">299</span> </span><span class="WHIT">				</span><span class="NAME">tdField.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">prop._makeDisplayValue</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">300</span> </span><span class="WHIT">				</span><span class="NAME">tr.__msh_doMouseDown</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">DwtPropertyEditor.simpleClosure</span><span class="PUNC">(</span><span class="NAME">prop._edit</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">prop</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">301</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">302</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">303</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">304</span> 
<span class="line">305</span> </span><span class="WHIT">		</span><span class="NAME">prop._fieldCellId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tdField.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Dwt.getNextId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">306</span> </span><span class="WHIT">		</span><span class="COMM">// prop._labelCellId = tdLabel.id = Dwt.getNextId();</span><span class="WHIT">
<span class="line">307</span> 
<span class="line">308</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tdLabel.offsetWidth</span><span class="WHIT"> </span><span class="PUNC">&gt;</span><span class="WHIT"> </span><span class="NAME">this.maxLabelWidth</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">309</span> </span><span class="WHIT">			</span><span class="NAME">this.maxLabelWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tdLabel.offsetWidth</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">310</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tdField.offsetWidth</span><span class="WHIT"> </span><span class="PUNC">&gt;</span><span class="WHIT"> </span><span class="NAME">this.maxFieldWidth</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">311</span> </span><span class="WHIT">			</span><span class="NAME">this.maxFieldWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tdField.offsetWidth</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">312</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">313</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">td</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;td&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">314</span> </span><span class="WHIT">		</span><span class="NAME">td.colSpan</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">315</span> </span><span class="WHIT">		</span><span class="NAME">tr.appendChild</span><span class="PUNC">(</span><span class="NAME">td</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">316</span> </span><span class="WHIT">		</span><span class="NAME">td.className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;label&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">317</span> </span><span class="WHIT">		</span><span class="NAME">tr.className</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34; expander-collapsed&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">318</span> </span><span class="WHIT">		</span><span class="NAME">td.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="WHIT"> </span><span class="STRN">&#34;&lt;div&gt;&#34;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">AjxStringUtil.htmlEncode</span><span class="PUNC">(</span><span class="NAME">prop.label</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#34;&lt;/div&gt;&#34;</span><span class="WHIT"> </span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">&#34;&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">319</span> </span><span class="WHIT">		</span><span class="NAME">this.initProperties</span><span class="PUNC">(</span><span class="NAME">prop.children</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">prop</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">320</span> </span><span class="WHIT">		</span><span class="NAME">tr.__msh_doMouseDown</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">DwtPropertyEditor.simpleClosure</span><span class="PUNC">(</span><span class="NAME">prop._toggle</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">prop</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">321</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">322</span> 
<span class="line">323</span> </span><span class="WHIT">	</span><span class="COMM">// collapsed by default</span><span class="WHIT">
<span class="line">324</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">level</span><span class="WHIT"> </span><span class="PUNC">&gt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">325</span> </span><span class="WHIT">		</span><span class="NAME">tr.style.display</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;none&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">326</span> </span><span class="WHIT">		</span><span class="NAME">parent._hidden</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">327</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">328</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">329</span> 
<span class="line">330</span> </span><span class="COMM">// &lt;FIXME: this will create problems when the first property is a &#34;struct&#34;&gt;</span><span class="WHIT">
<span class="line">331</span> </span><span class="NAME">DwtPropertyEditor.prototype.setFixedLabelWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">332</span> </span><span class="WHIT">	</span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">333</span> </span><span class="WHIT">		</span><span class="NAME">this.getTable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">rows</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">cells</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">style.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">w</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.maxLabelWidth</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">&#34;px&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">334</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">335</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">336</span> 
<span class="line">337</span> </span><span class="NAME">DwtPropertyEditor.prototype.setFixedFieldWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">338</span> </span><span class="WHIT">	</span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">339</span> </span><span class="WHIT">		</span><span class="NAME">this.getTable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">rows</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">cells</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">style.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">w</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.maxFieldWidth</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">&#34;px&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">340</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">341</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">342</span> </span><span class="COMM">// &lt;/FIXME&gt;</span><span class="WHIT">
<span class="line">343</span> 
<span class="line">344</span> </span><span class="NAME">DwtPropertyEditor.prototype._setCurrentMsgDiv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">div</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">345</span> </span><span class="WHIT">	</span><span class="NAME">this._currentMsgDiv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">div</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">346</span> </span><span class="WHIT">	</span><span class="NAME">this._currentMsgDivTimer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="WHIT">
<span class="line">347</span> </span><span class="WHIT">		</span><span class="NAME">DwtPropertyEditor.simpleClosure</span><span class="PUNC">(</span><span class="NAME">this._clearMsgDiv</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">348</span> </span><span class="WHIT">		</span><span class="NAME">DwtPropertyEditor.MSG_TIMEOUT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">349</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">350</span> 
<span class="line">351</span> </span><span class="NAME">DwtPropertyEditor.prototype._clearMsgDiv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">352</span> </span><span class="WHIT">	</span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">353</span> </span><span class="WHIT">		</span><span class="NAME">this._stopMsgDivTimer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">354</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">355</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">div</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._currentMsgDiv</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">356</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">div</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">357</span> </span><span class="WHIT">		</span><span class="NAME">div.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">div</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">358</span> </span><span class="WHIT">		</span><span class="NAME">this._currentMsgDiv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">div</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">359</span> </span><span class="WHIT">		</span><span class="NAME">this._currentMsgDivTimer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">360</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">361</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">362</span> 
<span class="line">363</span> </span><span class="NAME">DwtPropertyEditor.prototype._stopMsgDivTimer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">364</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._currentMsgDivTimer</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">365</span> </span><span class="WHIT">		</span><span class="NAME">clearTimeout</span><span class="PUNC">(</span><span class="NAME">this._currentMsgDivTimer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">366</span> </span><span class="WHIT">		</span><span class="NAME">this._currentMsgDivTimer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">367</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">368</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">369</span> 
<span class="line">370</span> </span><span class="COMM">// This is bad.  We&#39;re messing with internals.  I think there should be an</span><span class="WHIT">
<span class="line">371</span> </span><span class="COMM">// option in DwtComposite to specify the element where to add the child, rather</span><span class="WHIT">
<span class="line">372</span> </span><span class="COMM">// than simply getHtmlElement().appendChild(child).</span><span class="WHIT">
<span class="line">373</span> </span><span class="NAME">DwtPropertyEditor.prototype.addChild</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">374</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._currentFieldCell</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">375</span> </span><span class="WHIT">		</span><span class="NAME">DwtComposite.prototype.addChild.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">child</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">376</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">377</span> </span><span class="WHIT">		</span><span class="NAME">this._children.add</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">378</span> </span><span class="WHIT">		</span><span class="NAME">this._currentFieldCell.appendChild</span><span class="PUNC">(</span><span class="NAME">child.getHtmlElement</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">379</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">380</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">381</span> 
<span class="line">382</span> </span><span class="NAME">DwtPropertyEditor.prototype._createCheckbox</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">383</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">checkbox</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;input&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">384</span> </span><span class="WHIT">	</span><span class="NAME">checkbox._prop</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">prop</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">385</span> </span><span class="WHIT">	</span><span class="NAME">checkbox.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">prop.name</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">386</span> </span><span class="WHIT">	</span><span class="NAME">checkbox.type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#39;checkbox&#39;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">387</span> </span><span class="WHIT">	
<span class="line">388</span> 		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">AjxEnv.isIE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class="line">389</span> </span><span class="WHIT">		</span><span class="NAME">checkbox.attachEvent</span><span class="PUNC">(</span><span class="STRN">&#34;onclick&#34;</span><span class="PUNC">,</span><span class="NAME">prop._onCheckboxChange</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">390</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class="line">391</span> </span><span class="WHIT">		</span><span class="NAME">checkbox.addEventListener</span><span class="PUNC">(</span><span class="STRN">&#34;click&#34;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">prop._onCheckboxChange</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">			
<span class="line">392</span> 		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">393</span> </span><span class="WHIT">	
<span class="line">394</span> 	</span><span class="NAME">this._children.add</span><span class="PUNC">(</span><span class="NAME">checkbox</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">395</span> </span><span class="WHIT">	</span><span class="NAME">target.appendChild</span><span class="PUNC">(</span><span class="NAME">checkbox</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">396</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">prop.value</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">&#39;true&#39;</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">397</span> </span><span class="WHIT">		</span><span class="NAME">checkbox.checked</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">prop.value</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">398</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">399</span> 
<span class="line">400</span> </span><span class="NAME">DwtPropertyEditor.prototype._createCheckBoxGroup</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">401</span> </span><span class="WHIT">	
<span class="line">402</span> 	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">div</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;div&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">403</span> </span><span class="WHIT">	</span><span class="NAME">div._prop</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">prop</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">404</span> </span><span class="WHIT">	</span><span class="NAME">div.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">prop.name</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">405</span> </span><span class="WHIT">	</span><span class="COMM">//div._prop._checkBox = [];</span><span class="WHIT">
<span class="line">406</span> </span><span class="WHIT">	</span><span class="NAME">prop._checkBox</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">407</span> </span><span class="WHIT">	</span><span class="NAME">div.appendChild</span><span class="PUNC">(</span><span class="NAME">document.createTextNode</span><span class="PUNC">(</span><span class="NAME">prop.value</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">408</span> </span><span class="WHIT">	
<span class="line">409</span> 	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">table</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;table&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">410</span> </span><span class="WHIT">	</span><span class="NAME">table.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Dwt.getNextId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">411</span> </span><span class="WHIT">	</span><span class="NAME">table.border</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">412</span> </span><span class="WHIT">	</span><span class="NAME">table.cellSpacing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">table.cellPadding</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">413</span> </span><span class="WHIT">	</span><span class="NAME">table.appendChild</span><span class="PUNC">(</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;tbody&#34;</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">414</span> </span><span class="WHIT">	
<span class="line">415</span> 	
<span class="line">416</span> 	</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">prop.checkBox.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class="line">417</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;tr&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">418</span> 
<span class="line">419</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tdField1</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;td&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">420</span> </span><span class="WHIT">	</span><span class="NAME">tdField1.className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;field&#34;</span><span class="PUNC">;</span><span class="WHIT">	
<span class="line">421</span> 	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">checkBox</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._createCheckboxForGroup</span><span class="PUNC">(</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="NAME">prop.checkBox</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">tdField1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">422</span> </span><span class="WHIT">	</span><span class="NAME">tr.appendChild</span><span class="PUNC">(</span><span class="NAME">tdField1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">423</span> </span><span class="WHIT">	
<span class="line">424</span> 	</span><span class="NAME">checkBox._label</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">prop.checkBox</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">label</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">425</span> </span><span class="WHIT">	
<span class="line">426</span> 	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tdField2</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;td&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">427</span> </span><span class="WHIT">	</span><span class="NAME">tdField2.className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;field&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">428</span> </span><span class="WHIT">	</span><span class="NAME">tdField2.appendChild</span><span class="PUNC">(</span><span class="NAME">document.createTextNode</span><span class="PUNC">(</span><span class="NAME">prop.checkBox</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">label</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">429</span> </span><span class="WHIT">	</span><span class="NAME">tr.appendChild</span><span class="PUNC">(</span><span class="NAME">tdField2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">430</span> </span><span class="WHIT">	
<span class="line">431</span> 	</span><span class="NAME">table.firstChild.appendChild</span><span class="PUNC">(</span><span class="NAME">tr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">	
<span class="line">432</span> 
<span class="line">433</span> </span><span class="COMM">//	div._prop._checkBox[i]=checkBox;</span><span class="WHIT">
<span class="line">434</span> </span><span class="WHIT">	</span><span class="NAME">prop._checkBox</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">checkBox</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">435</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">436</span> </span><span class="WHIT">	
<span class="line">437</span> 	</span><span class="NAME">div.appendChild</span><span class="PUNC">(</span><span class="NAME">table</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">438</span> </span><span class="WHIT">	
<span class="line">439</span> 	</span><span class="NAME">this._children.add</span><span class="PUNC">(</span><span class="NAME">div</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">440</span> </span><span class="WHIT">	</span><span class="NAME">target.appendChild</span><span class="PUNC">(</span><span class="NAME">div</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">441</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">div</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">442</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">443</span> 
<span class="line">444</span> </span><span class="NAME">DwtPropertyEditor.prototype._createCheckboxForGroup</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">parent_prop</span><span class="PUNC">,</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">445</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">checkbox</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;input&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">446</span> </span><span class="WHIT">	</span><span class="NAME">checkbox._prop</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parent_prop</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">447</span> </span><span class="WHIT">	</span><span class="NAME">checkbox.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">prop.name</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">448</span> </span><span class="WHIT">	</span><span class="NAME">checkbox.type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#39;checkbox&#39;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">449</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">prop.value</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">&#39;true&#39;</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">450</span> </span><span class="WHIT">		</span><span class="NAME">checkbox.checked</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">prop.value</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">451</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">AjxEnv.isIE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class="line">452</span> </span><span class="WHIT">		</span><span class="NAME">checkbox.attachEvent</span><span class="PUNC">(</span><span class="STRN">&#34;onclick&#34;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parent_prop._onCheckboxGroupChange</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">	
<span class="line">453</span> 		</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class="line">454</span> </span><span class="WHIT">		</span><span class="NAME">checkbox.addEventListener</span><span class="PUNC">(</span><span class="STRN">&#34;click&#34;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parent_prop._onCheckboxGroupChange</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">455</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">456</span> </span><span class="WHIT">	</span><span class="NAME">this._children.add</span><span class="PUNC">(</span><span class="NAME">checkbox</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">457</span> </span><span class="WHIT">	</span><span class="NAME">target.appendChild</span><span class="PUNC">(</span><span class="NAME">checkbox</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">458</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">checkbox</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">459</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">460</span> 
<span class="line">461</span> 
<span class="line">462</span> </span><span class="NAME">DwtPropertyEditor.prototype._createDropDown</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">463</span> </span><span class="WHIT">	</span><span class="NAME">this._currentFieldCell</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">464</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">sel</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">465</span> </span><span class="WHIT">		</span><span class="NAME">i</span><span class="WHIT">       </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">466</span> </span><span class="WHIT">		</span><span class="NAME">options</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">467</span> </span><span class="WHIT">		</span><span class="NAME">items</span><span class="WHIT">   </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">prop.item</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">468</span> </span><span class="WHIT">	</span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">items</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">469</span> </span><span class="WHIT">		</span><span class="NAME">options</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">DwtSelectOption</span><span class="PUNC">(</span><span class="NAME">item.value</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">470</span> </span><span class="WHIT">						   </span><span class="NAME">item.value</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">prop.value</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">471</span> </span><span class="WHIT">						   </span><span class="NAME">item.label</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">472</span> </span><span class="WHIT">	</span><span class="NAME">prop._select</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">sel</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">DwtSelect</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">parent</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">options</span><span class="PUNC">:</span><span class="NAME">options</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">473</span> </span><span class="WHIT">	</span><span class="NAME">sel.addChangeListener</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">AjxListener</span><span class="PUNC">(</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">prop._onSelectChange</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">474</span> </span><span class="WHIT">	</span><span class="NAME">sel.addListener</span><span class="PUNC">(</span><span class="NAME">DwtEvent.ONMOUSEDOWN</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._onMouseDown</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">475</span> </span><span class="WHIT">	</span><span class="NAME">this._currentFieldCell</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">476</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">477</span> 
<span class="line">478</span> </span><span class="NAME">DwtPropertyEditor.prototype._createCalendar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">479</span> </span><span class="WHIT">	</span><span class="NAME">this._currentFieldCell</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">480</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">btn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">DwtButton</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">parent</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">481</span> </span><span class="WHIT">	</span><span class="NAME">this._currentFieldCell</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">482</span> 
<span class="line">483</span> </span><span class="WHIT">	</span><span class="NAME">btn.setText</span><span class="PUNC">(</span><span class="NAME">prop._makeDisplayValue</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">484</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">menu</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">DwtMenu</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">parent</span><span class="PUNC">:</span><span class="NAME">btn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">:</span><span class="NAME">DwtMenu.CALENDAR_PICKER_STYLE</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">485</span> </span><span class="WHIT">	</span><span class="NAME">menu.setAssociatedObj</span><span class="PUNC">(</span><span class="NAME">btn</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">486</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cal</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">DwtCalendar</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">parent</span><span class="PUNC">:</span><span class="NAME">menu</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">487</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">date</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">488</span> </span><span class="WHIT">	</span><span class="NAME">date.setTime</span><span class="PUNC">(</span><span class="NAME">prop.value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">489</span> </span><span class="WHIT">	</span><span class="NAME">cal.setDate</span><span class="PUNC">(</span><span class="NAME">date</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">490</span> </span><span class="WHIT">	</span><span class="NAME">cal.setSize</span><span class="PUNC">(</span><span class="NUMB">150</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#34;auto&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">491</span> </span><span class="WHIT">	</span><span class="NAME">cal.addSelectionListener</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">AjxListener</span><span class="PUNC">(</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">prop._onCalendarSelect</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">492</span> </span><span class="WHIT">	</span><span class="NAME">btn.setMenu</span><span class="PUNC">(</span><span class="NAME">menu</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">493</span> 
<span class="line">494</span> </span><span class="WHIT">	</span><span class="NAME">prop._dateButton</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">btn</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">495</span> </span><span class="WHIT">	</span><span class="NAME">prop._dateCalendar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">cal</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">496</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">497</span> 
<span class="line">498</span> </span><span class="NAME">DwtPropertyEditor.DWT_INPUT_FIELD_TYPES</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">499</span> </span><span class="WHIT">	</span><span class="STRN">&#34;string&#34;</span><span class="WHIT">    </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">DwtInputField.STRING</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">500</span> </span><span class="WHIT">	</span><span class="STRN">&#34;password&#34;</span><span class="WHIT">  </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">DwtInputField.PASSWORD</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">501</span> </span><span class="WHIT">	</span><span class="STRN">&#34;integer&#34;</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">DwtInputField.INTEGER</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">502</span> </span><span class="WHIT">	</span><span class="STRN">&#34;number&#34;</span><span class="WHIT">    </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">DwtInputField.FLOAT</span><span class="WHIT">
<span class="line">503</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">504</span> 
<span class="line">505</span> </span><span class="NAME">DwtPropertyEditor.prototype._createInputField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">506</span> </span><span class="WHIT">	</span><span class="NAME">this._currentFieldCell</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">507</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">DwtPropertyEditor.DWT_INPUT_FIELD_TYPES</span><span class="PUNC">[</span><span class="NAME">prop.type</span><span class="PUNC">]</span><span class="WHIT">
<span class="line">508</span> </span><span class="WHIT">		</span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">DwtInputField.STRING</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">509</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">field</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">DwtInputField</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">parent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">initialValue</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">prop.value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">maxLen</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">prop.maxLength</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">rows</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">prop.rows</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">510</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">DwtInputField.INTEGER</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">DwtInputField.FLOAT</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">511</span> </span><span class="WHIT">		</span><span class="NAME">field.setValidNumberRange</span><span class="PUNC">(</span><span class="NAME">prop.minValue</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">512</span> </span><span class="WHIT">					  </span><span class="NAME">prop.maxValue</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">513</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">prop.decimals</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">514</span> </span><span class="WHIT">			</span><span class="NAME">field.setNumberPrecision</span><span class="PUNC">(</span><span class="NAME">prop.decimals</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">515</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">516</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">DwtInputField.STRING</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">DwtInputField.PASSWORD</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">517</span> </span><span class="WHIT">		</span><span class="NAME">field.setValidStringLengths</span><span class="PUNC">(</span><span class="NAME">prop.minLength</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">prop.maxLength</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">518</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">prop.required</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">519</span> </span><span class="WHIT">		</span><span class="NAME">field.setRequired</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">520</span> </span><span class="WHIT">	</span><span class="NAME">this._currentFieldCell</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">521</span> </span><span class="WHIT">	</span><span class="NAME">prop._inputField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">522</span> </span><span class="WHIT">	</span><span class="NAME">field.setValue</span><span class="PUNC">(</span><span class="NAME">prop.value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">523</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">prop.readonly</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">524</span> </span><span class="WHIT">		</span><span class="NAME">field.setReadOnly</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">525</span> </span><span class="WHIT">	</span><span class="NAME">field.setValidationCallback</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">AjxCallback</span><span class="PUNC">(</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">prop._onDwtInputFieldValidated</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">526</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">527</span> 
<span class="line">528</span> </span><span class="COMM">// these will be merged to each prop object that comes in the schema</span><span class="WHIT">
<span class="line">529</span> </span><span class="NAME">DwtPropertyEditor._prop_functions</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">530</span> 
<span class="line">531</span> </span><span class="WHIT">	</span><span class="NAME">_init</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">532</span> </span><span class="WHIT">		</span><span class="NAME">this.type</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;string&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">533</span> </span><span class="WHIT">		</span><span class="NAME">this.value</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">534</span> </span><span class="WHIT">		</span><span class="NAME">this._initialVal</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.value</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">535</span> 
<span class="line">536</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">&#34;date&#34;</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">537</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">538</span> </span><span class="COMM">// 				var tmp = new Date();</span><span class="WHIT">
<span class="line">539</span> </span><span class="COMM">// 				tmp.setHours(0);</span><span class="WHIT">
<span class="line">540</span> </span><span class="COMM">// 				tmp.setMinutes(0);</span><span class="WHIT">
<span class="line">541</span> </span><span class="COMM">// 				tmp.setSeconds(0);</span><span class="WHIT">
<span class="line">542</span> </span><span class="WHIT">				</span><span class="NAME">this.value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">543</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">544</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.format</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">545</span> </span><span class="WHIT">				</span><span class="NAME">this.format</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AjxDateUtil.getSimpleDateFormat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toPattern</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">546</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">547</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">548</span> 
<span class="line">549</span> </span><span class="WHIT">	</span><span class="NAME">_modified</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">550</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._initialVal</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">this.value</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">551</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">552</span> 
<span class="line">553</span> </span><span class="WHIT">	</span><span class="NAME">_getRowEl</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">554</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">this._rowElId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">555</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">556</span> 
<span class="line">557</span> </span><span class="WHIT">	</span><span class="NAME">_makeDisplayValue</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">558</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getValue</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">559</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">560</span> </span><span class="WHIT">		    </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;password&#34;</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class="line">561</span> </span><span class="WHIT">			</span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">val.replace</span><span class="PUNC">(</span><span class="REGX">/./g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#34;*&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">562</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">563</span> </span><span class="WHIT">		    </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;date&#34;</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class="line">564</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">date</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">565</span> </span><span class="WHIT">			</span><span class="NAME">date.setTime</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">566</span> </span><span class="WHIT">			</span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AjxDateFormat.format</span><span class="PUNC">(</span><span class="NAME">this.format</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">date</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">567</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">568</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">569</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">&#34;&#34;</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">570</span> </span><span class="WHIT">			</span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;&lt;br /&gt;&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">571</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT">
<span class="line">572</span> </span><span class="WHIT">			</span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AjxStringUtil.htmlEncode</span><span class="PUNC">(</span><span class="NAME">String</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">573</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">574</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">575</span> 
<span class="line">576</span> </span><span class="WHIT">	</span><span class="NAME">_display</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">visible</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">577</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT">
<span class="line">578</span> </span><span class="WHIT">			</span><span class="NAME">c</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.children</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">579</span> </span><span class="WHIT">			</span><span class="NAME">d</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">visible</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">&#34;&#34;</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">&#34;none&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">580</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">581</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">582</span> </span><span class="WHIT">			</span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">--</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&gt;=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">583</span> </span><span class="WHIT">				</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_getRowEl</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">style.display</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">584</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">visible</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">585</span> </span><span class="WHIT">					</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_display</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">586</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">587</span> </span><span class="WHIT">			</span><span class="NAME">this._hidden</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">visible</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">588</span> 
<span class="line">589</span> </span><span class="WHIT">			</span><span class="COMM">// change the class name accordingly</span><span class="WHIT">
<span class="line">590</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getRowEl</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">591</span> </span><span class="WHIT">			</span><span class="NAME">tr.className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tr.className.replace</span><span class="PUNC">(</span><span class="WHIT">
<span class="line">592</span> </span><span class="WHIT">				</span><span class="REGX">/expander-[^\s]+/</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">593</span> </span><span class="WHIT">				</span><span class="NAME">visible</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">&#34;expander-expanded&#34;</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">&#34;expander-collapsed&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">594</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">595</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">596</span> 
<span class="line">597</span> </span><span class="WHIT">	</span><span class="NAME">_toggle</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this._display</span><span class="PUNC">(</span><span class="NAME">this._hidden</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">598</span> 
<span class="line">599</span> </span><span class="WHIT">	</span><span class="NAME">_edit</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">600</span> </span><span class="WHIT">		</span><span class="COMM">// Depending on the type, this should probably create different</span><span class="WHIT">
<span class="line">601</span> </span><span class="WHIT">		</span><span class="COMM">// fields for editing.  For instance, in a &#34;date&#34; property we</span><span class="WHIT">
<span class="line">602</span> </span><span class="WHIT">		</span><span class="COMM">// would want a calendar, while in a &#34;list&#34; property we would</span><span class="WHIT">
<span class="line">603</span> </span><span class="WHIT">		</span><span class="COMM">// want a drop-down select box.</span><span class="WHIT">
<span class="line">604</span> 
<span class="line">605</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.readonly</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">606</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">607</span> 
<span class="line">608</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">609</span> </span><span class="WHIT">		    </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;string&#34;</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class="line">610</span> </span><span class="WHIT">		    </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;number&#34;</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class="line">611</span> </span><span class="WHIT">		    </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;integer&#34;</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class="line">612</span> </span><span class="WHIT">		    </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;password&#34;</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class="line">613</span> </span><span class="WHIT">			</span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="WHIT">
<span class="line">614</span> </span><span class="WHIT">				</span><span class="NAME">DwtPropertyEditor.simpleClosure</span><span class="PUNC">(</span><span class="WHIT">
<span class="line">615</span> </span><span class="WHIT">					</span><span class="NAME">this._createInputField</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">50</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">616</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">617</span> 
<span class="line">618</span> </span><span class="COMM">// 		    default :</span><span class="WHIT">
<span class="line">619</span> </span><span class="COMM">// 			alert(&#34;We don&#39;t support this type yet&#34;);</span><span class="WHIT">
<span class="line">620</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">621</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">622</span> 
<span class="line">623</span> </span><span class="WHIT">	</span><span class="NAME">_createInputField</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">624</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT">	</span><span class="NAME">pe</span><span class="WHIT">     </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._propertyEditor</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">625</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">td</span><span class="WHIT">     </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">this._fieldCellId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">626</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">canvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pe.getRelDiv</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">627</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">input</span><span class="WHIT">  </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;input&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">628</span> 
<span class="line">629</span> </span><span class="WHIT">		</span><span class="NAME">input.className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;DwtPropertyEditor-input &#34;</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.type</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">630</span> </span><span class="WHIT">		</span><span class="NAME">input.setAttribute</span><span class="PUNC">(</span><span class="STRN">&#34;autocomplete&#34;</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#34;off&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">631</span> 
<span class="line">632</span> </span><span class="WHIT">		</span><span class="NAME">input.type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">&#34;password&#34;</span><span class="WHIT">
<span class="line">633</span> </span><span class="WHIT">			</span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">&#34;password&#34;</span><span class="WHIT">
<span class="line">634</span> </span><span class="WHIT">			</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">&#34;text&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">635</span> 
<span class="line">636</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">left</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">td.offsetLeft</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">top</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">td.offsetTop</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">637</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">AjxEnv.isGeckoBased</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">638</span> </span><span class="WHIT">			</span><span class="PUNC">--</span><span class="NAME">left</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">639</span> </span><span class="WHIT">			</span><span class="PUNC">--</span><span class="NAME">top</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">640</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">641</span> </span><span class="WHIT">		</span><span class="NAME">input.style.left</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">left</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">&#34;px&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">642</span> </span><span class="WHIT">		</span><span class="NAME">input.style.top</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">top</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">&#34;px&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">643</span> </span><span class="WHIT">		</span><span class="NAME">input.style.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">td.offsetWidth</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">&#34;px&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">644</span> </span><span class="WHIT">		</span><span class="NAME">input.style.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">td.offsetHeight</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">&#34;px&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">645</span> 
<span class="line">646</span> </span><span class="WHIT">		</span><span class="NAME">input.value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getValue</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">647</span> 
<span class="line">648</span> </span><span class="WHIT">		</span><span class="NAME">canvas.appendChild</span><span class="PUNC">(</span><span class="NAME">input</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">649</span> </span><span class="WHIT">		</span><span class="NAME">input.focus</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">650</span> 
<span class="line">651</span> </span><span class="WHIT">		</span><span class="NAME">input.onblur</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">DwtPropertyEditor.simpleClosure</span><span class="PUNC">(</span><span class="NAME">this._saveInput</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">652</span> </span><span class="WHIT">		</span><span class="NAME">input.onkeydown</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">DwtPropertyEditor.simpleClosure</span><span class="PUNC">(</span><span class="NAME">this._inputKeyPress</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">653</span> 
<span class="line">654</span> </span><span class="WHIT">		</span><span class="NAME">this._propertyEditor._currentInputField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._inputField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">input</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">655</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">AjxEnv.isGeckoBased</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">656</span> </span><span class="WHIT">			</span><span class="NAME">input.select</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">657</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT">
<span class="line">658</span> </span><span class="WHIT">			</span><span class="NAME">input.setSelectionRange</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">input.value.length</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">659</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">660</span> 
<span class="line">661</span> </span><span class="WHIT">	</span><span class="NAME">_getValue</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">662</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.value</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">&#34;&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">663</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">664</span> 
<span class="line">665</span> </span><span class="WHIT">	</span><span class="NAME">_checkValue</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">666</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">empty</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">&#34;&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">667</span> 
<span class="line">668</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">empty</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">669</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.required</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">670</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">671</span> </span><span class="WHIT">			</span><span class="NAME">this._displayMsg</span><span class="PUNC">(</span><span class="NAME">AjxMsg.valueIsRequired</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">672</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">673</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">674</span> 
<span class="line">675</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.maxLength</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">val.length</span><span class="WHIT"> </span><span class="PUNC">&gt;</span><span class="WHIT"> </span><span class="NAME">this.maxLength</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">676</span> </span><span class="WHIT">			</span><span class="NAME">this._displayMsg</span><span class="PUNC">(</span><span class="NAME">AjxMessageFormat.format</span><span class="PUNC">(</span><span class="NAME">AjxMsg.stringTooLong</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.maxLength</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">677</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">678</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">679</span> 
<span class="line">680</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.minLength</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">val.length</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.minLength</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">681</span> </span><span class="WHIT">			</span><span class="NAME">this._displayMsg</span><span class="PUNC">(</span><span class="NAME">AjxMessageFormat.format</span><span class="PUNC">(</span><span class="NAME">AjxMsg.stringTooShort</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.minLength</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">682</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">683</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">684</span> 
<span class="line">685</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.mustMatch</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.mustMatch.test</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">686</span> </span><span class="WHIT">			</span><span class="NAME">this._displayMsg</span><span class="PUNC">(</span><span class="NAME">this.msg_mustMatch</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class="line">687</span> </span><span class="WHIT">					 </span><span class="NAME">DwtPropertyEditor.MSG.mustMatch.replace</span><span class="PUNC">(</span><span class="WHIT">
<span class="line">688</span> </span><span class="WHIT">						 </span><span class="REGX">/REGEXP/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.mustMatch.toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">689</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">690</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">691</span> 
<span class="line">692</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.mustNotMatch</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this.mustNotMatch.test</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">693</span> </span><span class="WHIT">			</span><span class="NAME">this._displayMsg</span><span class="PUNC">(</span><span class="NAME">this.msg_mustNotMatch</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span class="line">694</span> </span><span class="WHIT">					 </span><span class="NAME">DwtPropertyEditor.MSG.mustNotMatch.replace</span><span class="PUNC">(</span><span class="WHIT">
<span class="line">695</span> </span><span class="WHIT">						 </span><span class="REGX">/REGEXP/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.mustNotMatch.toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">696</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">697</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">698</span> 
<span class="line">699</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">700</span> </span><span class="WHIT">		    </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;integer&#34;</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class="line">701</span> </span><span class="WHIT">		    </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">&#34;number&#34;</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span class="line">702</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Number</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">703</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">704</span> </span><span class="WHIT">				</span><span class="NAME">this._displayMsg</span><span class="PUNC">(</span><span class="NAME">AjxMsg.notANumber</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">705</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">706</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">707</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">&#34;integer&#34;</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">708</span> </span><span class="WHIT">				</span><span class="NAME">this._displayMsg</span><span class="PUNC">(</span><span class="NAME">AjxMsg.notAnInteger</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">709</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">710</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">711</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.minValue</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">n</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.minValue</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">712</span> </span><span class="WHIT">				</span><span class="NAME">this._displayMsg</span><span class="PUNC">(</span><span class="NAME">AjxMessageFormat.format</span><span class="PUNC">(</span><span class="NAME">AjxMsg.numberLessThanMin</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.minValue</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">713</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">714</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">715</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.maxValue</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">n</span><span class="WHIT"> </span><span class="PUNC">&gt;</span><span class="WHIT"> </span><span class="NAME">this.maxValue</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">716</span> </span><span class="WHIT">				</span><span class="NAME">this._displayMsg</span><span class="PUNC">(</span><span class="NAME">AjxMessageFormat.format</span><span class="PUNC">(</span><span class="NAME">AjxMsg.numberMoreThanMax</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.maxValue</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">717</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">718</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">719</span> </span><span class="WHIT">			</span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">720</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">&#34;number&#34;</span><span class="WHIT"> </span><span class="PUNC">&amp;&amp;</span><span class="WHIT"> </span><span class="NAME">this.decimals</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">721</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">val.toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">722</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">str.indexOf</span><span class="PUNC">(</span><span class="STRN">&#34;.&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">723</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">724</span> </span><span class="WHIT">					</span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">str.length</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">725</span> </span><span class="WHIT">				</span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">val.toPrecision</span><span class="PUNC">(</span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.decimals</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">726</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">727</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">728</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">729</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">730</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">731</span> 
<span class="line">732</span> </span><span class="WHIT">	</span><span class="NAME">_displayMsg</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">733</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">734</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pe</span><span class="WHIT">  </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._propertyEditor</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">735</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">div</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pe._currentMsgDiv</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">736</span> 
<span class="line">737</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">div</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">738</span> </span><span class="WHIT">			</span><span class="NAME">div</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">&#34;div&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">739</span> </span><span class="WHIT">			</span><span class="NAME">div.className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;DwtPropertyEditor-ErrorMsg&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">740</span> </span><span class="WHIT">			</span><span class="NAME">pe.getRelDiv</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendChild</span><span class="PUNC">(</span><span class="NAME">div</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">741</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT">
<span class="line">742</span> </span><span class="WHIT">			</span><span class="NAME">pe._stopMsgDivTimer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">743</span> </span><span class="WHIT">		</span><span class="NAME">div.style.visibility</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;hidden&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">744</span> </span><span class="WHIT">		</span><span class="NAME">div.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AjxStringUtil.htmlEncode</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">745</span> </span><span class="WHIT">		</span><span class="COMM">// position &amp; size</span><span class="WHIT">
<span class="line">746</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">table</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pe.getTable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">747</span> </span><span class="WHIT">		</span><span class="NAME">w</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">table.offsetWidth</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// padding &amp; border!</span><span class="WHIT">
<span class="line">748</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">AjxEnv.isIE</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">749</span> </span><span class="WHIT">			</span><span class="NAME">w</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">12</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">750</span> </span><span class="WHIT">		</span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">table.offsetLeft</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">751</span> </span><span class="WHIT">		</span><span class="NAME">div.style.left</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">&#34;px&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">752</span> </span><span class="WHIT">		</span><span class="NAME">div.style.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">w</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">&#34;px&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">753</span> </span><span class="WHIT">		</span><span class="NAME">h</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">div.offsetHeight</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">754</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">td</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">this._fieldCellId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">755</span> </span><span class="WHIT">		</span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">td.offsetTop</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">td.offsetHeight</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">756</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">h</span><span class="WHIT"> </span><span class="PUNC">&gt;</span><span class="WHIT"> </span><span class="NAME">table.offsetTop</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">table.offsetHeight</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">757</span> </span><span class="WHIT">			</span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">td.offsetTop</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">758</span> </span><span class="WHIT">		</span><span class="NAME">div.style.top</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">&#34;px&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">759</span> </span><span class="WHIT">		</span><span class="NAME">div.style.visibility</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34;&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">760</span> </span><span class="WHIT">		</span><span class="NAME">pe._setCurrentMsgDiv</span><span class="PUNC">(</span><span class="NAME">div</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">761</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">762</span> 
<span class="line">763</span> </span><span class="WHIT">	</span><span class="NAME">_saveInput</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">764</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">input</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._inputField</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">765</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._checkValue</span><span class="PUNC">(</span><span class="NAME">input.value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">766</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">767</span> </span><span class="WHIT">			</span><span class="NAME">this._setValue</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">768</span> </span><span class="WHIT">			</span><span class="NAME">input.onblur</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">input.onkeyup</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">input.onkeydown</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">input.onkeypress</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">769</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">td</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">this._fieldCellId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">770</span> </span><span class="WHIT">			</span><span class="NAME">td.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._makeDisplayValue</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">771</span> </span><span class="WHIT">			</span><span class="NAME">this._inputField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">772</span> </span><span class="WHIT">			</span><span class="NAME">this._propertyEditor._currentInputField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">773</span> </span><span class="WHIT">			</span><span class="NAME">this._propertyEditor._clearMsgDiv</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">774</span> </span><span class="WHIT">			</span><span class="NAME">input.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">input</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">775</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">776</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">777</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">input.className.indexOf</span><span class="PUNC">(</span><span class="STRN">&#34; DwtPropertyEditor-input-error&#34;</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">778</span> </span><span class="WHIT">				</span><span class="NAME">input.className</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34; DwtPropertyEditor-input-error&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">779</span> </span><span class="WHIT">			</span><span class="NAME">input.focus</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">780</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">781</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">782</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">783</span> 
<span class="line">784</span> </span><span class="WHIT">	</span><span class="NAME">_inputKeyPress</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">785</span> </span><span class="WHIT">		</span><span class="NAME">ev</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ev</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.event</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">786</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">input</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._inputField</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">787</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ev.keyCode</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">13</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">788</span> </span><span class="WHIT">			</span><span class="NAME">this._saveInput</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">789</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ev.keyCode</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">27</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">790</span> </span><span class="WHIT">			</span><span class="NAME">input.value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getValue</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">791</span> </span><span class="WHIT">			</span><span class="NAME">this._saveInput</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">792</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">793</span> </span><span class="WHIT">			</span><span class="NAME">this._propertyEditor._clearMsgDiv</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">794</span> </span><span class="WHIT">			</span><span class="NAME">input.className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">input.className.replace</span><span class="PUNC">(</span><span class="REGX">/ DwtPropertyEditor-input-error/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#34;&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">795</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">796</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">797</span> 
<span class="line">798</span> </span><span class="WHIT">	</span><span class="NAME">_onCheckboxChange</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">799</span> </span><span class="WHIT">		</span><span class="NAME">ev</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ev</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.event</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">800</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AjxEnv.isIE</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">ev.srcElement</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">ev.target</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">801</span> </span><span class="WHIT">		</span><span class="NAME">el._prop._setValue</span><span class="PUNC">(</span><span class="NAME">el.checked</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">&#34;true&#34;</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">&#34;false&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">802</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">803</span> 
<span class="line">804</span> </span><span class="WHIT">	</span><span class="NAME">_onSelectChange</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">805</span> </span><span class="WHIT">		</span><span class="NAME">this._setValue</span><span class="PUNC">(</span><span class="NAME">this._select.getValue</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">806</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">807</span> 
<span class="line">808</span> </span><span class="WHIT">	</span><span class="NAME">_onCheckboxGroupChange</span><span class="WHIT">	</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">809</span> </span><span class="WHIT">		</span><span class="NAME">ev</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ev</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.event</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">810</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">el</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AjxEnv.isIE</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">ev.srcElement</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">ev.target</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">811</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">chkBxs</span><span class="PUNC">=</span><span class="NAME">el._prop._checkBox</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">812</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">813</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">chkBxs.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class="line">814</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">chkBxs</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">checked</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class="line">815</span> </span><span class="WHIT">				</span><span class="NAME">val.push</span><span class="PUNC">(</span><span class="NAME">chkBxs</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_label</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">816</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">817</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">818</span> </span><span class="WHIT">		</span><span class="NAME">el._prop._setValue</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">819</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">	
<span class="line">820</span> 
<span class="line">821</span> 	</span><span class="NAME">_onCalendarSelect</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">822</span> </span><span class="WHIT">		</span><span class="NAME">this._setValue</span><span class="PUNC">(</span><span class="NAME">this._dateCalendar.getDate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">823</span> </span><span class="WHIT">		</span><span class="NAME">this._dateButton.setText</span><span class="PUNC">(</span><span class="NAME">this._makeDisplayValue</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">824</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">825</span> 
<span class="line">826</span> </span><span class="WHIT">	</span><span class="NAME">_onDwtInputFieldValidated</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">dwtField</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">validated</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">827</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">validated</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">828</span> </span><span class="WHIT">			</span><span class="NAME">this._setValue</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">829</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">830</span> 
<span class="line">831</span> </span><span class="WHIT">	</span><span class="NAME">_setValue</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">832</span> </span><span class="WHIT">		</span><span class="NAME">this.value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">833</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getRowEl</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">834</span> </span><span class="WHIT">		</span><span class="NAME">tr.className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tr.className.replace</span><span class="PUNC">(</span><span class="REGX">/ dirty/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">&#34;&#34;</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">835</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._modified</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">836</span> </span><span class="WHIT">			</span><span class="NAME">tr.className</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">&#34; dirty&#34;</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">837</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class="line">838</span> 
<span class="line">839</span> </span><span class="WHIT">	</span><span class="NAME">_validate</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">840</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._inputField</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">841</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._inputField</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">DwtInputField</span><span class="PUNC">)</span><span class="WHIT">
<span class="line">842</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._inputField.validate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">843</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT">
<span class="line">844</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._inputField.onblur</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">845</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT">
<span class="line">846</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">847</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class="line">848</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">849</span> 
<span class="line">850</span> </span><span class="COMM">// Since we don&#39;t like nested functions...</span><span class="WHIT">
<span class="line">851</span> </span><span class="NAME">DwtPropertyEditor.simpleClosure</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">func</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class="line">852</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">func.call</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">853</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class="line">854</span> </span></pre></body></html>